<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Base -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Pelican" />
    <meta name="author" content="Nic Deville">

<!-- Title -->
<title>ffmpeg | Nic's notes</title>
<meta name="og:title" content="ffmpeg | Nic's notes"/> <!-- 40 characters for mobile and 60 for desktop -->
<link rel="canonical" href="https://notes.nicolasdeville.com/helpers/ffmpeg" />
<meta name="twitter:title" content="ffmpeg | Nic's notes" /> <!-- max. 70 characters -->

<meta name="description" content="Command-line tools for processing video and audio files"/>
<meta property="og:description" content="Command-line tools for processing video and audio files"/>
<meta name="twitter:description" content="Command-line tools for processing video and audio files" /> <!-- max. 200 characters -->
 

<meta property="article:published_time" content="2024-06-09 22:20:48.750755+02:00" />

<meta property="article:modified_time" content="2024-06-09 22:20:48.750755+02:00" />

<meta name="robots" content="all, follow" />

<!-- Social -->
<meta property="og:type" content="article" />

<!-- <meta property="og:description" content="Messy online notebook covering B2B Sales, Leadership, Python programming, Automation, AI and more. I take these notes for myself (and my kids later) - perhaps they can help someone else..." /> min. 2 max. 4 sentences -->

<meta property="og:url" content="https://notes.nicolasdeville.com/helpers/ffmpeg" /> <!-- canonical URL for your page without session variables, user id parameters or counters -->
<meta property="og:site_name" content="Nic's notes" />
<meta name="image" property="og:image" content="https://ik.imagekit.io/vhucnsp9j1u/images/notes-twitter-image.jpg" /> <!-- at least 600x315 pixels, preferable 1200x630 pixels -->

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@ndeville" />

<meta name="twitter:image" content="https://ik.imagekit.io/vhucnsp9j1u/images/notes-twitter-image.jpg" /> <!-- aspect ratio of 2:1 with minimum dimensions of 300x157 or maximum of 4096x4096 pixels. Going with 900x471 -->

<!-- Logo -->
<meta property="og:logo" content="https://notes.nicolasdeville.com/logo.svg">

<!-- Favicon -->
<link rel="icon" type="image/x-icon" href="https://notes.nicolasdeville.com/favicon.ico">
<link rel="mask-icon" href="https://notes.nicolasdeville.com/favicon.svg" color="#FFFFFF">
<link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://notes.nicolasdeville.com/favicon.png">
<link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://notes.nicolasdeville.com/favicon.svg">
<link rel="fluid-icon" href="https://notes.nicolasdeville.com/favicon.png" title="Nic's notes">

<!-- CSS -->
<link rel="stylesheet" href="https://notes.nicolasdeville.com/theme/css/main.css" />

<!-- Pagefind -->
<link href="https://notes.nicolasdeville.com/theme/css/pagefind-ui-nic.css" rel="stylesheet">
<script src="https://notes.nicolasdeville.com/pagefind/pagefind-ui.js" type="text/javascript"></script>

<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search" });
    });
</script>


</head>

<body id="index" class="body">
        <header id="banner" class="body">

            <div class="logo-and-search">
                <a href="https://notes.nicolasdeville.com/"><img class="header_image" src="https://ik.imagekit.io/vhucnsp9j1u/images/nic_notes_header.svg" alt="Nic's notes" width="266"/></a>

                <!-- Pagefind -->
                <div class="search-input-block" id="search"></div>

            </div>

            

            <div class="above-navbar">
                <div class="last_updated">18 Jun 2024 | 15:27</div>
                <div>
                    <p class="notes_count">
                        <a href="https://notes.nicolasdeville.com/tags">by tags</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2020/">2020</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2021/">2021</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2022/">2022</a>
                        <span style="color:#C74350">|</span>
                        696 notes
                    </p>
                </div>
            </div>

            <nav><ul>
                <li><a href="https://notes.nicolasdeville.com/ai/">ai</a></li>
                <li><a href="https://notes.nicolasdeville.com/apps/">apps</a></li>
                <li><a href="https://notes.nicolasdeville.com/b2b-sales/">b2b sales</a></li>
                <li><a href="https://notes.nicolasdeville.com/books/">books</a></li>
                <li><a href="https://notes.nicolasdeville.com/careerplaybook/">#careerplaybook</a></li>
                <li class="active"><a href="https://notes.nicolasdeville.com/helpers/">helpers</a></li>
                <li><a href="https://notes.nicolasdeville.com/home-office/">home office</a></li>
                <li><a href="https://notes.nicolasdeville.com/interests/">interests</a></li>
                <li><a href="https://notes.nicolasdeville.com/leadership/">leadership</a></li>
                <li><a href="https://notes.nicolasdeville.com/learning/">learning</a></li>
                <li><a href="https://notes.nicolasdeville.com/movies/">movies</a></li>
                <li><a href="https://notes.nicolasdeville.com/projects/">projects</a></li>
                <li><a href="https://notes.nicolasdeville.com/python/">python</a></li>
                <li><a href="https://notes.nicolasdeville.com/random/">random</a></li>
                <li><a href="https://notes.nicolasdeville.com/video/">video</a></li>
            </ul></nav>
        </header>

        <!-- index.html injection -->
<section id="content" class="body">
    <article>
        <header>
            <h1 class="entry-title">
                <main> <!-- for indexing by Stork -->
                    <a href="https://notes.nicolasdeville.com/helpers/ffmpeg" rel="bookmark"
                    title="Permalink to ffmpeg">ffmpeg
                    </a>
                </main>
            </h1>
            <p class="header_summary">
                <main> <!-- for indexing by Stork -->
                    <p>Command-line tools for processing video and audio files</p>
                </main>
            </p>
        </header>

        <div class="entry-content">
<footer class="post-info">

    <p>
        09 Jun 2024 
        <span class="separator">|</span> in <a class="link_tag" href="https://notes.nicolasdeville.com/helpers/"><span data-pagefind-filter="category">helpers</span></a>


        <!-- added 4/7 -->
        <!-- 		<br />
        <abbr class="modified" title="2024-06-09T22:20:48.750755+02:00">
                Updated: 09 Jun 2024
        </abbr>
 -->

    </p>

    

</footer>            <!-- for indexing by Stork -->
            <!-- <main>  -->
                <p><span class="datestamp">18 Sep 2022</span>   </p>
<div class="book_quote">
<div class="book_quote_highlight">FFmpeg is a free and open-source software project consisting of a suite of libraries and programs for handling video, audio, and other multimedia files and streams. At its core is the command-line ffmpeg tool itself, designed for processing of video and audio files. It is widely used for format transcoding, basic editing (trimming and concatenation), video scaling, video post-production effects and standards compliance (SMPTE, ITU).<br><br>

FFmpeg also includes other tools: ffplay, a simple media player and ffprobe, a command-line tool to display media information. Among included libraries are libavcodec, an audio/video codec library used by many commercial and free software products, libavformat (Lavf), an audio/video container mux and demux library, and libavfilter, a library for enhancing and editing filters through a Gstreamer-like filtergraph.<br><br>

FFmpeg is part of the workflow of many other software projects, and its libraries are a core part of software media players such as VLC, and has been included in core processing for YouTube and Bilibili. Encoders and decoders for many audio and video file formats are included, making it highly useful for the transcoding of common and uncommon media files.</div>
<div class="book_quote_location"><a href="https://en.wikipedia.org/wiki/FFmpeg" target="_blank">https://en.wikipedia.org/wiki/FFmpeg</a></div></div>

<p>You can use Homebrew to install ffprobe (installed along with ffmpeg):    </p>
<div class="highlight"><pre><span></span><code>brew install ffmpeg
</code></pre></div>

<p>Else:  </p>
<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://ik.imagekit.io/vhucnsp9j1u/images/logos/github.png" alt="github"/></div><div class="link_content">
<div class="link_title">macOS (manual ffmpeg installation) - Audio Orchestrator documentation</div>
<div class="link_tagline">Installing ffmpeg and ffprobe on macOS manually</div>
<div class="link_url"><a href="https://bbc.github/bbcat-orchestration-docs/installation-mac-manual" target="_blank">https://bbc.github/bbcat-orchestration-docs/installation-mac-manual</a></div></div></div>

<p>Download at:   </p>
<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://ik.imagekit.io/vhucnsp9j1u/images/logos/evermeet.png" alt="logo"/></div><div class="link_content">
<div class="link_title">static FFmpeg binaries for macOS 64-bit</div>
<div class="link_tagline">evermeet</div>
<div class="link_url"><a href="https://evermeet/ffmpeg" target="_blank">https://evermeet/ffmpeg</a></div></div></div>

<h1 id="commands">Commands</h1>
<h2 id="optimise-video">Optimise video</h2>
<p><span class="datestamp">06 Jun 2024</span> </p>
<div class="highlight"><pre><span></span><code>ffmpeg -i input.mp4 -vcodec libx265 -crf <span class="m">20</span> -preset slow -acodec aac -b:a 128k output.mp4
</code></pre></div>

<div class="highlight"><pre><span></span><code>•<span class="w">   </span><span class="o">-</span><span class="nv">vcodec</span><span class="w"> </span><span class="nv">libx265</span>:<span class="w"> </span><span class="nv">Use</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">H</span>.<span class="mi">265</span><span class="w"> </span><span class="nv">codec</span>.<span class="w"></span>
•<span class="w">   </span><span class="o">-</span><span class="nv">crf</span><span class="w"> </span><span class="mi">28</span>:<span class="w"> </span><span class="nv">Constant</span><span class="w"> </span><span class="nv">Rate</span><span class="w"> </span><span class="nv">Factor</span>,<span class="w"> </span><span class="nv">lower</span><span class="w"> </span><span class="nv">values</span><span class="w"> </span><span class="nv">mean</span><span class="w"> </span><span class="nv">better</span><span class="w"> </span><span class="nv">quality</span>.<span class="w"> </span><span class="mi">28</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">good</span><span class="w"> </span><span class="nv">starting</span><span class="w"> </span><span class="nv">point</span>.<span class="w"></span>
•<span class="w">   </span><span class="o">-</span><span class="nv">preset</span><span class="w"> </span><span class="nv">slow</span>:<span class="w"> </span><span class="nv">Encoding</span><span class="w"> </span><span class="nv">speed</span><span class="w"> </span><span class="nv">vs</span><span class="w"> </span><span class="nv">compression</span><span class="w"> </span><span class="nv">ratio</span>.<span class="w"> </span><span class="nv">Slower</span><span class="w"> </span><span class="nv">presets</span><span class="w"> </span><span class="nb">result</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">better</span><span class="w"> </span><span class="nv">compression</span>.<span class="w"></span>
•<span class="w">   </span><span class="o">-</span><span class="nv">acodec</span><span class="w"> </span><span class="nv">aac</span><span class="w"> </span><span class="o">-</span><span class="nv">b</span>:<span class="nv">a</span><span class="w"> </span><span class="mi">128</span><span class="nv">k</span>:<span class="w"> </span><span class="nv">Use</span><span class="w"> </span><span class="nv">AAC</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">audio</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">audio</span><span class="w"> </span><span class="nv">bitrate</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="nv">kbps</span>.<span class="w"></span>
</code></pre></div>

<p>The crf scale ranges from 0 to 51:</p>
<div class="highlight"><pre><span></span><code>•   crf 0: Lossless encoding (highest quality, very large file size).
•   crf 23: Default value, providing a good balance between quality and file size.
•   crf 51: Lowest quality (smallest file size).
</code></pre></div>

<p>In practice, the following ranges are commonly used:</p>
<div class="highlight"><pre><span></span><code>•<span class="w">   </span><span class="mi">18</span><span class="o">-</span><span class="mi">22</span>:<span class="w"> </span><span class="nv">High</span><span class="w"> </span><span class="nv">quality</span><span class="w"> </span><span class="ss">(</span><span class="nv">visually</span><span class="w"> </span><span class="nv">lossless</span><span class="ss">)</span>.<span class="w"> </span><span class="nv">Suitable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">archiving</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">high</span><span class="o">-</span><span class="nv">quality</span><span class="w"> </span><span class="nv">viewing</span>.<span class="w"></span>
•<span class="w">   </span><span class="mi">23</span><span class="o">-</span><span class="mi">28</span>:<span class="w"> </span><span class="nv">Standard</span><span class="w"> </span><span class="nv">quality</span>.<span class="w"> </span><span class="nv">Good</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">general</span><span class="o">-</span><span class="nv">purpose</span><span class="w"> </span><span class="nv">use</span>,<span class="w"> </span><span class="nv">offering</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">balance</span><span class="w"> </span><span class="nv">between</span><span class="w"> </span><span class="nv">quality</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="nv">size</span>.<span class="w"></span>
•<span class="w">   </span><span class="mi">28</span><span class="o">-</span><span class="mi">34</span>:<span class="w"> </span><span class="nv">Low</span><span class="w"> </span><span class="nv">quality</span>.<span class="w"> </span><span class="nv">Useful</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">scenarios</span><span class="w"> </span><span class="nv">where</span><span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">more</span><span class="w"> </span><span class="nv">critical</span><span class="w"> </span><span class="nv">factor</span><span class="w"> </span><span class="nv">than</span><span class="w"> </span><span class="nv">quality</span>,<span class="w"> </span><span class="nv">such</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">streaming</span><span class="w"> </span><span class="nv">over</span><span class="w"> </span><span class="nv">limited</span><span class="w"> </span><span class="nv">bandwidth</span>.<span class="w"></span>
</code></pre></div>

<p>To use VBR (Variable Bit Rate) instead of CRF:</p>
<div class="highlight"><pre><span></span><code>ffmpeg -i input.mp4 -vcodec libx265 -crf <span class="m">28</span> -preset slow -b:v 1000k -maxrate 1500k -bufsize 2000k -acodec aac -q:a <span class="m">2</span> output.mp4
</code></pre></div>

<p>With 73Mb video source file:<br>
- 120Mb at CRF 0<br>
- 4Mb at CRF 28 (but lower quality)<br>
- 6Mb at VBR 1000k (better quality than CRF 28)</p>
<h3 id="optimise-for-powerpoint">optimise for Powerpoint</h3>
<div class="highlight"><pre><span></span><code>ffmpeg -i input.mp4 -vcodec libx264 -pix_fmt yuv420p -profile:v baseline -level:v <span class="m">3</span>.1 -preset slow -crf <span class="m">30</span> -maxrate 1000k -bufsize 2000k -acodec aac -b:a 128k -movflags +faststart output.mp4
</code></pre></div>

<p>913Kb file from 11.4Mb!</p>
<h3 id="optimise-for-sharing">optimise for sharing</h3>
<p><span class="datestamp">09 Jun 2024</span> </p>
<div class="highlight"><pre><span></span><code>ffmpeg -i input.mp4 -vcodec libx264 -crf <span class="m">28</span> -preset slow -maxrate 2M -bufsize 4M -vf <span class="s2">&quot;scale=-2:720&quot;</span> -acodec aac -b:a 128k -movflags +faststart output.mp4
</code></pre></div>

<p>16Mb from 177Mb file, in 12s.</p>
<h2 id="remove-audio">Remove Audio</h2>
<div class="highlight"><pre><span></span><code>ffmpeg -i input.mp4 -an -vcodec copy output.mp4
</code></pre></div>

<p>•   -an tells FFMPEG to remove the audio stream.<br>
•   -vcodec copy tells FFMPEG to copy the video stream without re-encoding it.</p>
<h1 id="resources">Resources</h1>
<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://ik.imagekit.io/vhucnsp9j1u/images/logos/ottverse.png" alt="logo"/></div><div class="link_content">
<div class="link_title">ffprobe – Comprehensive Tutorial with 7 Examples</div>
<div class="link_tagline">ottverse</div>
<div class="link_url"><a href="https://ottverse/ffprobe-comprehensive-tutorial-with-examples" target="_blank">https://ottverse/ffprobe-comprehensive-tutorial-with-examples</a></div></div></div>
            <!-- </main> -->
        </div><!-- /.entry-content -->
    </article>
</section>

        <!-- footer -->
        <section id="extras" class="body" data-pagefind-ignore>

        <!-- /.blogroll -->
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://btobsales.eu">Services: BtoBSales.EU</a></li>
                            <li><a href="https://indeXall.io">Side project: indeXall.io</a></li>
                            <li><a href="https://github.com/ndeville">Github: ndeville</a></li>
                        </ul>
                </div>

        <!-- /.social -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://www.linkedin.com/in/ndeville/">Linkedin</a></li>
                            <li><a href="https://www.twitter.com/ndeville">Twitter</a></li>
                        </ul>
                </div>
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body" data-pagefind-ignore>

            <address id="about" class="vcard body">
                <div class="content-row">
                    <img src="https://ik.imagekit.io/vhucnsp9j1u/images/logos/pelican-logo.png" alt="pelican" width="16" height="16"> Powered by <a href="https://getpelican.com" target="_blank"> Pelican</a>
                    <span class="separator">|</span>
                    <img src="https://ik.imagekit.io/vhucnsp9j1u/images/logos/pagefind.png" alt="pagefind" width="16" height="16"> Search by <a href="https://pagefind.app" target="_blank"> Pagefind</a>
                    <span class="separator">|</span>
                    <img src="https://ik.imagekit.io/vhucnsp9j1u/images/logos/clearbit.png" alt="clearbit" width="16" height="16"> Logos by <a href="https://clearbit.com" target="_blank"> Clearbit</a>
                    <span class="separator">|</span>
                    <img src="https://ik.imagekit.io/vhucnsp9j1u/images/python.svg" alt="python_logo" width="16" height="16"> Made with <a href="https://www.python.org/" target="_blank"> Python</a>
                </div>
                <br>
                <div class="content-row">
                    <img src="https://notes.nicolasdeville.com/favicon.svg" alt="nic_logo" width="24"> Nic's notes
                </div>
            </address>

        </footer><!-- /#contentinfo -->


<!-- JS -->

<!-- my JS script (with code block copy) -->
<script src="https://notes.nicolasdeville.com/theme/js/nic.js"></script>

</body>
</html>