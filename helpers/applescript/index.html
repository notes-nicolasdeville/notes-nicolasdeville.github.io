<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Pelican" />
    <title>AppleScript</title>
    
    <!-- Logo -->
    <meta property="og:logo" content="https://notes.nicolasdeville.com/logo.svg">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://notes.nicolasdeville.com/favicon.ico">
    <link rel="mask-icon" href="https://notes.nicolasdeville.com/favicon.svg" color="#FFFFFF">
    <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://notes.nicolasdeville.com/favicon.png">
    <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://notes.nicolasdeville.com/favicon.svg">
    <link rel="fluid-icon" href="https://notes.nicolasdeville.com/favicon.png" title="Nic's notes">
    
    <!-- CSS -->
    <link rel="stylesheet" href="https://notes.nicolasdeville.com/theme/css/main.css" />




    <!-- for Stork seach engine -->
    <link rel="stylesheet" href="https://files.stork-search.net/basic.css" /> 
    <!-- <link rel="stylesheet" href="https://files.stork-search.net/releases/v1.5.0/edible.css" /> # tried 220924-->

</head>

<body id="index" class="body">
        <header id="banner" class="body">

            <div class="logo-and-search">
                <a href="https://notes.nicolasdeville.com/"><img class="header_image" src="https://notes.nicolasdeville.com/images/nic_notes_header.svg" alt="Nic's notes" width="266"/></a>

                <!-- for Stork seach engine -->
                <div class="search-input-block">
                    <input data-stork="sitesearch" class="search-input" placeholder="Search notes..." autofocus="autofocus"/>
                    <div data-stork="sitesearch-output"></div>
                </div>
            </div>

            <div class="above-navbar">
                <div class="last_updated">28 Sep 2022 | 21:54</div>
                <div>
                    <p class="notes_count">
                        <a href="https://notes.nicolasdeville.com/tags">by tags</a> 
                        <span style="color:#C74350">|</span> 
                        <a href="https://notes.nicolasdeville.com/2020/">2020</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2021/">2021</a> 
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2022/">2022</a> 
                        <span style="color:#C74350">|</span> 
                        437 notes
                    </p>
                </div>
            </div>

            <nav><ul>
                <li><a href="https://notes.nicolasdeville.com/ai/">ai</a></li>
                <li><a href="https://notes.nicolasdeville.com/apps/">apps</a></li>
                <li><a href="https://notes.nicolasdeville.com/b2b-sales/">b2b sales</a></li>
                <li><a href="https://notes.nicolasdeville.com/books/">books</a></li>
                <li><a href="https://notes.nicolasdeville.com/careerplaybook/">#careerplaybook</a></li>
                <li class="active"><a href="https://notes.nicolasdeville.com/helpers/">helpers</a></li>
                <li><a href="https://notes.nicolasdeville.com/home-office/">home office</a></li>
                <li><a href="https://notes.nicolasdeville.com/interests/">interests</a></li>
                <li><a href="https://notes.nicolasdeville.com/leadership/">leadership</a></li>
                <li><a href="https://notes.nicolasdeville.com/learning/">learning</a></li>
                <li><a href="https://notes.nicolasdeville.com/movies/">movies</a></li>
                <li><a href="https://notes.nicolasdeville.com/projects/">projects</a></li>
                <li><a href="https://notes.nicolasdeville.com/python/">python</a></li>
                <li><a href="https://notes.nicolasdeville.com/random/">random</a></li>
                <li><a href="https://notes.nicolasdeville.com/startups/">startups</a></li>
            </ul></nav>
        </header>

<section id="content" class="body">
    <article>
        <header>
            <h1 class="entry-title">
                <main> <!-- for indexing by Stork -->
                    <a href="https://notes.nicolasdeville.com/helpers/applescript" rel="bookmark"
                    title="Permalink to AppleScript">AppleScript
                    </a>
                </main>
            </h1>
            <p class="header_summary">
                <main> <!-- for indexing by Stork -->
                    
                </main>
            </p>
        </header>

        <div class="entry-content">
<footer class="post-info">

    <p>
        27 Sep 2022 <span class="separator">|</span> in <a class="link_tag" href="https://notes.nicolasdeville.com/helpers/">helpers</a>
 tags: <a class="link_tag" href="https://notes.nicolasdeville.com/tag/macos.html">macOS</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/automation.html">automation</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/scripts.html">scripts</a>

        <!-- added 4/7 -->
        <!-- 		<br />
        <abbr class="modified" title="2022-09-27T11:40:04.830618+02:00">
                Updated: 27 Sep 2022
        </abbr>
 -->

    </p>

    

</footer>            <main> <!-- for indexing by Stork -->
                <p><span class="datestamp">18 Sep 2022</span>   </p>
<p>Need to learn it at some point - can be very helpful for many desktop automations where Python might not be ideal/best suited.    </p>
<p>Use Script Editor.app to create scripts.   </p>
<p>First working script/snippet, based on copy/paste and basic tweaking:   </p>
<div class="highlight"><pre><span></span><code><span class="k">on</span> <span class="nb">run</span> <span class="p">{</span><span class="nv">input</span><span class="p">,</span> <span class="nv">parameters</span><span class="p">}</span>

    <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Finder&quot;</span>
        <span class="k">set</span> <span class="nv">filename</span> <span class="k">to</span> <span class="na">name</span> <span class="k">of</span> <span class="nv">file</span> <span class="nv">input</span>
    <span class="k">end</span> <span class="k">tell</span>

    <span class="nb">set the clipboard to</span> <span class="nv">filename</span>
<span class="k">end</span> <span class="nb">run</span>
</code></pre></div>

<p>‚û°Ô∏è [<a href="../../helpers/macos-copy-filename/index.html">Nic Note: Copy file name to clipboard upon saving file in macOS</a>]  </p>
<p><span class="datestamp">27 Sep 2022</span> </p>
<h2 id="open-a-file-in-a-specific-application">open a file in a specific application</h2>
<div class="highlight"><pre><span></span><code><span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Atom&quot;</span> <span class="k">to</span> <span class="nb">open</span> <span class="nv">POSIX</span> <span class="nv">file</span> <span class="s2">&quot;/path/to/file/test.txt&quot;</span>
</code></pre></div>

<h2 id="how-to-run-applescript-from-command-line">how to run applescript from command line</h2>
<div class="highlight"><pre><span></span><code>osascript /path/to/file/my_script.scpt
</code></pre></div>

<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://logo.clearbit.com/stackexchange.com?size=35" alt="logo"/></div><div class="link_content">
<div class="link_title">macos - How to use AppleScript to create a new Rich Text Format file from clipboard text? - Ask Different</div>
<div class="link_tagline">stackexchange.com</div>
<div class="link_url"><a href="https://apple.stackexchange.com/questions/251466/how-to-use-applescript-to-create-a-new-rich-text-format-file-from-clipboard-text" target="_blank">https://apple.stackexchange.com/questions/251466/how-to-use-applescript-to-create-a-new-rich-text-format-file-from-clipboard-text</a></div></div></div>

<h2 id="date-formatting">date formatting</h2>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">date_now</span> <span class="k">to</span> <span class="p">((</span><span class="nb">current date</span><span class="p">)</span> <span class="k">as </span><span class="nc">string</span><span class="p">)</span>
</code></pre></div>

<p>outputs:   </p>
<div class="highlight"><pre><span></span><code>&quot;Tuesday, 27 September 2022 at 10:57:26&quot;
</code></pre></div>

<h2 id="string-concatenation">string concatenation</h2>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">a</span> <span class="k">to</span> <span class="s2">&quot;This &quot;</span>
<span class="k">set</span> <span class="nv">b</span> <span class="k">to</span> <span class="s2">&quot;seems to &quot;</span>
<span class="k">set</span> <span class="nv">c</span> <span class="k">to</span> <span class="s2">&quot;work.&quot;</span>
<span class="k">set</span> <span class="nv">myVar</span> <span class="k">to</span> <span class="nv">a</span> <span class="o">&amp;</span> <span class="nv">b</span> <span class="o">&amp;</span> <span class="nv">c</span>
</code></pre></div>

<p>outputs:   </p>
<div class="highlight"><pre><span></span><code>&quot;This seems to work.&quot;
</code></pre></div>

<h2 id="timestamp">timestamp</h2>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">timestamp</span> <span class="k">to</span> <span class="p">(</span><span class="nb">do shell script</span> <span class="s2">&quot;date &#39;+%y%m%d-%H%M&#39;&quot;</span><span class="p">)</span>
</code></pre></div>

<h1 id="script-write-clipboard-content-to-txt-file-and-open-in-atom">Script: write clipboard content to txt file and open in Atom</h1>
<p>working:  </p>
<div class="highlight"><pre><span></span><code><span class="nb">do shell script</span> <span class="s2">&quot;pbpaste &gt; /Users/xxx/my_folder/220927-1121.txt&quot;</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Atom&quot;</span> <span class="k">to</span> <span class="nb">open</span> <span class="nv">POSIX</span> <span class="nv">file</span> <span class="s2">&quot;/Users/xxx/my_folder/220927-1121.txt&quot;</span>
</code></pre></div>

<p>need to figure out how to do string injection or variable insertion of output path.   </p>
<p>working path construction:  </p>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">root_path</span> <span class="k">to</span> <span class="s2">&quot;/Users/xxx/my/path/&quot;</span>

<span class="k">set</span> <span class="nv">timestamp</span> <span class="k">to</span> <span class="p">(</span><span class="nb">do shell script</span> <span class="s2">&quot;date &#39;+%y%m%d-%H%M&#39;&quot;</span><span class="p">)</span>

<span class="k">set</span> <span class="nv">file_extension</span> <span class="k">to</span> <span class="s2">&quot;.txt&quot;</span>

<span class="k">set</span> <span class="nv">file_path</span> <span class="k">to</span> <span class="nv">root_path</span> <span class="o">&amp;</span> <span class="nv">timestamp</span> <span class="o">&amp;</span> <span class="nv">file_extension</span>
</code></pre></div>

<p>outputs:</p>
<div class="highlight"><pre><span></span><code>&quot;/Users/xxx/my/path/220927-1128.txt&quot;
</code></pre></div>

<p>working script üòÅ</p>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">command</span> <span class="k">to</span> <span class="s2">&quot;pbpaste &gt; &quot;</span>

<span class="k">set</span> <span class="nv">root_path</span> <span class="k">to</span> <span class="s2">&quot;/Users/xxxx/my/folder/&quot;</span>

<span class="k">set</span> <span class="nv">timestamp</span> <span class="k">to</span> <span class="p">(</span><span class="nb">do shell script</span> <span class="s2">&quot;date &#39;+%y%m%d-%H%M&#39;&quot;</span><span class="p">)</span>

<span class="k">set</span> <span class="nv">file_extension</span> <span class="k">to</span> <span class="s2">&quot;.txt&quot;</span>

<span class="k">set</span> <span class="nv">file_path</span> <span class="k">to</span> <span class="nv">root_path</span> <span class="o">&amp;</span> <span class="nv">timestamp</span> <span class="o">&amp;</span> <span class="nv">file_extension</span>

<span class="k">set</span> <span class="nv">full_command</span> <span class="k">to</span> <span class="nv">command</span> <span class="o">&amp;</span> <span class="nv">root_path</span> <span class="o">&amp;</span> <span class="nv">timestamp</span> <span class="o">&amp;</span> <span class="nv">file_extension</span>

<span class="nb">do shell script</span> <span class="nv">full_command</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Atom&quot;</span> <span class="k">to</span> <span class="nb">open</span> <span class="nv">POSIX</span> <span class="nv">file</span> <span class="nv">file_path</span>
</code></pre></div>

<p>Key it seems is that variables come out enclosed with quotes which were redundant with the quotes required for the shell script instructions, so including the command itself in the string was the solution. </p>
<h1 id="resources">Resources</h1>
<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://logo.clearbit.com/apple.com?size=35" alt="logo"/></div><div class="link_content">
<div class="link_title">Introduction to AppleScript Language Guide</div>
<div class="link_tagline">apple.com</div>
<div class="link_url"><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html" target="_blank">https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html</a></div></div></div>
            </main>
        </div><!-- /.entry-content -->
    </article>
</section>
        <section id="extras" class="body">

        <!-- /.blogroll -->
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://indeXall.io">Side project: indeXall.io</a></li>
                            <li><a href="https://btobsales.eu">Services: BtoBSales.EU</a></li>
                        </ul>
                </div>

        <!-- /.social -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://www.linkedin.com/in/ndeville/">Linkedin</a></li>
                            <li><a href="https://www.twitter.com/ndeville">Twitter</a></li>
                        </ul>
                </div>
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Powered by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>, 
                with <a href="https://stork-search.net/" target="_blank">Stork</a> & <a href="https://github.com/pelican-plugins/search" target="_blank">Pelican Search plugin</a>.
                <br>
                <a href="https://clearbit.com" target="_blank">Logos provided by Clearbit</a>
                <br>
                <!-- <span style="color:#C74350">|</span> <img src="https://notes.nicolasdeville.com/images/python.svg" alt="python_logo" width="16" style="vertical-align: middle;"/> <a href="https://www.python.org/" target="_blank">Python</a>  -->
                <img src="https://notes.nicolasdeville.com/images/python.svg" alt="python_logo" width="16" style="vertical-align: middle;"/> <a href="https://www.python.org/" target="_blank">Python</a> 
                </address><!-- /#about -->

        </footer><!-- /#contentinfo -->


<!-- JS -->

<!-- my JS script (with code block copy) -->
<script src="https://notes.nicolasdeville.com/theme/js/nic.js"></script>

<!-- for Stork seach engine -->
<!-- <script src="https://files.stork-search.net/releases/v1.2.1/stork.js"></script> #updated 220924 -->
<script src="https://files.stork-search.net/stork.js"></script>
<script>
    stork.register("sitesearch", "https://notes.nicolasdeville.com/search-index.st")
</script>

</body>
</html>