<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Base -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Pelican" />
    <meta name="author" content="Nic Deville">

<!-- Title -->
<title>AppleScript | Nic's notes</title>
<meta name="og:title" content="AppleScript | Nic's notes"/> <!-- 40 characters for mobile and 60 for desktop -->
<link rel="canonical" href="https://notes.nicolasdeville.com/helpers/applescript" />
<meta name="twitter:title" content="AppleScript | Nic's notes" /> <!-- max. 70 characters -->

<meta name="description" content="Messy online notebook covering B2B Sales, Leadership, Python programming, Automation, AI and more. I take these notes for myself (and my kids later) - perhaps they can help someone else..."/>
<meta property="og:description" content="Messy online notebook covering B2B Sales, Leadership, Python programming, Automation, AI and more. I take these notes for myself (and my kids later) - perhaps they can help someone else..."/>
<meta name="twitter:description" content="Messy online notebook covering B2B Sales, Leadership, Python programming, Automation, AI and more. I take these notes for myself (and my kids later) - perhaps they can help someone else..." /> <!-- max. 200 characters -->

 

<meta property="article:published_time" content="2022-09-18 00:00:00+02:00" />

<meta property="article:modified_time" content="2023-03-11 12:03:56.844461+01:00" />

<meta name="robots" content="all, follow" />

<!-- Social -->
<meta property="og:type" content="article" />

<!-- <meta property="og:description" content="Messy online notebook covering B2B Sales, Leadership, Python programming, Automation, AI and more. I take these notes for myself (and my kids later) - perhaps they can help someone else..." /> min. 2 max. 4 sentences -->

<meta property="og:url" content="https://notes.nicolasdeville.com/helpers/applescript" /> <!-- canonical URL for your page without session variables, user id parameters or counters -->
<meta property="og:site_name" content="Nic's notes" />
<meta name="image" property="og:image" content="https://notes.nicolasdeville.com/images/notes-twitter-image.jpg" /> <!-- at least 600x315 pixels, preferable 1200x630 pixels -->

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@ndeville" />

<meta name="twitter:image" content="https://notes.nicolasdeville.com/images/notes-twitter-image.jpg" /> <!-- aspect ratio of 2:1 with minimum dimensions of 300x157 or maximum of 4096x4096 pixels. Going with 900x471 -->

<!-- Logo -->
<meta property="og:logo" content="https://notes.nicolasdeville.com/logo.svg">

<!-- Favicon -->
<link rel="icon" type="image/x-icon" href="https://notes.nicolasdeville.com/favicon.ico">
<link rel="mask-icon" href="https://notes.nicolasdeville.com/favicon.svg" color="#FFFFFF">
<link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://notes.nicolasdeville.com/favicon.png">
<link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://notes.nicolasdeville.com/favicon.svg">
<link rel="fluid-icon" href="https://notes.nicolasdeville.com/favicon.png" title="Nic's notes">

<!-- CSS -->
<link rel="stylesheet" href="https://notes.nicolasdeville.com/theme/css/main.css" />

<!-- Pagefind -->
<link href="https://notes.nicolasdeville.com/theme/css/pagefind-ui-nic.css" rel="stylesheet">
<script src="https://notes.nicolasdeville.com/pagefind/pagefind-ui.js" type="text/javascript"></script>

<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search" });
    });
</script>


</head>

<body id="index" class="body">
        <header id="banner" class="body">

            <div class="logo-and-search">
                <a href="https://notes.nicolasdeville.com/"><img class="header_image" src="https://notes.nicolasdeville.com/images/nic_notes_header.svg" alt="Nic's notes" width="266"/></a>

                <!-- for Stork seach engine -->
                <!-- <div class="search-input-block">
                    <input data-stork="sitesearch" class="search-input" placeholder="Search notes..." autofocus="autofocus"/>
                    <div data-stork="sitesearch-output"></div>
                </div> -->

                <!-- Pagefind -->
                <div class="search-input-block" id="search"></div>

            </div>

            

            <div class="above-navbar">
                <div class="last_updated">23 Mar 2023 | 21:39</div>
                <div>
                    <p class="notes_count">
                        <a href="https://notes.nicolasdeville.com/tags">by tags</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2020/">2020</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2021/">2021</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2022/">2022</a>
                        <span style="color:#C74350">|</span>
                        708 notes
                    </p>
                </div>
            </div>

            <nav><ul>
                <li><a href="https://notes.nicolasdeville.com/ai/">ai</a></li>
                <li><a href="https://notes.nicolasdeville.com/apps/">apps</a></li>
                <li><a href="https://notes.nicolasdeville.com/b2b-sales/">b2b sales</a></li>
                <li><a href="https://notes.nicolasdeville.com/books/">books</a></li>
                <li><a href="https://notes.nicolasdeville.com/careerplaybook/">#careerplaybook</a></li>
                <li class="active"><a href="https://notes.nicolasdeville.com/helpers/">helpers</a></li>
                <li><a href="https://notes.nicolasdeville.com/home-office/">home office</a></li>
                <li><a href="https://notes.nicolasdeville.com/interests/">interests</a></li>
                <li><a href="https://notes.nicolasdeville.com/leadership/">leadership</a></li>
                <li><a href="https://notes.nicolasdeville.com/learning/">learning</a></li>
                <li><a href="https://notes.nicolasdeville.com/movies/">movies</a></li>
                <li><a href="https://notes.nicolasdeville.com/projects/">projects</a></li>
                <li><a href="https://notes.nicolasdeville.com/python/">python</a></li>
                <li><a href="https://notes.nicolasdeville.com/random/">random</a></li>
                <li><a href="https://notes.nicolasdeville.com/research/">research</a></li>
                <li><a href="https://notes.nicolasdeville.com/startups/">startups</a></li>
            </ul></nav>
        </header>

        <!-- index.html injection -->
<section id="content" class="body">
    <article>
        <header>
            <h1 class="entry-title">
                <main> <!-- for indexing by Stork -->
                    <a href="https://notes.nicolasdeville.com/helpers/applescript" rel="bookmark"
                    title="Permalink to AppleScript">AppleScript
                    </a>
                </main>
            </h1>
            <p class="header_summary">
                <main> <!-- for indexing by Stork -->
                    
                </main>
            </p>
        </header>

        <div class="entry-content">
<footer class="post-info">

    <p>
        18 Sep 2022 
        <span class="separator">|</span> in <a class="link_tag" href="https://notes.nicolasdeville.com/helpers/"><span data-pagefind-filter="category">helpers</span></a>

 tags: <a class="link_tag" href="https://notes.nicolasdeville.com/tag/macos.html">macOS</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/automation.html">automation</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/scripts.html">scripts</a>

        <!-- added 4/7 -->
        <!-- 		<br />
        <abbr class="modified" title="2023-03-11T12:03:56.844461+01:00">
                Updated: 11 Mar 2023
        </abbr>
 -->

    </p>

    

</footer>            <!-- for indexing by Stork -->
            <!-- <main>  -->
                <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#open-a-file-in-a-specific-application">open a file in a specific application</a></li>
<li><a href="#how-to-run-applescript-from-command-line">how to run applescript from command line</a></li>
<li><a href="#date-formatting">date formatting</a></li>
<li><a href="#string-concatenation">string concatenation</a></li>
<li><a href="#timestamp">timestamp</a></li>
<li><a href="#script-write-clipboard-content-to-txt-file-and-open-in-atom">Script: write clipboard content to txt file and open in Atom</a></li>
<li><a href="#quoted-form-of">quoted form of</a></li>
<li><a href="#resources">Resources</a></li>
</ul>
</div>
<p><span class="datestamp">18 Sep 2022</span>   </p>
<p>Need to learn it at some point - can be very helpful for many desktop automations where Python might not be ideal/best suited.    </p>
<p>Use Script Editor.app to create scripts.   </p>
<p>First working script/snippet, based on copy/paste and basic tweaking:   </p>
<div class="highlight"><pre><span></span><code><span class="k">on</span> <span class="nb">run</span> <span class="p">{</span><span class="nv">input</span><span class="p">,</span> <span class="nv">parameters</span><span class="p">}</span>

    <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Finder&quot;</span>
        <span class="k">set</span> <span class="nv">filename</span> <span class="k">to</span> <span class="na">name</span> <span class="k">of</span> <span class="nv">file</span> <span class="nv">input</span>
    <span class="k">end</span> <span class="k">tell</span>

    <span class="nb">set the clipboard to</span> <span class="nv">filename</span>
<span class="k">end</span> <span class="nb">run</span>
</code></pre></div>

<p>➡️ <span class="nic_link"><a href="https://notes.nicolasdeville.com/helpers/macos-copy-filename" target="_blank">Copy file name to clipboard upon saving file in macOS</a></span>  </p>
<p><span class="datestamp">27 Sep 2022</span> </p>
<h2 id="open-a-file-in-a-specific-application">open a file in a specific application</h2>
<div class="highlight"><pre><span></span><code><span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Atom&quot;</span> <span class="k">to</span> <span class="nb">open</span> <span class="nv">POSIX</span> <span class="nv">file</span> <span class="s2">&quot;/path/to/file/test.txt&quot;</span>
</code></pre></div>

<h2 id="how-to-run-applescript-from-command-line">how to run applescript from command line</h2>
<div class="highlight"><pre><span></span><code>osascript /path/to/file/my_script.scpt
</code></pre></div>

<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://notes.nicolasdeville.com/images/logos/stackexchange.png" alt="logo"/></div><div class="link_content">
<div class="link_title">macos - How to use AppleScript to create a new Rich Text Format file from clipboard text? - Ask Different</div>
<div class="link_tagline">stackexchange</div>
<div class="link_url"><a href="https://apple.stackexchange/questions/251466/how-to-use-applescript-to-create-a-new-rich-text-format-file-from-clipboard-text" target="_blank">https://apple.stackexchange/questions/251466/how-to-use-applescript-to-create-a-new-rich-text-format-file-from-clipboard-text</a></div></div></div>

<h2 id="date-formatting">date formatting</h2>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">date_now</span> <span class="k">to</span> <span class="p">((</span><span class="nb">current date</span><span class="p">)</span> <span class="k">as </span><span class="nc">string</span><span class="p">)</span>
</code></pre></div>

<p>outputs:   </p>
<div class="highlight"><pre><span></span><code>&quot;Tuesday, 27 September 2022 at 10:57:26&quot;
</code></pre></div>

<h2 id="string-concatenation">string concatenation</h2>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">a</span> <span class="k">to</span> <span class="s2">&quot;This &quot;</span>
<span class="k">set</span> <span class="nv">b</span> <span class="k">to</span> <span class="s2">&quot;seems to &quot;</span>
<span class="k">set</span> <span class="nv">c</span> <span class="k">to</span> <span class="s2">&quot;work.&quot;</span>
<span class="k">set</span> <span class="nv">myVar</span> <span class="k">to</span> <span class="nv">a</span> <span class="o">&amp;</span> <span class="nv">b</span> <span class="o">&amp;</span> <span class="nv">c</span>
</code></pre></div>

<p>outputs:   </p>
<div class="highlight"><pre><span></span><code>&quot;This seems to work.&quot;
</code></pre></div>

<h2 id="timestamp">timestamp</h2>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">timestamp</span> <span class="k">to</span> <span class="p">(</span><span class="nb">do shell script</span> <span class="s2">&quot;date &#39;+%y%m%d-%H%M&#39;&quot;</span><span class="p">)</span>
</code></pre></div>

<h1 id="script-write-clipboard-content-to-txt-file-and-open-in-atom">Script: write clipboard content to txt file and open in Atom</h1>
<p>working:  </p>
<div class="highlight"><pre><span></span><code><span class="nb">do shell script</span> <span class="s2">&quot;pbpaste &gt; /Users/xxx/my_folder/220927-1121.txt&quot;</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Atom&quot;</span> <span class="k">to</span> <span class="nb">open</span> <span class="nv">POSIX</span> <span class="nv">file</span> <span class="s2">&quot;/Users/xxx/my_folder/220927-1121.txt&quot;</span>
</code></pre></div>

<p>need to figure out how to do string injection or variable insertion of output path.   </p>
<p>working path construction:  </p>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">root_path</span> <span class="k">to</span> <span class="s2">&quot;/Users/xxx/my/path/&quot;</span>

<span class="k">set</span> <span class="nv">timestamp</span> <span class="k">to</span> <span class="p">(</span><span class="nb">do shell script</span> <span class="s2">&quot;date &#39;+%y%m%d-%H%M&#39;&quot;</span><span class="p">)</span>

<span class="k">set</span> <span class="nv">file_extension</span> <span class="k">to</span> <span class="s2">&quot;.txt&quot;</span>

<span class="k">set</span> <span class="nv">file_path</span> <span class="k">to</span> <span class="nv">root_path</span> <span class="o">&amp;</span> <span class="nv">timestamp</span> <span class="o">&amp;</span> <span class="nv">file_extension</span>
</code></pre></div>

<p>outputs:</p>
<div class="highlight"><pre><span></span><code>&quot;/Users/xxx/my/path/220927-1128.txt&quot;
</code></pre></div>

<p>working script 😁</p>
<div class="highlight"><pre><span></span><code><span class="k">set</span> <span class="nv">command</span> <span class="k">to</span> <span class="s2">&quot;pbpaste &gt; &quot;</span>

<span class="k">set</span> <span class="nv">root_path</span> <span class="k">to</span> <span class="s2">&quot;/Users/xxxx/my/folder/&quot;</span>

<span class="k">set</span> <span class="nv">timestamp</span> <span class="k">to</span> <span class="p">(</span><span class="nb">do shell script</span> <span class="s2">&quot;date &#39;+%y%m%d-%H%M&#39;&quot;</span><span class="p">)</span>

<span class="k">set</span> <span class="nv">file_extension</span> <span class="k">to</span> <span class="s2">&quot;.txt&quot;</span>

<span class="k">set</span> <span class="nv">file_path</span> <span class="k">to</span> <span class="nv">root_path</span> <span class="o">&amp;</span> <span class="nv">timestamp</span> <span class="o">&amp;</span> <span class="nv">file_extension</span>

<span class="k">set</span> <span class="nv">full_command</span> <span class="k">to</span> <span class="nv">command</span> <span class="o">&amp;</span> <span class="nv">root_path</span> <span class="o">&amp;</span> <span class="nv">timestamp</span> <span class="o">&amp;</span> <span class="nv">file_extension</span>

<span class="nb">do shell script</span> <span class="nv">full_command</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Atom&quot;</span> <span class="k">to</span> <span class="nb">open</span> <span class="nv">POSIX</span> <span class="nv">file</span> <span class="nv">file_path</span>
</code></pre></div>

<p>Key it seems is that variables come out enclosed with quotes which were redundant with the quotes required for the shell script instructions, so including the command itself in the string was the solution. </p>
<h1 id="quoted-form-of">quoted form of</h1>
<p>to ensure that strings such as (literal) filenames are passed to the shell unmodified (to protect strings from shell expansions), prefix them with <code>quoted form of</code>.     </p>
<h1 id="resources">Resources</h1>
<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://notes.nicolasdeville.com/images/logos/apple.png" alt="logo"/></div><div class="link_content">
<div class="link_title">Introduction to AppleScript Language Guide</div>
<div class="link_tagline">apple</div>
<div class="link_url"><a href="https://developer.apple/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html" target="_blank">https://developer.apple/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html</a></div></div></div>
            <!-- </main> -->
        </div><!-- /.entry-content -->
    </article>
</section>

        <!-- footer -->
        <section id="extras" class="body" data-pagefind-ignore>

        <!-- /.blogroll -->
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://btobsales.eu">Services: BtoBSales.EU</a></li>
                            <li><a href="https://indeXall.io">Side project: indeXall.io</a></li>
                            <li><a href="https://github.com/ndeville">Github: ndeville</a></li>
                        </ul>
                </div>

        <!-- /.social -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://www.linkedin.com/in/ndeville/">Linkedin</a></li>
                            <li><a href="https://www.twitter.com/ndeville">Twitter</a></li>
                        </ul>
                </div>
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body" data-pagefind-ignore>
                <address id="about" class="vcard body">
                    <img src="https://notes.nicolasdeville.com/favicon.svg" alt="nic_logo" width="24" style="vertical-align: middle;"/> Nic's notes:
                    <br>
                    <img src="https://notes.nicolasdeville.com/images/logos/getpelican.png" alt="pelican" width="16" style="vertical-align: middle;"/> Powered by <a href="https://getpelican.com" target="_blank">Pelican</a>
                    <br>
                    <img src="https://notes.nicolasdeville.com/images/logos/pagefind.png" alt="pagefind" width="16" style="vertical-align: middle;"/> Search by <a href="https://pagefind.app" target="_blank">Pagefind</a>
                    <br>
                    <img src="https://notes.nicolasdeville.com/images/logos/clearbit.png" alt="clearbit" width="16" style="vertical-align: middle;"/> Logos by <a href="https://clearbit.com" target="_blank">Clearbit</a>
                    <br>
                    <img src="https://notes.nicolasdeville.com/images/python.svg" alt="python_logo" width="16" style="vertical-align: middle;"/> Made with <a href="https://www.python.org/" target="_blank">Python</a>
                </address><!-- /#about -->

        </footer><!-- /#contentinfo -->


<!-- JS -->

<!-- my JS script (with code block copy) -->
<script src="https://notes.nicolasdeville.com/theme/js/nic.js"></script>

<!-- for Stork seach engine -->
<!-- <script src="https://files.stork-search.net/stork.js"></script>
<script>
    stork.register("sitesearch", "https://notes.nicolasdeville.com/search-index.st")
</script> -->

<!-- <script>
    (function() {
    if( window.innerWidth > 600 ) {
        var stork_script = document.createElement('script');
        stork_script.type = 'text/javascript';
        stork_script.src = 'https://files.stork-search.net/stork.js';

        var stork_register = ('script');
        stork_register.innerHTML = 'stork.register("sitesearch", "https://notes.nicolasdeville.com/search-index.st")';

        var head = document.getElementsByTagName('head')[0];
        head.appendChild(stork_script);
        head.appendChild(stork_register);


    }
    })();
</script> -->

</body>
</html>