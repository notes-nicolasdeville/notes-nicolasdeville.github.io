<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Pelican" />
    <title>Tesla AI Day 2022</title>
    
    <!-- Logo -->
    <meta property="og:logo" content="https://notes.nicolasdeville.com/logo.svg">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://notes.nicolasdeville.com/favicon.ico">
    <link rel="mask-icon" href="https://notes.nicolasdeville.com/favicon.svg" color="#FFFFFF">
    <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://notes.nicolasdeville.com/favicon.png">
    <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://notes.nicolasdeville.com/favicon.svg">
    <link rel="fluid-icon" href="https://notes.nicolasdeville.com/favicon.png" title="Nic's notes">
    
    <!-- CSS -->
    <link rel="stylesheet" href="https://notes.nicolasdeville.com/theme/css/main.css" />



        <meta name="description" content="science-fiction minus the fiction" />

    <!-- for Stork seach engine -->
    <link rel="stylesheet" href="https://files.stork-search.net/basic.css" /> 
    <!-- <link rel="stylesheet" href="https://files.stork-search.net/releases/v1.5.0/edible.css" /> # tried 220924-->

</head>

<body id="index" class="body">
        <header id="banner" class="body">

            <div class="logo-and-search">
                <a href="https://notes.nicolasdeville.com/"><img class="header_image" src="https://notes.nicolasdeville.com/images/nic_notes_header.svg" alt="Nic's notes" width="266"/></a>

                <!-- for Stork seach engine -->
                <div class="search-input-block">
                    <input data-stork="sitesearch" class="search-input" placeholder="Search notes..." autofocus="autofocus"/>
                    <div data-stork="sitesearch-output"></div>
                </div>
            </div>

            <div class="above-navbar">
                <div class="last_updated">03 Oct 2022 | 23:54</div>
                <div>
                    <p class="notes_count">
                        <a href="https://notes.nicolasdeville.com/tags">by tags</a> 
                        <span style="color:#C74350">|</span> 
                        <a href="https://notes.nicolasdeville.com/2020/">2020</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2021/">2021</a> 
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2022/">2022</a> 
                        <span style="color:#C74350">|</span> 
                        457 notes
                    </p>
                </div>
            </div>

            <nav><ul>
                <li><a href="https://notes.nicolasdeville.com/ai/">ai</a></li>
                <li><a href="https://notes.nicolasdeville.com/apps/">apps</a></li>
                <li><a href="https://notes.nicolasdeville.com/b2b-sales/">b2b sales</a></li>
                <li><a href="https://notes.nicolasdeville.com/books/">books</a></li>
                <li><a href="https://notes.nicolasdeville.com/careerplaybook/">#careerplaybook</a></li>
                <li><a href="https://notes.nicolasdeville.com/helpers/">helpers</a></li>
                <li><a href="https://notes.nicolasdeville.com/home-office/">home office</a></li>
                <li><a href="https://notes.nicolasdeville.com/interests/">interests</a></li>
                <li><a href="https://notes.nicolasdeville.com/leadership/">leadership</a></li>
                <li><a href="https://notes.nicolasdeville.com/learning/">learning</a></li>
                <li><a href="https://notes.nicolasdeville.com/movies/">movies</a></li>
                <li><a href="https://notes.nicolasdeville.com/projects/">projects</a></li>
                <li><a href="https://notes.nicolasdeville.com/python/">python</a></li>
                <li><a href="https://notes.nicolasdeville.com/random/">random</a></li>
                <li><a href="https://notes.nicolasdeville.com/startups/">startups</a></li>
                <li class="active"><a href="https://notes.nicolasdeville.com/tesla/">tesla</a></li>
            </ul></nav>
        </header>

<section id="content" class="body">
    <article>
        <header>
            <h1 class="entry-title">
                <main> <!-- for indexing by Stork -->
                    <a href="https://notes.nicolasdeville.com/tesla/ai-day-2022" rel="bookmark"
                    title="Permalink to Tesla AI Day 2022">Tesla AI Day 2022
                    </a>
                </main>
            </h1>
            <p class="header_summary">
                <main> <!-- for indexing by Stork -->
                    <p>science-fiction minus the fiction</p>
                </main>
            </p>
        </header>

        <div class="entry-content">
<footer class="post-info">

    <p>
        03 Oct 2022 <span class="separator">|</span> in <a class="link_tag" href="https://notes.nicolasdeville.com/tesla/">tesla</a>
 tags: <a class="link_tag" href="https://notes.nicolasdeville.com/tag/ai.html">ai</a>

        <!-- added 4/7 -->
        <!-- 		<br />
        <abbr class="modified" title="2022-10-03T23:54:14.925438+02:00">
                Updated: 03 Oct 2022
        </abbr>
 -->

    </p>

    

</footer>            <main> <!-- for indexing by Stork -->
                <p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/introducting-optimus.png" alt="ai-day-2022/introducting-optimus.png"/>  </p>
<div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#introducing-optimus">Introducing: Optimus</a><ul>
<li><a href="#latest-generation">Latest generation</a><ul>
<li><a href="#actuators">actuators</a></li>
<li><a href="#hands">hands</a></li>
<li><a href="#software">software</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#full-self-driving">Full Self-Driving</a><ul>
<li><a href="#dojo-in-house-supercomputer">DOJO: In-House Supercomputer</a></li>
</ul>
</li>
<li><a href="#transcript">Transcript</a></li>
</ul>
</div>
<p><span class="datestamp">01 Oct 2022</span>   </p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ODSJsviD_SU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>AI day is a recruitment event aimed at engineers. Sharing Tesla's progress on the AI front to get people excited about joining them. </p>
<p>Since 2020, Tesla tops the list of the most attractive companies for US engineering students (ahead of SpaceX, Lockheed Martin, Google, Boeing, NASA, Apple, Microsoft and Amazon).   </p>
<p>It is a 3 hours long, quite technical presentation.  </p>
<p>Depending where you stand, it also acts as PR for Tesla and </p>
<p>What amazes me always with Tesla is how open they are with their engineering - from having open-sourced their patents years ago to sharing their engineering work (typically one of the most closed guarded trade secret at companies who build things) in granular details.   </p>
<h1 id="introducing-optimus">Introducing: Optimus</h1>
<p>this could be a defining moment in history.</p>
<p>"tesla could make a meaningful contribution to agi"<br>
"tesla's a good entity to do it from a governance standpoint because we're a publicly traded company we have one class of stock and that means that the public controls tesla"   </p>
<p>Test use cases showed: </p>
<ul>
<li>moving boxes and objects on the factory floor
<img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-020227-tesla-ai-day-2022-0014-.jpg" alt="ai-day-2022/221003-020227-tesla-ai-day-2022-0014-"/>
(same software as Tesla FSD)  <br>
<img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-020240-tesla-ai-day-2022-0015-.jpg" alt="ai-day-2022/221003-020240-tesla-ai-day-2022-0015-"/> (actual workstation in one of the Tesla factories)</li>
<li>bringing packages to office workers
<img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-020150-tesla-ai-day-2022-0013-.jpg" alt="ai-day-2022/221003-020150-tesla-ai-day-2022-0013-"/></li>
<li>watering flowers
<img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-020113-tesla-ai-day-2022-0010-.jpg" alt="ai-day-2022/221003-020113-tesla-ai-day-2022-0010-"/></li>
</ul>
<p>using semi-off-the-shelf at the moment. Working on custom design.<br>
working on optimising cost &amp; scalability of actuators.    </p>
<p>"we've also designed it using the same discipline that we use in designing the car which is to design it for manufacturing such that it's possible to make the robot in high volume at low cost with high reliability"   </p>
<p>opposable thumbs: can operate tools.   </p>
<ul>
<li>production planned at high-volume (millions of unit)  </li>
<li>aim of &lt;$20k    </li>
</ul>
<p>economy is defined as production value per pre: what does an economy look like when no limitation of capita?   </p>
<p>"the potential for optimus is i think appreciated by very few people"    </p>
<div class="book_quote">
<div class="book_quote_highlight">"join Tesla and help make it a reality and bring it to fruition at scale such that it can help millions of people.<br>The potential like i said really boggles the mind, because you have to say what is an economy?<br>An economy is sort of productive entities times their productivity  - capita times productivity per capita. At the point at which there is not a limitation on capita it's not clear what an economy even means. At that point an economy becomes quasi-infinite - this means a future of abundance, a future where there is no poverty where people you can have whatever you want in terms of products and services it really is a fundamental transformation of civilization as we know it.<br> Obviously we want to make sure that transformation is a positive one and safe but that's also why i think Tesla as an entity doing this being a single class of stock publicly traded owned by the public is very important and should not be overlooked. I think this is essential because then if the public doesn't like what Tesla is doing the public can buy shares in Tesla and vote differently - this is a big deal it's very important that i can't just do what i want sometimes people think that but it's not true so it's very important that the corporate entity that makes this happen is something that the public can properly influence so i think the Tesla structure is ideal for that."</div>
<div class="book_quote_location">Elon Musk</div></div>

<p>Self-driving cars have a potential for 10x economic output.   </p>
<p>Optimus has potential for 100x economic output!       </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-021104-tesla-ai-day-2022-0018-.jpg" alt="ai-day-2022/221003-021104-tesla-ai-day-2022-0018-"/></p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-021121-tesla-ai-day-2022-0019-.jpg" alt="ai-day-2022/221003-021121-tesla-ai-day-2022-0019-"/></p>
<ul>
<li>what amazes me is the pace of innovation. From concept to working prototype in &lt; 1 year (6-8 months they said).     </li>
</ul>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-021137-tesla-ai-day-2022-0020-.jpg" alt="ai-day-2022/221003-021137-tesla-ai-day-2022-0020-"/></p>
<ul>
<li>similar weight as a human means no weight restrictions/limitations.     </li>
</ul>
<p>On "Elon time", Optimus will get to market in 3-5 years.    </p>
<h2 id="latest-generation">Latest generation</h2>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-091529-tesla-ai-day-2022-0021-.jpg" alt="ai-day-2022/221003-091529-tesla-ai-day-2022-0021-"/>    </p>
<p>Orange are actuators, blue are electrical systems.  </p>
<p>Cost and efficiency are focus.   </p>
<p>Part count and power consumption will be optimised/minimised.  </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-091632-tesla-ai-day-2022-0022-.jpg" alt="ai-day-2022/221003-091632-tesla-ai-day-2022-0022-"/>   </p>
<ul>
<li>battery will be good for 1x day of work  </li>
</ul>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-091723-tesla-ai-day-2022-0023-.jpg" alt="ai-day-2022/221003-091723-tesla-ai-day-2022-0023-"/>  </p>
<ul>
<li>bot brain in the torso, leveraging Tesla FSD software</li>
</ul>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-091933-tesla-ai-day-2022-0024-.jpg" alt="ai-day-2022/221003-091933-tesla-ai-day-2022-0024-"/>   </p>
<p>models used for crash test simulations are extremly complex and accurate. Same models used for Optimus.  </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-092050-tesla-ai-day-2022-0025-.jpg" alt="ai-day-2022/221003-092050-tesla-ai-day-2022-0025-"/>   </p>
<p>"we're just bags of soggy jelly and bones thrown in" ðŸ˜‚   </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-092304-tesla-ai-day-2022-0026-.jpg" alt="ai-day-2022/221003-092304-tesla-ai-day-2022-0026-"/>   </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-092458-tesla-ai-day-2022-0028-.jpg" alt="ai-day-2022/221003-092458-tesla-ai-day-2022-0028-"/>  </p>
<h3 id="actuators">actuators</h3>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-092732-tesla-ai-day-2022-0029-.jpg" alt="ai-day-2022/221003-092732-tesla-ai-day-2022-0029-"/>   </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-092754-tesla-ai-day-2022-0030-.jpg" alt="ai-day-2022/221003-092754-tesla-ai-day-2022-0030-"/>  </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-092844-tesla-ai-day-2022-0031-.jpg" alt="ai-day-2022/221003-092844-tesla-ai-day-2022-0031-"/>   </p>
<ul>
<li>red axis denotes optimal</li>
<li>"communality study" to minimise number of different actuators   </li>
</ul>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-093010-tesla-ai-day-2022-0032-.jpg" alt="ai-day-2022/221003-093010-tesla-ai-day-2022-0032-"/>    </p>
<ul>
<li>1x actuator able to lift a 500kg piano.    </li>
</ul>
<h3 id="hands">hands</h3>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-093133-tesla-ai-day-2022-0033-.jpg" alt="ai-day-2022/221003-093133-tesla-ai-day-2022-0033-"/>   </p>
<ul>
<li>biologically inspired design because the world around us is designed for human biology ergonomics. Adapt the robot to its environment, not vice versa. So the robot can interact with the world of humans, no matter what.      </li>
</ul>
<p>If you are interested in the technical details, I encourage you to watch the whole presentation - it's quite fascinatting.  </p>
<h3 id="software">software</h3>
<p>it was possible to quickly get to a functioning version of the concept from last year because of the years spend by the FSD team. 
robot on legs vs robot of wheels.  <br>
same "occupancy network" as in Tesla cars.   </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-093443-tesla-ai-day-2022-0034-.jpg" alt="ai-day-2022/221003-093443-tesla-ai-day-2022-0034-"/>  </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-2136_optimus-walking.gif" alt="ai-day-2022/221003-2136_optimus-walking.gif"/>  </p>
<h1 id="full-self-driving">Full Self-Driving</h1>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-094514-tesla-ai-day-2022-0035-.jpg" alt="ai-day-2022/221003-094514-tesla-ai-day-2022-0035-"/>     </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-095428-tesla-ai-day-2022-0037-.jpg" alt="ai-day-2022/221003-095428-tesla-ai-day-2022-0037-"/>    </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-103405-tesla-ai-day-2022-0038-.jpg" alt="ai-day-2022/221003-103405-tesla-ai-day-2022-0038-"/>     </p>
<p>FSD Beta can technically be made available worldwide by the end of the year. <br>
Hurdle will be local regulatory approvals.   </p>
<p>Metric to optimise against: how many miles in full autonomy between necessary interventions.  </p>
<h2 id="dojo-in-house-supercomputer">DOJO: In-House Supercomputer</h2>
<p>Off-the shelf</p>
<p>400,000 video instantiations per second!    </p>
<p>invented a "language of lanes" to handle the logic of complicated 3D representations of lanes and their interrelations.<br>
framework could be extrapolated to "language of walking paths" for Optimus. </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-110012-tesla-ai-day-2022-0039-.jpg" alt="ai-day-2022/221003-110012-tesla-ai-day-2022-0039-"/>    </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-110831-tesla-ai-day-2022-0040-.jpg" alt="ai-day-2022/221003-110831-tesla-ai-day-2022-0040-"/>   </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/ai-day-2022/221003-111129-tesla-ai-day-2022-0042-.jpg" alt="ai-day-2022/221003-111129-tesla-ai-day-2022-0042-"/>   </p>
<h1 id="transcript">Transcript</h1>
<p>Full transcript generated with Whisper [<a href="../../ai/whisper/index.html">Nic Note: Whisper</a>]:   </p>
<p>Tesla AI Day 2022.m4a  <br>
transcribed: 2022-10-02 21:19 | english     </p>
<hr>
<p>You oh welcome everybody give everyone a moment to get back in the audience all right great welcome to tesla AI day 2022 we've got some really exciting things to show you i think you'll be pretty impressed i do want to set some expectations with respect to our optimus robot as you know last year it was just a person in a robot suit but we've come a long way and it's you know compared to that it's going to be very impressive and we're going to talk about the advancements in AI for full self-driving as well as how they apply to more generally to real world AI problems like a humanoid robot and even going beyond that i think there's some potential that what we're doing here at tesla could make a meaningful contribution to agi and i think actually tesla's a good entity to do it from a governance standpoint because we're a publicly traded company we have one class of stock and that means that the public controls tesla and i think that's actually a good thing so if i go crazy you can fire me this is important maybe i've gone crazy so yeah so we're going to talk a lot about our progress in AI autopilot as well as our progress with dojo and then we're going to bring the team out and do a long q&amp;a so you can ask tough questions whatever you'd like existential questions technical questions but we want to have as much time for q&amp;a as possible so let's see with that are you guys seeing anything? hey guys i'm milan i work on autopilot and tesla bot and i'm lizzie a mechanical engineer on the project as well okay so should we bring out the bot? before we do that we have one little bonus tip for the day this is actually the first time we try this robot without any backup support cranes mechanical mechanisms no cables nothing yeah want to do it with you guys tonight that is the first time let's see you ready? let's go let's go all right i think the bot got some moves too so this is essentially the same self-driving computer that runs in your tesla cars by the way this is literally the first time the robot has operated without a tesla it was on stage tonight the action picture so the robot can actually do a lot more than we just showed you we just didn't want it to fall on its face so we'll show you some videos now of the robot doing a bunch of other things yeah which are less risky we should close the screen guys we wanted to show a little bit more of what we've done over the past few months with the bot and just walking around and dancing on stage just humble beginnings but you can see the autopilot neural networks running as is just which we trained for the bot directly on that new platform that's my watering can yeah when you see a rendered view that's the robot that's the world the robot sees so it's very clearly identifying objects like this is the object it should pick up picking it up we use the same process as we did for autopilot to collect data and train neural networks that we then deploy on the robot that's an example that illustrates the upper body a little bit more something that we'll try to nail down in a few months over the next few months i would say to perfection this is really an actual station in the fremont factory as well that it's working at yep that's not the only thing we have to show today right? yeah absolutely what you saw was what we call bumble-c that's our rough development robot using semi-off-the-shelf actuators we actually have gone a step further than that already the team's done an incredible job we actually have an optimus bot with fully tesla-designed and built actuators battery pack control system everything it wasn't quite ready to walk but i think it will walk in a few weeks but we wanted to show you the robot something that's actually fairly close to what we'll go into production and show you all the things it can do so let's bring it out let's do it all right so here you're seeing optimus with the degrees of freedom that we expect to have in optimus production unit one which is the ability to move all the fingers independently move the thumb have two degrees of freedom so it has opposable thumbs both left and right hand so it's able to operate tools and do useful things our goal is to make a useful humanoid robot as quickly as possible and we've also designed it using the same discipline that we use in designing the car which is to design it for manufacturing such that it's possible to make the robot in high volume at low cost with high reliability so that's incredibly important i mean you've all seen very impressive humanoid robot demonstrations and that's great but what are they missing? they're missing a brain they don't have the intelligence to navigate the world by themselves and they're also very expensive and made in low volume whereas this is but optimus is designed to be an extremely capable robot but made in very high volume probably ultimately millions of units and it is expected to cost much less than a car so i would say probably less than $20000 would be my guess okay the potential for optimus is i think appreciated by very few people as usual tesla demos are coming in hot so okay that's good that's good yeah the team has put in an incredible amount of work running seven days a week running the 3m oil to get to the demonstration today i'm super proud of what they've done they've really done a great job i'd just like to give a hand to the whole optimus team so there's still a lot of work to be done to refine optimus and improve it obviously this is just optimus version one and that's really why we're holding this event which is to convince some of the most talented people in the world like you guys to join tesla and help make it a reality and bring it to fruition at scale such that it can help millions of people and the potential like i said really boggles the mind because you have to say what is an economy? an economy is sort of productive entities times their productivity capita times productivity per capita at the point at which there is not a limitation on capita it's not clear what an economy even means at that point an economy becomes quasi-infinite so what you know take into fruition in the hopefully benign scenario this means a future of abundance a future where there is no poverty where people you can have whatever you want in terms of products and services it really is a fundamental transformation of civilization as we know it obviously we want to make sure that transformation is a positive one and safe but that's also why i think tesla as an entity doing this being a single class of stock publicly traded owned by the public is very important and should not be overlooked i think this is essential because then if the public doesn't like what tesla is doing the public can buy shares in tesla and vote differently this is a big deal it's very important that i can't just do what i want sometimes people think that but it's not true so it's very important that the corporate entity that makes this happen is something that the public can properly influence so i think the tesla structure is ideal for that like i said self-driving cars will certainly have a tremendous impact on the world i think they will improve the productivity of transport by at least a half order of magnitude perhaps an order of magnitude perhaps more optimus i think has maybe a two order of magnitude potential improvement in economic output it's not clear what the limit actually even is so we need to do this in the right way we need to do it carefully and safely and ensure that the outcome is one that is beneficial to civilization and one that humanity wants this is extremely important obviously and i hope you will consider joining tesla to achieve those goals at tesla we really care about doing the right thing here or aspire to do the right thing and really not pave the road to hell with good intentions and i think the road to hell is mostly paved with bad intentions but every now and again there's a good intention in there so we want to do the right thing so consider joining us and helping make it happen with that let's move on to the next page all right thank you elon all right so you've seen a couple of robots today let's do a quick timeline recap so last year we unveiled the tesla bot concept but a concept doesn't get us very far we knew we needed a real development and integration platform to get real life learnings as quickly as possible so that robot that came out and did the little routine for you guys we had that within six months built working on software integration hardware upgrades over the months since then but in parallel we've also been designing the next generation this one over here so this guy is rooted in the foundation of sort of the vehicle design process we're leveraging all of those learnings that we already have obviously there's a lot that's changed since last year but there's a few things that are still the same you'll notice we still have this really detailed focus on the true human form we think that matters for a few reasons but it's fun we spend a lot of time thinking about how amazing the human body is we have this incredible range of motion typically really amazing strength a fun exercise is if you put your fingertip on the chair in front of you you'll notice that there's a huge range of motion that you have in your shoulder and your elbow for example if you're not having your fingertip you can move those joints all over the place but the robot its main function is to do real useful work and it maybe doesn't necessarily need all of those degrees of freedom right away so we've stripped it down to a minimum sort of 28 fundamental degrees of freedom and then of course our hands in addition to that humans are also pretty efficient at some things and not so efficient in other times so for example we can eat a small amount of food to sustain ourselves for several hours that's great but when we're just kind of sitting around no offense but we're kind of inefficient we're just sort of burning energy so on the robot platform what we're going to do is we're going to minimize that idle power consumption drop it as low as possible and that way we can just flip a switch and immediately the robot turns into something that does useful work so let's talk about this latest generation in some detail shall we? so on the screen here you'll see in orange our actuators which we'll get to in a little bit and then we'll go into our electrical system so now that we have our sort of human-based research and we have our first development platform we have both research and execution to draw from for this design again we're using that vehicle design foundation so we're taking it from concept through design and analysis and then build and validation along the way we're going to optimize for things like cost and efficiency because those are critical metrics to take this product to scale eventually how are we going to do that? well we're going to reduce our part count and our power consumption of every element possible we're going to do things like reduce the sensing and the wiring at our extremities you can imagine a lot of mass in your hands and feet is going to be quite difficult and power consumptive to move around and we're going to centralize both our power distribution and our compute to the physical center of the platform so in the middle of our torso actually it is the torso we have our battery pack this is sized at 23 kilowatt hours which is perfect for about a full day's worth of work what's really unique about this battery pack is it has all of the battery electronics integrated into a single pcb within the pack so that means everything from sensing to fusing charge management and power distribution is all in one place we're also leveraging both our vehicle products and our energy products to roll all of those key features into this battery so that's streamlined manufacturing really efficient and simple cooling methods battery management and also safety and of course we can leverage tesla's existing infrastructure and supply chain to make it so going on to sort of our brain it's not in the head but it's pretty close also in our torso we have our central computer so as you know tesla already ships full self-driving computers in every vehicle we produce we want to leverage both the autopilot hardware and the software for the humanoid platform but because it's different in requirements and in form factor we're going to change a few things first so we still are going to it's going to do everything that a human brain does processing vision data making split decisions based on multiple sensory inputs and also communications so to support communications it's equipped with wireless connectivity as well as audio support and then it also has hardware level security features which are important to protect both the robot and the people around the robot so now that we have our sort of core we're going to need some limbs on this guy and we'd love to show you a little bit about our actuators and our fully functional hands as well but before we do that i'd like to introduce malcolm who's going to speak a little bit about our structural foundation for the robot thank you ritzy tesla have the capabilities to analyze highly complex systems they don't get much more complex than a crash you can see here a simulated crash from model three superimposed on top of the actual physical crash it's actually incredible how accurate it is just to give you an idea of the complexity of this model it includes every not bolt and washer every spot weld and it has 35 million degrees of freedom quite amazing and it's true to say that if we didn't have models like this we wouldn't be able to make the safest cars in the world so can we utilize our capabilities and our methods from the automotive side to influence a robot? well we can make a model and since we have crash software we're using the same software here we can make it fall down the purpose of this is to make sure that if it falls down ideally it doesn't but it's superficial damage we don't want it to for example break its gearbox and its arms that's equivalent of a dislocated shoulder of a robot difficult to make a sense of it so we want it to dust itself off get on with the job it's being given we can also take the same model and we can drive the actuators using the inputs from a previously solved model bringing it to life so this is producing the motions for the tasks we want the robot to do these tasks are picking up boxes turning squatting walking upstairs whatever the set of tasks are we can play to the model this is showing just simple walking we can create the stresses in all the components that helps us to optimize the components these are not dancing robots these are actually the modal behavior the first five modes of the robot and typically when people make robots they make sure the first mode is up around the top single figures up towards 10 hertz who is to do this is to make the controls of walking easier it's very difficult to walk if you can't guarantee where your foot is wobbling around that's okay to make one robot we want to make thousands maybe millions we haven't got the luxury of making them from carbon fiber titanium we want to make them from plastic things are not quite as stiff so we can't have these high targets i call them dumb targets we've got to make them work at lower targets so is that going to work? well if you think about it sorry about this but we're just bags of soggy jelly and bones thrown in we're not high frequency if i stand on my leg i don't vibrate at 10 hertz people operate at low frequency so we know the robot actually can it just makes controls harder so we take the information from this the modal data and the stiffness and feed that into the control system that allows it to walk so changing tack slightly looking at the knee we can take some inspiration from biology and we can look to see what the mechanical advantage of the knee is it turns out it actually represents quite similar to four-bar link and that's quite nonlinear that's not surprising really because if you think when you bend your leg down the torque on your knee is much more when it's bent than it is when it's straight so you'd expect a nonlinear function and in fact the biology is nonlinear this matches it quite accurately so that's a representation the four-bar link is obviously not physically a four-bar link as i said the characteristics are similar but me bending down that's not very scientific let's be a bit more scientific we've played all the tasks through this graph and this is showing picking things up walking squatting the tasks i said we did on the stress and that's the torque seen at the knee against the knee bend on the horizontal axis this is showing the requirement for the knee to do all these tasks and then put a curve through it surfing over the top of the peaks and that's saying this is what's required to make the robot do these tasks so if we look at the four-bar link that's actually the green curve and it's saying that the nonlinearity of the four-bar link has actually linearized the characteristic of the force what that really says is that's lowered the force that's what makes the actuator have the lowest possible force which is the most efficient we want to burn energy up slowly what's the blue curve? well the blue curve is actually if we didn't have a four-bar link we just had an arm sticking out of my leg here with an actuator on it a simple two-bar link that's the best we could do with a simple two-bar link and it shows that that would create much more force in the actuator which would not be efficient so what does that look like in practice? well as you'll see it's very tightly packaged in the knee you'll see it go transparent in a 2nd you'll see the four-bar link there it's operating on the actuator this is determined the force and the displacements on the actuator i'll now pass you over to konstantinos to tell you a lot more detail about how these actuators are made and designed and optimized thank you thank you malcolm so i would like to talk to you about the design process and the actuator portfolio in our robot so there are many similarities between a car and a robot when it comes to powertrain design the most important thing that matters here is energy mass and cost we are carrying over most of our designing experience from the car to the robot so in the particular case you see a car with two drive units and the drive units are used in order to accelerate the car 0 to 60 miles per hour time or drive a city drive site while the robot that has 28 actuators it's not obvious what are the tasks at actuator level so we have tasks that are higher level like walking or climbing stairs or carrying a heavy object which need to be translated into joint specs therefore we use our model that generates the torque speed trajectories for our joints which subsequently is going to be fed in our optimization model to run through the optimization process this is one of the scenarios that the robot is capable of doing which is turning and walking so when we have this torque speed trajectory we lay it over an efficiency map of an actuator and we are able along the trajectory to generate the power consumption and the cumulative energy for the task versus time so this allows us to define the system cost for the particular actuator and put a simple point into the cloud then we do this for hundreds of thousands of actuators by solving in our cluster and the red line denotes the pareto front which is the preferred area where we will look for optimal so the x denotes the preferred actuator design we have picked for this particular joint so now we need to do this for every joint we have 28 joints to optimize and we parse our cloud again for every joint spec and the red axis this time denotes the bespoke actuator designs for every joint the problem here is that we have too many unique actuator designs and even if we take advantage of the symmetry still there are too many in order to make something mass manufacturable we need to be able to reduce the amount of unique actuator designs therefore we run something called commonality study which we parse our cloud again looking this time for actuators that simultaneously meet the joint performance requirements for more than one joint at the same time so the resulting portfolio is six actuators and they show in a color map in the middle figure and the actuators can be also viewed in this slide we have three rotary and three linear actuators all of which have a great output force or torque per mass the rotary actuator in particular has a mechanical clutch integrated on the high speed side angular contact ball bearing and on the high speed side and on the low speed side a cross roller bearing and the gear train is a strain wave gear there are three integrated sensors here and the bespoke permanent magnet machine the linear actuator has planetary rollers and an inverted planetary screw as a gear train which allows efficiency and compaction and durability so in order to demonstrate the force capability of our linear actuators we have set up an experiment in order to test it under its limits and i will let you enjoy the video so our actuator is able to lift a half-ton nine-foot concert grand piano and this is a requirement it's not something nice to have because our muscles can do the same when they are directly driven our quadriceps muscles can do the same thing it's just that the knee is an up-gearing linkage system that converts the force into velocity at the end effect of our heels for purposes of giving to the human body agility so this is one of the main things that are amazing about the human body and i'm concluding my part at this point and i would like to welcome my colleague mike who is going to talk to you about hand design thank you very much thanks konstantinos so we just saw how powerful a human and a humanoid actuator can be however humans are also incredibly dexterous the human hand has the ability to move at 300 degrees per 2nd it has tens of thousands of tactile sensors it has the ability to grasp and manipulate almost every object in our daily lives for our robotic hand design we are inspired by biology we have five fingers and a posable thumb our fingers are driven by metallic tendons that are both flexible and strong we have the ability to complete wide-aperture power grasps while also being optimized for precision gripping of small thin and delicate objects so why a human-like robotic hand? well the main reason is that our factories and the world around us is designed to be ergonomic so what that means is that it ensures that objects in our factory are graspable but it also ensures that new objects that we may have never seen before can be grasped by the human hand and by our robotic hand as well the converse there is pretty interesting because it's saying that these objects are designed to our hand instead of having to make changes to our hand to accompany a new object some basic stats about our hand is that it has six actuators and 11 degrees of freedom it has an in-hand controller which drives the fingers and receives sensor feedback sensor feedback is really important to learn a little bit more about the objects that we're grasping and also for proprioception and that's the ability for us to recognize where our hand is in space one of the important aspects of our hand is that it's adaptive this adaptability is involved essentially as complex mechanisms that allow the hand to adapt to the objects that's being grasped another important part is that we have a non-back-drivable finger drive this clutching mechanism allows us to hold and transport objects without having to turn on the hand motors you just heard how we went about designing the teslabot hardware now i'll hand it off to milan and our autonomy team to bring this robot to life thanks milan all right so all those cool things we've shown earlier in the video were possible just in a matter of a few months thanks to the amazing work that we've done on autopilot over the past few years most of those components ported quite easily over to the bot's environment if you think about it we're just moving from a robot on wheels to a robot on legs so some of those components are pretty similar and some of them require more heavy lifting for example our computer vision neural networks were ported directly from autopilot to the bot's situation it's exactly the same occupancy network that we'll talk into a little bit more details later with the autopilot team that is now running on the bot here in this video the only thing that changed really is the training data that we had to recollect we're also trying to find ways to improve those occupancy networks using work made on your radiance fields to get really great volumetric rendering of the bot's environments for example here some machinery that the bot might have to interact with another interesting problem to think about is in indoor environments mostly with that sense of gps signal how do you get the bot to navigate to its destination? say for instance to find its nearest charging station so we've been training more neural networks to identify high frequency features key points within the bot's camera streams and track them across frames over time as the bot navigates with its environment and we're using those points to get a better estimate of the bot's pose and trajectory within its environment as it's walking we also did quite some work on the simulation side and this is literally the autopilot simulator to which we've integrated the robot's locomotion code and this is a video of the motion control code running in the autopilot simulator showing the evolution of the robot's walk over time and so as you can see we started quite slowly in april and started accelerating as we unlock more joints and deploy more advanced techniques like arms balancing over the past few months so locomotion is specifically one component that's very different as we're moving from the car to the bot's environment and so i think it warrants a little bit more depth and i'd like my colleagues to start talking about this now thank you milan hi everyone i'm felix i'm a robotics engineer on the project and i'm going to talk about walking walking seems easy right? people do it every day you don't even have to think about it but there are some aspects of walking which are challenging from an engineering perspective for example physical self-awareness that means having a good representation of yourself what is the length of your limbs? what is the mass of your limbs? what is the size of your feet? all that matters also having an energy-efficient gait you can imagine there's different styles of walking and all of them are equally efficient most important keep balance don't fall and of course also coordinate the motion of all of your limbs together so now humans do all of this naturally but as engineers or roboticists we have to think about these problems and therefore i'm going to show you how we address them in our locomotion planning and control stack so we start with locomotion planning and our representation of the bot that means a model of the robot's kinematics dynamics and the contact properties and using that model and the desired path for the bot our locomotion planner generates reference trajectories for the entire system this means feasible trajectories with respect to the assumptions of our model the planner currently works in three stages it starts planning footsteps and ends with the entire motion for the system and let's dive a little bit deeper in how this works so in this video we see footsteps being planned over a planning horizon following the desired path and we start from this and add then for trajectories that connect these footsteps using toe-off and heel strike just as humans do and this gives us a larger stride and less knee bend for high efficiency of the system the last stage is then finding a sense of mass trajectory which gives us a dynamically feasible motion of the entire system to keep balance as we all know plans are good but we also have to realize them in reality let's see how we can do this thank you felix hello everyone my name is anand i'm going to talk to you about controls so let's take the motion plan that felix just talked about and put it in the real world on a real robot let's see what happens it takes a couple of steps and falls down well that's a little disappointing but we are missing a few key pieces here which will make it work now as felix mentioned the motion planner is using an idealized version of itself and a version of reality around it this is not exactly correct it also expresses its intention through trajectories and wrenches wrenches of forces and torques that it wants to exert on the world to locomotive reality is way more complex than any similar model so the robot is not simplified it's got vibrations and modes compliance sensor noise and on and on and on so what does that do to the real world when you put the bot in the real world? well the unexpected forces cause unmodeled dynamics which essentially the planet doesn't know about and that causes destabilization especially for a system that is dynamically stable like biped locomotion so what can we do about it? well we measure reality we use sensors and our understanding of the world to do state estimation and here you can see the attitude and pelvis pose which is essentially the vestibular system in a human along with the center of mass trajectory being tracked when the robot's walking in the office environment now we have all the pieces we need in order to close the loop so we use our better bot model we use the understanding of reality that we've gained through state estimation and we compare what we want versus what we expect the reality is doing to us in order to add corrections to the behavior of the robot here the robot certainly doesn't appreciate being poked but it does an admirable job of staying upright the final point here is a robot that walks is not enough we need it to use its hands and arms to be useful let's talk about manipulation hi everyone my name is eric robotics engineer on tesla bot and i want to talk about how we've made the robot manipulate things in the real world we wanted to manipulate objects while looking as natural as possible and also get there quickly so what we've done is we've broken this process down into two steps first is generating a library of natural motion references or we could call them demonstrations and then we've adapted these motion references online to the current real world situation so let's say we have a human demonstration of picking up an object we can get a motion capture of that demonstration which is visualized right here as a bunch of key frames representing the location of the hands the elbows the torso we can map that to the robot using inverse kinematics and if we collect a lot of these now we have a library that we can work with but a single demonstration is not generalizable to the variation in the real world for instance this would only work for a box in a very particular location so what we've also done is run these reference trajectories through a trajectory optimization program which solves for where the hand should be how the robot should balance when it needs to adapt the motion to the real world so for instance if the box is in this location then our optimizer will create this trajectory instead next milan's going to talk about what's next for the optimist tesla vy thanks thanks eric right so hopefully by now you guys got a good idea of what we've been up to over the past few months we started doing something that's usable but it's far from being useful there's still a long and exciting road ahead of us i think the first thing within the next few weeks is to get optimists at least apart with bumble-c the other bot prototype you saw earlier and probably beyond we are also going to start focusing on the real use case at one of our factories and really going to try to nail this down and iron out all the elements needed to deploy this product in the real world i was mentioning earlier indoor navigation graceful form management or even servicing all components needed to scale this product up but i don't know about you but after seeing what we've shown tonight i'm pretty sure we can get this done within the next few months or years and make this product a reality and change the entire economy so i would like to thank the entire optimist team for their hard work over the past few months i think it's pretty amazing this was done in barely six or eight months thank you very much hey everyone hi i'm ashok i lead the autopilot team alongside milan god it's going to be so hard to top that optimist section we'll try nonetheless anyway every tesla that has been built over the last several years we think of the hardware to make the car drive itself we have been working on the software to add higher and higher levels of autonomy this time around last year we had roughly 2000 cars driving our fsd beta software since then we have significantly improved the software's robustness and capability that we have now shipped it to 160000 customers as of today this did not come for free it came from the sweat and blood of the engineering team over the last one year for example we trained 75000 neural network models just last one year that's roughly a model every eight minutes that's coming out of the team then we evaluate them on our large clusters then we ship 281 of those models that actually improve the performance of the car this space of innovation is happening throughout the stack the planning software the infrastructure the tools even hiring everything is progressing to the next level the fsd beta software is quite capable of driving the car it should be able to navigate from parking lot to parking lot handling city street driving stopping for traffic lights and stop signs negotiating with objects at intersections making turns and so on all of this comes from the camera streams that go through our neural networks that run on the car itself it's not coming back to the server or anything it runs on the car and produces all the outputs to form the world model around the car and the planning software drives the car based on that today we'll go into a lot of the components that make up the system the occupancy network acts as the base geometry layer of the system this is a multi-camera video neural network that from the images predicts the full physical occupancy of the world around the robot anything that's physically present trees walls buildings cars balls whatever you it predicts if it's physically present it predicts them along with their future motion on top of this base level of geometry we have more semantic layers in order to navigate the roadways we need the lanes of course but then the roadways have lots of different lanes and they connect in all kinds of ways so it's actually a really difficult problem for typical computer vision techniques to predict the set of lanes and their connectivities so we reached all the way into language technologies and then pulled the state of the art from other domains and not just computer vision to make this task possible for vehicles we need their full kinematic state to control for them all of this directly comes from neural networks video streams raw video streams come into the networks goes through a lot of processing and then outputs the full kinematic state the positions velocities acceleration jerk all of that directly comes out of networks with minimal post-processing that's really fascinating to me because how is this even possible? what world do we live in that this magic is possible that these networks predict fourth derivatives of these positions and people thought we couldn't even detect these objects? my opinion is that it did not come for free it required tons of data so we had to bid sophisticated auto labeling systems that churned through raw sensor data run a ton of offline compute on the servers it can take a few hours run expensive neural networks distill the information into labels that train our in-car neural networks on top of this we also use our simulation system to synthetically create images and since it's a simulation we trivially have all the labels all of this goes through a well-oiled data engine pipeline where we first train a baseline model with some data ship it to the car see what the failures are and once we know the failures we mine the fleet for the cases where it fails provide the correct labels and add the data to the training set this process systematically fixes the issues and we do this for every task that runs in the car yeah and to train these new massive neural networks this year we expanded our training infrastructure by roughly 40 to 50 percent so that sits us at about 14000 gpus today across multiple training clusters in the united states we also worked on our AI compiler which now supports new operations needed by those neural networks and map them to the best of our underlying hardware resources and our inference engine today is capable of distributing the execution of a single neural network across two independent system on chips essentially two independent computers interconnected within the same full self-driving computer and to make this possible we had to keep a tight control on the end-to-end latency of this new system so we deployed more advanced scheduling code across the full fsd platform all of these neural networks running in the car together produce the vector space which is again the model of the world around the robot of the car and then the planning system operates on top of this coming up with trajectories that avoid collisions or smooth make progress towards the destination using a combination of model-based optimization plus neural network that helps optimize it to be really fast today we are really excited to present progress on all of these areas we have the engineering leads standing by to come in and explain these various blocks and these power not just the car but the same components also run on the optimus robot that milan showed earlier with that i welcome paril to start talking about the planning section hi all i'm paril jain let's use this intersection scenario to dive straight into how we do the planning and decision-making in autopilot so we are approaching this intersection from a side street and we have to yield to all the crossing vehicles right as we are about to enter the intersection the pedestrian on the other side of the intersection decides to cross the road without a crosswalk now we need to yield to this pedestrian yield to the vehicles from the right and also understand the relation between the pedestrian and the vehicle on the other side of the intersection so a lot of these intra-object dependencies that we need to resolve in a quick glance and humans are really good at this we look at a scene understand all the possible interactions evaluate the most promising ones and generally end up choosing a reasonable one so let's look at a few of these interactions that autopilot system evaluated we could have gone in front of this pedestrian with a very aggressive launch and lateral profile obviously we are being a jerk to the pedestrian and we would spook the pedestrian and his cute pet we could have moved forward slowly shot for a gap between the pedestrian and the vehicle from the right again we are being a jerk to the vehicle coming from the right but you should not outright reject this interaction in case this is only safe interaction available lastly the interaction we ended up choosing stay slow initially find the reasonable gap and then finish the maneuver after all the agents pass now evaluation of all of these interactions is not trivial especially when you care about modeling the higher order derivatives for other agents for example what is the longitudinal jerk required by the vehicle coming from the right when you assert in front of it? relying purely on collision checks with marginal predictions will only get you so far because you will miss out on a lot of valid interactions this basically boils down to solving the multi-agent joint trajectory planning problem over the trajectories of ego and all the other agents now how much ever you optimize there's going to be a limit to how fast you can run this optimization problem it will be close to order of 10 milli2nds even after a lot of incremental approximations now for a typical crowded unprotected lift say you have more than 20 objects each object having multiple different future modes the number of relevant interaction combinations will blow up the planner needs to make a decision every 50 milli2nds so how do we solve this in real time? we rely on a framework what we call as interaction search which is basically a parallelized research over a bunch of maneuver trajectories the state space here corresponds to the kinematic state of ego the kinematic state of other agents the nominal future multimodal predictions and all the static entities in the scene the action space is where things get interesting we use a set of maneuver trajectory candidates to branch over a bunch of interaction decisions and also incremental goals for a longer horizon maneuver let's walk through this research very quickly to get a sense of how it works we start with a set of vision measurements namely lanes occupancy moving objects these get represented as sparse attractions as well as latent features we use this to create a set of goal candidates lanes again from the lanes network or unstructured regions which correspond to a probability mask derived from human demonstration once we have a bunch of these goal candidates we create seed trajectories using a combination of classical optimization approaches as well as our network planner again trained on data from the customer fleet now once we get a bunch of these seed trajectories we use them to start branching on the interactions we find the most critical interaction in our case this would be the interaction with respect to the pedestrian whether we assert in front of it or yield to it obviously the option on the left is a high-penalty option it likely won't get prioritized so we branch further onto the option on the right and that's where we bring in more and more complex interactions building this optimization problem incrementally with more and more constraints and the research keeps flowing branching on more interactions branching on more goals now a lot of tricks here lie in evaluation of each of this node of the research inside each node initially we started with creating trajectories using classical optimization approaches where the constraints like i described would be added incrementally and this would take close to one to five milli2nds per action now even though this is fairly good number when you want to evaluate more than 100% interactions this does not scale so we ended up building lightweight variable networks that you can run in the loop of the planner these networks are trained on human demonstrations from the fleet as well as offline solvers with relaxed time limits with this reword able to bring the run time down to close to 100 micro2nds per action now doing this alone is not enough because you still have this massive research that you need to go through and you need to efficiently prune the search space so you need to do scoring on each of these trajectories few of these are fairly standard you do a bunch of collision checks you do a bunch of comfort analysis what is the jerk and access required for a given maneuver the customer fleet data plays an important role here again we run two sets of again lightweight variable networks both really augmenting each other one of them trained from interventions from the fsd beta fleet which gives a score on how likely is a given maneuver to result in interventions over the next few 2nds and 2nd which is purely on human demonstrations human driven data giving a score on how close is your given selected action to a human driven trajectory the scoring helps us prune the search space keep branching further on the interactions and focus the compute on the most promising outcomes the cool part about this architecture is that it allows us to create a cool blend between data driven approaches where you don't have to rely on a lot of hand engineered costs but also grounded in reality with physics based checks now a lot of what i described was with respect to the agents we could observe in the scene but the same framework extends to objects behind occlusions we use the video feed from eight cameras to generate the 3d occupancy of the world the blue mask here corresponds to the visibility region we call it it basically gets blocked at the first occlusion you see in the scene we consume this visibility mask to generate what we call as ghost objects which you can see on the top left now if you model the spawn regions and the state transitions of these ghost objects correctly if you tune your control response as a function of their existence likelihood you can extract some really nice human like behaviors now i'll pass it on to phil to describe more on how we generate these occupancy networks thank you hey guys my name is phil i will share the details of the occupancy network we built over the past year this network is our solution to model the physical world in 3d around our cars and it is currently not shown in our customer facing visualization what you will see here is the raw network output from our internal lab tool the occupancy network takes video streams of all our eight cameras as input produces a single unified volumetric occupancy in vector space directly for every 3d location around our car it predicts the probability of that location being occupied or not since it has video context it is capable of predicting obstacles that are occluded instantaneously for each location it also produces a set of semantics such as curb car pedestrian and road debris as color coded here occupancy flow is also predicted for motion since the model is a generalized network it does not tell static and dynamic objects explicitly it is able to produce and model the random motion such as a swerving trainer here this network is currently running in all teslas with fsd computers and it is incredibly efficient runs about every 10 milli2nds with our neural net accelerator so how does this work? let's take a look at the architecture first we rectify each camera images with a camera calibration and the images we're showing here we're giving to the network it's actually not the typical 8-bit rgb image as you can see from the first image on top we're giving the 12-bit raw photo account image to the network since it has four bits more information it has 16 times better dynamic range as well as reduced latency since we don't have to run isp in the loop anymore we use a set of reglets and a bag of fpms as a backbone to extract image space features next we construct a set of 3d position query along with the image space features as keys and values fit into an attention module the output of the attention module is high dimensional spatial features these spatial features are aligned temporally using vehicle odometry to derive motion next these spatial temporal features go through a set of deconvolution to produce the final occupancy and occupancy flow output they're formed as fixed-size voxel grid which might not be precise enough for planning and control in order to get a higher resolution we also produce per-voxel feature maps which will feed into mlp with 3d spatial point queries to get position and semantics at any arbitrary location after knowing the model better let's take a look at another example here we have an articulated bus parked on the right side of the road highlighted as an l-shaped voxel here as we approach the bus starts to move the front of the car turns blue first indicating the model predicts the front of the bus has a long zero occupancy flow and as the bus keeps moving the entire bus turns blue and you can also see that the network predicts the precise curvature of the bus well this is a very complicated problem for traditional object detection network as you have to see whether i'm going to use one cuboid or perhaps two to fit the curvature but for occupancy network since all we care about is the occupancy in the visible space and we'll be able to model the curvature precisely besides the voxel grid the occupancy network also produces a drivable surface the drivable surface has both 3d geometry and semantics they are very useful for control especially on hilly and curvy roads the surface and the voxel grid are not predicted independently instead the voxel grid actually aligns with the surface implicitly here we are at a hill crest where you can see the 3d geometry of the surface being predicted nicely planner can use this information to decide perhaps we need to slow down more for the hill crest and as you can also see the voxel grid aligns with the surface consistently besides the voxels and the surface we're also very excited about the recent breakthrough in neural radians field or lerf we're looking to both incorporate some of the last lerf features into occupancy network training as well as using our network output as the input state for lerf as a matter of fact ashok is very excited about this this has been his personal weekend project for a while these lerfs because i think academia is building a lot of these foundation models for language using tons of large data sets for language but i think for vision ners are going to provide the foundation models for computer vision because they are grounded in geometry and geometry gives us a nice way to supervise these networks and freezes the requirement to define an ontology and the supervision is essentially free because you just have to differentially render these images so i think in the future this occupancy network idea where images come in and then the network produces a consistent volumetric representation of the scene that can then be differentially rendered into any image that was observed i personally think is a future of computer vision and we do some initial work on it right now but i think in the future both at tesla and in academia we will see that this combination of one-shot prediction of volumetric occupancy will be the future that's my personal bet so here's an example early result of a 3d reconstruction from our free data instead of focusing on getting perfect rgb rep projection in image space our primary goal here is to accurately represent the world in 3d space for driving and we want to do this for all our free data all over the world in all weather and lighting conditions and obviously this is a very challenging problem and we're looking for you guys to help finally the occupancy network is trained with large auto-labeled data set without any human in the loop and with that i'll pass to tim to talk about what it takes to train this network thanks phil all right hey everyone let's talk about some training infrastructure so we've seen a couple of videos you know four or five i think and care more and worry more about a lot more clips on that so we've been looking at the occupancy networks just from phil just phil's videos it takes 14 billion frames to train that network what you just saw and if you have 100000 gpus it would take one hour but if you have one gpu it would take 100000 hours so that is not a humane time period that you can wait for your training job to run right? you want to ship faster than that so that means you're going to need to go parallel so you need more compute for that that means you're going to need a supercomputer so this is why we've built in-house three supercomputers comprising of 14000 gpus where we use 10000 gpus for training and run 4000 gpus for auto-labeling all these videos are stored in 30 petabytes of a distributed managed video cache you shouldn't think of our data sets as fixed let's say as you think of your imagenet or something with like a million frames you should think of it as a very fluid thing so we've got half a million of these videos flowing in and out of these clusters every single day and we track 400000 of these kind of python video instantiations every 2nd so that's a lot of calls you're going to need to capture that in order to govern the retention policies of this distributed video cache so underlying all of this is a huge amount of infra all of which we build and manage in-house so you cannot just buy 14000 gpus and then 30 petabytes of flash nvme and just put it together and let's go train it actually takes a lot of work and i'm going to go into a little bit of that what you actually typically want to do is you want to take your accelerator so that could be the gpu or dojo which we'll talk about later and because that's the most expensive component that's where you want to put your bottleneck and so that means that every single part of your system is going to need to outperform this accelerator and so that is really complicated that means that your storage is going to need to have the size and the bandwidth to deliver all the data down into the nodes these nodes need to have the right amount of cpu and memory capabilities to feed into your machine learning framework this machine learning framework then needs to hand it off to your gpu and then you can start training but then you need to do so across hundreds or thousands of gpu in a reliable way in lockstep and in a way that's also fast so you're also going to need an interconnect extremely complicated we'll talk more about dojo in a 2nd so first i want to take you through some optimizations that we've done on our cluster so we're getting in a lot of videos and video is very much unlike let's say training on images or text which i think is very well established video is quite literally a dimension more complicated and so that's why we needed to go end to end from the storage layer down to the accelerator and optimize every single piece of that because we train on the photon count videos that come directly from our fleet we train on those directly we do not post process those at all the way it's just done is we seek exactly to the frames we select for our batch we load those in including the frames that they depend on so these are your i frames or your key frames we package those up move them into shared memory move them into a double buffer on the gpu and then use the hardware decoder that's only accelerated to actually decode the video we do that on the gpu natively and it's all in a very nice python bitorch extension doing so unlocks more than 30% training speed increase for the occupancy networks and frees up basically the whole cpu to do any other thing you cannot just do training with just videos of course you need some kind of a ground truth and that is actually an interesting problem as well the objective for storing your ground truth is that you want to make sure you get to your ground truth that you need in the minimal amount of file system operations and load in the minimal size of what you need in order to optimize for aggregate cross cluster throughput because you should see a compute cluster as one big device which has internally fixed constraints and thresholds so for this we rolled out a format that is native to us that's called small we use this for our ground truth our feature cache and any inference outputs so a lot of tensors that are in there and so just a cartoon here let's say these are your is your table that you want to store then that's how that would look out if you rolled out on disk so what you do is you take anything you'd want to index on so for example video timestamps you put those all in the header so that in your initial header read you know exactly where to go on disk then if you have any tensors you're going to try to transpose the dimensions to put a different dimension last as the contiguous dimension and then also try different types of compression then you check out which one was most optimal and then store that one this is actually a huge step if you do feature caching unintelligible output from the machine learning network rotate around the dimensions a little bit you can get up to 20% increase in efficiency of storage then when you store that we also order the columns by size so that all your small columns and small values are together so that when you seek for a single value you're likely to overlap with the read on more values which you'll use later so that you don't need to do another file system operation so i can go on and on i just went on touched on two projects that we have internally but this is actually part of a huge continuous effort to optimize the compute that we have in house so accumulating and aggregating through all these optimizations we now train our occupancy networks twice as fast just because it's twice as efficient and now if we add in a bunch more compute and go parallel we can now train this in hours instead of days and with that i'd like to hand it off to the biggest user of compute john hi everybody my name is john emmons i lead the autopilot vision team i'm going to cover two topics with you today the first is how we predict lanes and the 2nd is how we predict the future behavior of other agents on the road in the early days of autopilot we modeled the lane detection problem as an image space instant segmentation task our network was super simple though in fact it was only capable of predicting lanes of a few different kinds of geometries specifically it would segment the eagle lane it could segment adjacent lanes and then it had some special casing for forks and merges this simplistic modeling of the problem worked for highly structured roads like highways but today we're trying to build a system that's capable of much more complex maneuvers specifically we want to make left and right turns at intersections where the road topology can be quite a bit more complex and diverse when we try to apply this simplistic modeling of the problem here it just totally breaks down taking a step back for a moment what we're trying to do here is to predict the sparse set of lane instances and their connectivity and what we want to do is to have a neural network that basically predicts this graph where the nodes are the lane segments and the edges encode the connectivities between these lanes so what we have is our lane detection neural network it's made up of three components in the first component we have a set of convolutional layers attention layers and other neural network layers that encode the video streams from our eight cameras on the vehicle and produce a rich visual representation we then enhance this visual representation with a coarse road level map data which we encode with a set of additional neural network layers that we call the lane guidance module this map is not an hd map but it provides a lot of useful hints about the topology of lanes inside of intersections the lane counts on various roads and a set of other attributes that help us the first two components here produce a dense tensor that sort of encodes the world so what we really want to do is to convert this dense tensor into a sparse set of lanes and their connectivities we approach this problem like an image captioning task where the input is this dense tensor and the output text is predicted into a special language that we developed at tesla for encoding lanes and their connectivities in this language of lanes the words and tokens are the lane positions in 3d space in the ordering of the tokens it predicted modifiers in the tokens encode the connective relationships between these lanes by modeling the task as a language problem we can capitalize on recent auto-regressive architectures and techniques from the language community for handling the multiplicity of the problem we're not just solving the computer vision problem at autopilot we're also applying the state of the art in language modeling and machine learning more generally i'm now going to dive into a little bit more detail of this language component what i have depicted on the screen here is a satellite image which sort of represents the local area around the vehicle the set of nodes and edges is what we refer to as the lane graph and it's ultimately what we want to, of this neural network we start with a blank slate we're going to want to make our first prediction here at this green dot this green dot's position is encoded as an index into a coarse grid which discretizes the 3d world now we don't predict this index directly because it would be too computationally expensive to do so there's just too many grid points and predicting a categorical distribution over this has both implications at training time and test time so instead what we do is we discretize the world coarsely first we predict a heat map over the possible locations and then we latch in the most probable location condition on this we then refine the prediction and get the precise point now we know where the position of this token is but we don't know its type in this case though it's the beginning of a new lane so we predict it as a start token and because it's a start token there's no additional attributes in our language we then take the predictions from this first forward pass and we encode them using a learned positional embedding which produces a set of tensors that we combine together which is actually the first word in our language of lanes we add this to the first position in our sentence here we then continue this process by predicting the next lane point in a similar fashion now this lane point is not the beginning of a new lane it's actually a continuation of the previous lane so it's a continuation token type now it's not enough just to know that this lane is connected to the previously predicted lane we want to encode its precise geometry which we do by regressing a set of spline coefficients we then take this lane we encode it again and add it as the next word in the sentence we continue predicting these continuation lanes until we get to the end of the prediction grid we then move on to a different lane segment so you can see that cyan dot there now it's not topologically connected to that pink point it's actually forking off of that green point there so it's got a fork type and fork tokens actually point back to previous tokens from which the fork originates so you can see here the fork point predictor is actually the index zero so it's actually referencing back to tokens that it's already predicted like you would in language we continue this process over and over again until we've enumerated all of the tokens in the lane graph and then the network predicts the end of sentence token yeah i just wanted to note that the reason we do this is not just because we want to build something complicated it almost feels like a turing complete machine here with neural networks though is that we tried simpler approaches for example trying to just segment the lanes along the road or something like that but then the problem is when there's uncertainty say you cannot see the road clearly and there could be two lanes or three lanes and you can't tell a simple segmentation-based approach would just draw both of them it's kind of a 25 lane situation and the post-crossing algorithm would hilariously fail when the predictions are such yeah and the problems don't end there i mean you need to predict these connective lanes inside of intersections which it's just not possible with the approach that ashok's mentioning which is why we had to upgrade to this sort of yeah when it overlaps like this segmentation would just go haywire but even if you try very hard to put them on separate layers it's just a really hard problem but language just offers a really nice framework for getting a sample from a posterior as opposed to trying to do all of this in post-crossing but this doesn't actually stop for just autopilot right john? this can be used for optimists yeah i guess they wouldn't be called lanes but you could imagine in this stage here that you might have paths that encode the possible places that people could walk yeah basically if you're in a factory or in a home setting you can just ask the robot okay let's me please route to the kitchen or please route to some location in the factory and then we predict a set of pathways that would go through the aisles take the robot and say okay this is how you get to the kitchen it just really gives us a nice framework to model these different paths that simplify the navigation problem for the downstream planner all right so ultimately what we get from this lane detection network is a set of lanes and their connectivity which comes directly from the network there's no additional step here for sparsifying these dense predictions into sparse ones this is just the direct unfiltered output of the network okay so i talked a little bit about lanes i'm going to briefly touch on how we model and predict the future paths and other semantics on objects i'm going to go through two examples the video on the right here we've got a car that's running a red light and turning in front of us what we do to handle situations like this is we predict a set of short time horizon future trajectories on all objects we can use these to anticipate the dangerous situation here and apply whatever braking and steering actions required to avoid a collision in the video on the right there's two vehicles in front of us the one on the left lane is parked apparently it's being loaded unloaded i don't know why the driver decided to park there the important thing is that our neural network predicted that it was stopped which is the red color there the vehicle in the other lane as you notice also is stationary that one is obviously just waiting for that red light to turn green even though both objects are stationary and have zero velocity it's the semantics that is really important here so that we don't get stuck behind that awkwardly parked car predicting all of these agent attributes presents some practical problems when trying to build a realtime system we need to maximize the frame rate of our object section stack so that autopilot can quickly react to the changing environment every milli2nd really matters here to minimize the inference latency our neural network is split into two phases in the first phase we identify the locations in 3d space where agents exist in the 2nd stage we then pull out tensors at those 3d locations append it with additional data that's on the vehicle and then we do the rest of the processing this specification step allows the neural network to focus compute on the areas that matter most which gives us superior performance for a fraction of the latency cost so putting it all together the autopilot vision stack predicts more than just the geometry and kinematics of the world it also predicts a rich set of semantics which enables safe and human-like driving i'm now going to hand things off to sharif who will tell us how we run all these cool neural networks on our fsd computer thank you hi everyone i'm sri today i'm going to give a glimpse of what it takes to run these fsd networks in the car and how do we optimize for the inference latency today i'm going to focus just on the fsd lanes network that john just talked about so when we started this track we wanted to know if we can run this fsd lanes network natively on the trip engine which is our in-house neural network accelerator that we built in the fsd computer when we built this hardware we kept it simple and we made sure it can do one thing ridiculously fast dense dot products now this architecture is autoregressive and iterative where it crunches through multiple attention blocks in the inner loop producing sparse points directly at every step so the challenge here was how can we do this sparse point prediction and sparse computation on a dense dot product engine? let's see how we did this on the trip so the network predicts the heat map of most probable spatial locations of the point now we do an argmax and a one-hot operation which gives the one-hot encoding of the index of the spatial location now we need to select the embedding associated with this index from an embedding table that is learned during training to do this on trip we actually built a lookup table in s-ram and we engineered the dimensions of this embedding such that we could achieve all of these things with just matrix multiplication not just that we also wanted to store this embedding into a token cache so that we don't recompute this for every iteration rather reuse it for future point prediction again we put some tricks here where we did all these operations just on the dot product engine it's actually cool that our team found creative ways to map all these operations on the trip engine in ways that were not even imagined when this hardware was designed but that's not the only thing we had to do to make this work we actually implemented a whole lot of operations and features to make this model compilable to improve the intake accuracy as well as to optimize performance all of these things helped us run this 75 million parameter model just under 10 milli2nds of latency consuming just 8 watts of power but this is not the only architecture running in the car there are so many other architectures modules and networks we need to run in the car to give a sense of scale there are about a billion parameters of all the networks combined producing around 1000 neural network signals so we need to make sure we optimize them jointly and such that we maximize the computer utilization throughput and minimize the latency so we built a compiler just for neural networks that shares the structure to traditional compilers as you can see it takes the massive graph of neural nets with 150k nodes and 375k connections takes this thing partitions them into independent subgraphs and compels each of those subgraphs natively for the inference devices then we have a neural network linker which shares the structure to traditional linker where we perform this link time optimization there we solve an offline optimization problem with compute memory and memory bandwidth constraints so that it comes with an optimized schedule that gets executed in the car on the runtime we designed a hybrid scheduling system which basically does heterogeneous scheduling on one soc and distributed scheduling across both the socs to run these networks in a model parallel fashion to get 100 tops of compute utilization we need to optimize across all the layers of software right from tuning the network architecture the compiler all the way to implementing a low latency high bandwidth rdma link across both the socs and in fact going even deeper to understanding and optimizing the cache coherent and non-coherent data paths of the accelerator in the soc this is a lot of optimization at every level in order to make sure we get the highest frame rate and as every milli2nd counts here and this is just the visualization of the neural networks that are running in the car this is our digital brain essentially as you can see these operations are nothing but just the matrix multiplication convolution to name a few real operations running in the car to train this network with a billion parameters you need a lot of labeled data so egan is going to talk about how do we achieve this with the auto labeling pipeline thank you sri hi everyone i'm egan zhang and i'm leading geometric vision at autopilot so yeah let's talk about auto labeling so we have several kinds of auto labeling frameworks to support various types of networks but today i'd like to focus on the awesome lanesnet here so to successfully train and generalize this network to everywhere we think we went tens of millions of trips from probably one million intersection or even more so how to do that? so it is certainly achievable to store a sufficient amount of trips because we already have as tim explained earlier we already have like 500000 trips per day cache rate however converting all of those data into a training form is a very challenging technical problem to solve this challenge we've tried various ways of manual and auto labeling so from the first column to the 2nd from the 2nd to the third each advance provided us nearly 100x improvement in throughput but still we want an even better auto labeling machine that can provide us good quality diversity and scalability to meet all these requirements despite the huge amount of engineering effort required here we've developed a new auto labeling machine powered by multi-trip reconstruction so this can replace five million hours of manual labeling with just 12 hours of cluster for labeling 10000 trips so how we solved? there are three big steps the first step is high precision trajectory and structure recovery by multi-camera visual inertia odometry so here all the features including ground surface are inferred from videos by neural networks then tracked and reconstructed in the vector space so the typical drift rate of this trajectory in car is like 13 centimeter per meter and 045 milli radian per meter which is pretty decent considering its compact compute requirement then the recovery surface and road details are also used as a strong guidance for the later manual verification stuff this is also enabled in every fsd vehicle so we get pre-processed trajectories and structures along with the trip data the 2nd step is multi-trip reconstruction which is the big and core piece of this machine so the video shows how the previously shown trip is reconstructed and aligned with other trips basically other trips from different vehicles not the same vehicle so this is done by multiple internal steps like coarse alignment pairwise matching joint optimization then further surface refinement in the end the human analyst comes in and finalizes the label so each habit step is already fully parallelized on the cluster so the entire process usually takes just a couple of hours the last step is actually auto-labeling the new trips so here we use the same multi-trip alignment engine but only between pre-built reconstruction and each new trip so it's much much simpler than fully reconstructing all the clips altogether that's why it only takes 30 minutes per trip to auto-label instead of several hours of manual labeling and this is also the key of scalability of this machine this machine easily scales as long as we have available compute and trip data so about 50 trips were newly auto-labeled from this scene and some of them are shown here so 53 from different vehicles so this is how we capture and transform the spacetime slices of the world into the network super pigeon one thing i'd like to note is that jigen just talked about how we auto-label our lanes but we have auto-labels for almost every task that we do including our planner and many of these are fully automatic there's no humans involved for example for objects all the kinematics the shapes the futures everything just comes from auto-labeling and the same is true for occupancy too and we have really just built a machine around this yeah so if you can go back one slide one more it says parallelized on cluster so that sounds pretty straightforward but it really wasn't maybe it's fun to share how something like this comes about so a while ago we didn't have any auto-labeling at all and then someone makes a script it starts to work it starts working better until we reach a volume that's pretty high and we clearly need a solution and so there were two other engineers in our team who were like hey you know that's an interesting thing what we needed to do was build a whole graph of essentially python functions that would need to run one after the other first you pull the clip then you do some cleaning then you do some network inference then another network inference until you finally get this but so you need to do this at a large scale so i tell them we probably need to shoot for you know 100000 clips per day or like 100000 items that seems good and so the engineer said well we can do you know a bit of postgres and a bit of elvo grease we can do it meanwhile we are a bit later and we're doing 20 million of these functions every single day again we pull in around half a million clips and on those we run a ton of functions each of these in a streaming fashion and so that's kind of the backend the info that's also needed to not just run training but also auto labeling yeah it really is like a factory that produces labels and it's like production lines yield quality inventory all of the same concepts applied to this label factory that applies for you know the factory for our cars that's right okay thanks tim and ashok so yeah so concluding this section i'd like to share a few more challenging and interesting examples for network for sure and even for humans probably so from the top there's like examples for like lack of lights case or foggy night or roundabout and occlusion by heavy occlusions by parked cars and even rainy night with raindrops on camera lenses these are challenging but once their original scenes are fully reconstructed by other clips all of them can be auto labeled so that our cars can drive even better through these challenging scenarios so now let me pass the mic to david to learn more about how sim is creating the new world on top of these labels thank you thank you jagen my name is david and i'm going to talk about simulation so simulation plays a critical role in providing data that is difficult to source and or hard to label however 3d scenes are notoriously slow to produce take for example the simulated scene playing behind me a complex intersection from market street in san francisco it would take two weeks for artists to complete and for us that is painfully slow however i'm going to talk about using jagen's automated ground truth labels along with some brand new tooling that allows us to procedurally generate this scene in many like it in just five minutes that's an amazing 1000 times faster than before so let's dive in to how a scene like this is created we start by piping the automated ground truth labels into our simulated world creator tooling inside the software houdini starting with road boundary labels we can generate a solid road mesh and re-topologize it with the lane graph labels this helps inform important road details like cross road slope and detailed material blending next we can use the line data and sweep geometry across its surface and project it to the road creating lane paint decals next using median edges we can spawn to island geometry and populate it with randomized foliage this drastically changes the visibility of the scene now the outside world can be generated through a series of randomized heuristics modular building generators create visual obstructions while randomly placed objects like hydrants can change the color of the curbs while trees can drop leaves below it obscuring lines or edges next we can bring in map data to inform positions of things like traffic lights or stop signs we can trace along its normal to collect important information like number of lanes and even get accurate street names on the signs themselves next using lane graph we can determine lane connectivity and spawn directional road markings on the road and their accompanying road signs and finally with lane graph itself we can determine lane adjacency and other useful metrics to spawn randomized traffic permutations inside our simulator and again this is all automatic no artists in the loop and happens within minutes and now this sets us up to do some pretty cool things since everything is based on data and heuristics we can start to fuzz parameters to create visual variations of the single ground truth it can be as subtle as object placement and random material swapping to more drastic changes like entirely new biomes or locations of environment like urban suburban or rural this allows us to create infinite targeted permutations for specific ground truths that we need more ground truth for and all this happens within a click of a button and we can even take this one step further by altering our ground truth itself dejohn wants his network to pay more attention to directional road markings to better detect an upcoming captive left turn lane we can start to procedurally alter our lane graph inside the simulator to help focus to create entirely new flows through this intersection to help focus the network's attention to the road markings to create more accurate predictions and this is a great example of how this tooling allows us to create new data that can never be collected from the real world and the true power of this tool is in its architecture and how we can run all tasks in parallel to infinitely scale so you saw the tile creator tool in action converting the ground truth labels into their counterparts next we can use our tile extractor tool to divide this data into geohash tiles about 150 meters square in size we then save out that data into separate geometry and instance files this gives us a clean source of data that's easy to load and allows us to be rendering engine agnostic for the future then using a tile loader tool we can summon any number of those cache tiles using a geohash id currently we're doing about these 5 by 5 tiles or 3 by 3 usually centered around fleet hotspots or interesting lane graph locations and the tile loader also converts these tile sets into u assets for consumption by the unreal engine and gives you a finished product from what you saw on the first slide this really sets us up for size and scale as you can see on the map behind us we can easily generate most of san francisco city streets and this didn't take years or even months of work but rather two weeks by one person we can continue to manage and grow all this data using our pdg network inside of the tooling this allows us to throw compute at it and regenerate all these tile sets overnight this ensures all environments are of consistent quality and features which is super important for training since new ontologies and signals are constantly released and now to come full circle because we generated all these tile sets from ground truth data that contain all the weird intricacies from the real world and we can combine that with the procedural visual and traffic variety to create limitless targeted data for the network to learn from and that concludes the siem section i'll pass it to kate to talk about how we can use all this data to improve autopilot thank you thanks david hi everyone my name is kate park and i'm here to talk about the data engine which is the process by which we improve our neural networks via data we're going to show you how we deterministically solve interventions via data and walk you through the life of this particular clip in this scenario autopilot is approaching a turn and incorrectly predicts that crossing vehicle as stopped for traffic and thus a vehicle that we would slow down for in reality there's nobody in the car it's just awkwardly parked we built this tooling to identify the mispredictions correct the label and categorize this clip into an evaluation set this particular clip happens to be one of 126 that we've diagnosed as challenging parked cars at turns because of this infra we can curate this evaluation set without any engineering resources accustomed to this particular challenge case to actually solve that challenge case requires mining thousands of examples like it and it's something tesla can trivially do we simply use our data sourcing infra request data and use the tooling shown previously to correct the labels by surgically targeting the mispredictions of the current model we're only adding the most valuable examples to our training set we surgically fixed 13900 clips and because those were examples where the current model struggles we don't even need to change the model architecture a simple weight update with this new valuable data is enough to solve the challenge case so you see we no longer predict that crossing vehicle as stopped as shown in orange but parked as shown in red in academia we often see that people keep data constant but at tesla it's very much the opposite we see time and time and again that data is one of the best if not the most deterministic lever to solving these interventions we just showed you the data engine loop for one challenge case namely these parked cars at turns but there are many challenge cases even for one signal of vehicle movement we apply this data engine loop to every single challenge case we've diagnosed whether it's buses curvy roads stopped vehicles parking lots and we don't just add data once we do this again and again to perfect the semantic in fact this year we updated our vehicle movement signal five times and with every weight update trained on the new data we push our vehicle movement accuracy up and up this data engine framework applies to all our signals whether they're 3d multicam video whether the data is human labeled auto labeled or simulated whether it's an offline model or an online model and tesla is able to do this at scale because of the fleet advantage the infra that our eng team has built and the labeling resources that feed our networks to train on all this data we need a massive amount of compute so i'll hand it off to pete and ganesh to talk about the dojo supercomputing platform thank you thank you katie thanks everybody we're almost there my name is pete bannon i run the custom silicon and low voltage teams at tesla and my name is ganesh venkate i run the dojo program thank you i'm frequently asked why is a car company building a supercomputer for training? and this question fundamentally misunderstands the nature of tesla at its heart tesla is a hardcore technology company all across the company people are working hard in science and engineering to advance the fundamental understanding and methods that we have available to build cars energy solutions robots and anything else that we can do to improve the human condition around the world it's a super exciting thing to be a part of and it's a privilege to run a very small piece of it in a semiconductor group tonight we're going to talk a little bit about dojo and give you an update on what we've been able to do over the last year but before we do that i wanted to give a little bit of background on the initial design that we started a few years ago when we got started the goal was to provide a substantial improvement to the training latency for our autopilot team some of the largest neural networks they train today run for over a month which inhibits their ability to rapidly explore alternatives and evaluate them so a 30x speedup would be really nice if we could provide it at a cost competitive and energy competitive way to do that we wanted to build a chip with a lot of arithmetic units that we could utilize at a very high efficiency and we spent a lot of time studying whether we could do that using dram various packaging ideas all of which failed and in the end even though it felt like an unnatural act we decided to reject dram as the primary storage medium for this system and instead focus on sram embedded in the chip sram provides unfortunately a modest amount of capacity but extremely high bandwidth and very low latency and that enables us to achieve high utilization with the arithmetic units those choices that particular choice led to a whole bunch of other choices for example if you want to have virtual memory you need page tables they take up a lot of space we didn't have space so no virtual memory we also don't have interrupts the accelerator is a bare bones raw piece of hardware that's presented to a compiler and the compiler is responsible for scheduling everything that happens in a deterministic way so there's no need or even desire for interrupts in the system we also chose to pursue model parallelism as a training methodology which is not the typical situation most machines today use data parallelism which consumes additional memory capacity which we obviously don't have so all of those choices led us to build a machine that is pretty radically different from what's available today we also had a whole bunch of other goals one of the most important ones was no limits so we wanted to build a compute fabric that would scale in an unbounded way for the most part i mean obviously there's physical limits now and then but pretty much if your model was too big for the computer you just had to go buy a bigger computer that's what reword looking for today the way machines are packaged there's a pretty fixed ratio of for example gpus cpus and dram capacity and network capacity and we really wanted to desegregate all that so that as models evolved we could vary the ratios of those various elements and make the system more flexible to meet the needs of the autopilot team yeah and it's so true pete like no limits philosophy was our guiding star all the way all of our choices were centered around that and to the point that we didn't want traditional data center infrastructure to limit our capacity to execute these programs at speed so that's why we integrated vertically our data center the entire data center by doing a vertical integration of the data center we could extract new levels of efficiency we could optimize power delivery cooling and as well as system management across the whole data center stack rather than doing box by box and integrating those boxes into data centers and to do this we also wanted to integrate early to figure out limits of scale for our software workloads so we integrated dojo environment into our autopilot software very early and we learned a lot of lessons and today bill chang will go over our hardware update as well as some of the challenges that we faced along the way and rajiv kurian will give you a glimpse of our compiler technology as well as go over some of our cool results great thanks pete thanks ganesh i'll start tonight with a high level vision of our system that will help set the stage for the challenges and the problems we're solving and then also how software will then leverage this for performance now our vision for dojo is to build a single unified accelerator a very large one software would see a seamless compute plane with globally addressable very fast memory and all connected together with uniform high bandwidth and low latency now to realize this we need to use density to achieve performance now we leverage technology to get this density in order to break levels of hierarchy all the way from the chip to the scale out systems now silicon technology has used this has done this for decades chips have followed moore's law for density integration to get performance scaling now a key step in realizing that vision was our training tile not only can we integrate 25 dies at extremely high bandwidth but we can scale that to any number of additional tiles by just connecting them together now last year we showcased our first functional training tile and at that time we already had workloads running on it and since then the team here has been working hard and diligently to deploy this at scale now we've made amazing progress and had a lot of milestones along the way and of course we've had a lot of unexpected challenges but this is where our fail fast philosophy has allowed us to push our boundaries now pushing density for performance presents all new challenges one area is power delivery here we need to deliver the power to our compute die and this directly impacts our top line compute performance but we need to do this at unprecedented density we need to be able to match our die pitch with a power density of almost one amp per millimeter squared and because of the extreme integration this needs to be a multi-tiered vertical power solution and because there's a complex heterogeneous material stack up we have to carefully manage the material transition especially cte now why does the coefficient of thermal expansion matter in this case? cte is a fundamental material property and if it's not carefully managed that stack up would literally rip itself apart so we started this effort by working with vendors to develop this power solution but we realized that we actually had to develop this in-house now to balance schedule and risk we built quick iterations to support both our system bring up and software development and also to find the optimal design and stack up that would meet our final production goals and in the end reword able to reduce cte over 50% and meet our performance by 3x over our initial version now needless to say finding this optimal material stack up while maximizing performance at density is extremely difficult now we did have unexpected challenges along the way here's an example where we pushed the boundaries of integration that led to component failures this started when we scaled up to larger and longer workloads and then intermittently a single site on a tile would fail now they started out as recoverable failures but as we pushed to much higher and higher power these would become permanent failures now to understand this failure you have to understand why and how we build our power modules solving density at every level is the cornerstone of actually achieving our system performance now because our xy plane is used for high bandwidth communication everything else must be stacked vertically this means all other components other than our die must be integrated into our power modules now that includes our clock and our power supplies and also our system controllers now in this case the failures were due to losing clock output from our oscillators and after an extensive debug we found that the root cause was due to vibrations on the module from piezoelectric effects on nearby capacitors now singing caps are not a new phenomenon and in fact very common in power design but normally clock chips are placed in a very quiet area of the board and often not affected by power circuits but because we needed to achieve this level of integration these oscillators need to be placed in very close proximity now due to our switching frequency and then the vibration resonance created it caused out of plane vibration on our mems oscillator that caused it to crack now the solution to this problem is a multi-prong approach we can reduce the vibration by using soft terminal caps we can update our mems part with a lower q factor for the out of plane direction and we can also update our switching frequency to push the resonance further away from these sensitive bands now addition to the density at the system level we've been making a lot of progress at the infrastructure level we knew that we had to re-examine every aspect of the data center infrastructure in order to support our unprecedented power and cooling density we brought in a fully custom designed cdu to support dojo's dense cooling requirements and the amazing part is we're able to do this at a fraction of the cost versus buying off the shelf and modifying it and since our dojo cabinet integrates enough power and cooling to match an entire row of standard it racks we need to carefully design our cabinet and infrastructure together and we've already gone through several iterations of this cabinet to optimize this and earlier this year we started load testing our power and cooling infrastructure and reword able to push it over two megawatts before we tripped our substation and got a call from the city now last year we introduced only a couple of components of our system the custom d1 die and the training tile but we teased the exit pod as our end goal we'll walk through the remaining parts of our system that are required to build out this exit pod now the system tray is a key part of realizing our vision of a single accelerator it enables us to seamlessly connect tiles together not only within the cabinet but between cabinets we can connect these tiles at very tight spacing across the entire accelerator and this is how we achieve our uniform communication this is a laminate bus bar that allows us to integrate very high power mechanical and thermal support and an extremely dense integration it's 75 millimeters in height and supports six tiles at 135 kilograms this is the equivalent of three to four fully loaded high performance racks next we need to feed data to the training tiles this is where we've developed the dojo interface processor it provides our system with high bandwidth dram to stage our training data and it provides full memory bandwidth to our training tiles using ttp our custom protocol that we use to communicate across our entire accelerator it also has high speed ethernet that helps us extend this custom protocol over standard ethernet and we provide native hardware support for this with little to no software overhead and lastly we can connect to it through a standard gen 4 pcie interface now we pair 20 of these cards per tray and that gives us 640 gigabytes of high bandwidth dram and this provides our disaggregated memory layer for our training tiles these cards are a high bandwidth ingest path both through pcie and ethernet they also provide a high rate xz connectivity path that allows shortcuts across our large dojo accelerator now we actually integrate the host directly underneath our system tray these hosts provide our ingest processing and connect to our interface processors through pcie these hosts can provide hardware video decoder support for video-based training and our user applications land on these hosts so we can provide them with the standard x86 linux environment now we can put two of these assemblies into one cabinet and pair it with redundant power supplies that do direct conversion of three-phase 480 volt ac power to 52 volt dc power now by focusing on density at every level we can realize the vision of a single accelerator now starting with the uniform nodes on our custom d1 die we can connect them together in our fully integrated training tile and then finally seamlessly connecting them across cabinet boundaries to form our dojo accelerator and altogether we can house two full accelerators in our exopod for a combined one exoflop of ml compute now altogether this amount of technology and integration has only ever been done a couple of times in the history of compute next we'll see how software can leverage this to accelerate their performance thanks bill my name is rajiv and i'm going to talk some numbers our software stack begins with the pytorch extension that speaks to our commitment to run standard pytorch models out of the box we're going to talk more about our jit compiler and the ingest pipeline that feeds the hardware with data abstractly performance is tops times utilization times accelerator occupancy we've seen how the hardware provides peak performance as the job of the compiler to extract utilization from the hardware while code is running on it and it's the job of the ingest pipeline to make sure that data can be fed at a throughput high enough for the hardware to not ever starve let's talk about why communication-bound models are difficult to scale but before that let's look at why resnet-50-like models are easier to scale you start off with a single accelerator run the forward and backward passes followed by the optimizer then to scale this up you run multiple copies of this on multiple accelerators and while the gradients produced by the backward pass do need to be reduced and this introduces some communication this can be done pipeline with the backward pass this setup scales fairly well almost linearly for models with much larger activations we run into a problem as soon as we want to run the forward pass the batch size that fits in a single accelerator is often smaller than the batch norm surface so to get around this researchers typically run this setup on multiple accelerators in sync batch norm mode this introduces latency-bound communication to the critical path of the forward pass and we already have a communication bottleneck and while there are ways to get around this they usually involve tedious manual work best suited for a compiler and ultimately there's no skirting around the fact that if your state does not fit in a single accelerator you can be communication-bound and even with significant efforts from our ml engineers we see such models don't scale linearly the dojo system was built to make such models work at high utilization the high density integration was built to not only accelerate the compute-bound portions of a model but also the latency-bound portions like a batch norm or the bandwidth-bound portions like a gradient all reduced or a parameter all gathered a slice of the dojo mesh can be carved out to run any model the only thing users need to do is to make the slice large enough to fit a batch norm surface for their particular model after that the partition presents itself as one large accelerator freeing the users from having to worry about the internal details of execution and it's the job of the compiler to maintain this abstraction long-grain synchronization primitives and uniform low latency makes it easy to accelerate all forms of parallelism across integration boundaries tensors are usually stored sharded in sram and replicated just in time for layers execution we depend on the high dojo bandwidth to hide this replication time tensor replication and other data transfers are overlapped with compute and the compiler can also recompute layers when it's profitable to do so we expect most models to work out of the box as an example we took the recently released stable diffusion model and got it running on dojo in minutes out of the box the compiler was able to map it in a model parallel manner on 25 dojo dies here's some pictures of a cyber truck on mars generated by stable diffusion running on dojo looks like it still has some ways to go before matching the design studio team so we've talked about how communication bottlenecks can hamper scalability perhaps an acid test of a compiler and the underlying hardware is executing a cross-type bash form layer like mentioned before this can be a serial bottleneck the communication phase of a bash form begins with nodes computing their local mean and standard deviations then coordinating to reduce these values then broadcasting these values back and then they resume their work in parallel so what would an ideal bash form look like on 25 dojo dies? let's say the previous layer's activations are already split across dies we would expect the 350 nodes on each die to coordinate and produce die local mean and standard deviation values ideally these would get further reduced with the final value ending somewhere towards the middle of the tile we would then hope to see a broadcast of this value radiating from the center let's see how the compiler actually executes a real bash form operation across 25 dies the communication trees were extracted from the compiler and the timing is from a real hardware one we're about to see 8750 nodes on 25 dies coordinating to reduce and then broadcast the bash form mean and standard deviation values global reduction followed by global reduction towards the middle of the tie then the reduced value broadcast radiating from the middle accelerated by the hardware's broadcast facility this operation takes only 5 micro2nds on 25 dojo dies the same operation takes 150 micro2nds ON24 gpus this is in orders of magnitude improvement over gpus and while we talked about an all-reduce operation in the context of a batch norm it's important to reiterate that the same advantages apply to all other communication primitives and these primitives are essential for large-scale training so how about full model performance? so while we think that resnet-50 is not a good representation of real-world tesla workloads it is a standard benchmark so let's start there we are already able to match the a100 die for die however perhaps a hint of dojo's capabilities is that we're able to hit this number with just a batch of 8 per die but dojo was really built to tackle larger complex models so when we set out to tackle real-world workloads we looked at the usage patterns of our current gpu cluster and two models stood out the auto-labeling networks a class of offline models that are used to generate ground truth and the occupancy networks that you heard about the auto-labeling networks are large models that have high arithmetic intensity while the occupancy networks can be in just bound we chose these models because together they account for a large chunk of our current gpu cluster usage and they would challenge the system in different ways so how do we do on these two networks? the results we're about to see were measured on multi-die systems for both the gpu and dojo but normalized to per die numbers on our auto-labeling network we're already able to surpass the performance of an a100 with our current hardware running on our older generation of vrms on our production hardware with our newer vrms that translates to doubling the throughput of an a100 and our models show that with some key compiler optimizations we could get to more than 3x the performance of an a100 we see even bigger leaps on the occupancy network so 3x with our production hardware with room for more so what does that mean for tesla? with our current level of compiler performance we could replace the ml computer of one two three four five and six gpu boxes with just a single dojo tile and this dojo tile costs less than one of these gpu boxes what it really means is that networks that took more than a month to train now take less than a week alas when we measure things it did not turn out so well at the pytorch level we did not see our expected performance out of the gate and this timeline chart shows our problem the teeny tiny little green bars that's the compile code running on the accelerator the row is mostly white space where the hardware is just waiting for data with our dense ml compute dojo hosts effectively have 10x more ml compute than the gpu hosts the data loaders running on this one host simply couldn't keep up with all that ml hardware so to solve our data loader scalability issues we knew we had to get over the limit of this single host the tesla transport protocol moves data seamlessly across host tiles and ingest processors so we extended the tesla transport protocol to work over ethernet we then built the dojo network interface card the dnic to leverage ttp over ethernet this allows any host with a dnic card to be able to dm it to and from other ttp endpoints so we started with the dojo mesh then we added a tier of data loading hosts equipped with the dnic card we connected these hosts to the mesh via an ethernet switch now every host in this data loading tier is capable of reaching all ttp endpoints in the dojo mesh via hardware accelerated dma after these optimizations went in our occupancy went from 4% to 97% the data loading sections have reduced drastically and the ml hardware has kept busy we actually expect this number to go to 100% pretty soon after these changes went in we saw the full expected speed up from the pytorch layer and reword back in business so we started with hardware design that breaks through traditional integration boundaries in service of our vision of a single giant accelerator we've seen how the compiler and ingest layers build on top of that hardware so after proving our performance on these complex real-world networks we knew what our first large-scale deployment would target our high arithmetic intensity auto labeling networks today that occupies 4000 gpus over 72 gpu racks with our dense computer and our high performance we expect to provide the same throughput with just four dojo cabinets and these four dojo cabinets will be part of our first exapod that we plan to build by quarter one of 2023 this will more than double tesla's auto labeling capacity the first exapod is part of a total of seven exapods that we plan to build in palo alto right here across the wall and we have a display cabinet from one of these exapods for everyone to look at six tiles densely packed on a tray 54 petaflops of compute 640 gigabytes of high bandwidth memory with power and host defeated a lot of compute and we're building out new versions of all our cluster components and constantly improving our software to hit new limits of scale we believe that we can get another 10x improvement with our next generation hardware and to realize our ambitious goals we need the best software and hardware engineers so please come talk to us or visit teslacom thank you all right so hopefully that was enough detail and now we can move to questions and guys i think the team came out on stage we really wanted to show the depth and breadth of tesla in artificial intelligence compute hardware robotics actuators and try to really shift the perception of the company away from a lot of people think we're just a car company or we make cool cars or whatever but most people have no idea that tesla is arguably the leader in real world AI hardware and software and that we're building what is arguably the most radical computer architecture since the crayon supercomputer and i think if you're interested in developing some of the most advanced technology in the world that's going to really affect the world in a positive way tesla's the place to be so yeah let's fire away with some questions i think there's a mic at the front and a mic at the back just throw mics at people yeah hi thank you very much i was impressed here i was impressed very much by optimus but i wonder why tendon-driven the hunt? why did you choose a tendon-driven approach for the hunt? because tendons are not very durable and why spring-loaded? yeah hello? is this working? cool awesome yes that's a great question when it comes to any type of actuation scheme there's trade-offs between whether or not it's a tendon-driven system or some type of linkage-based system keep the mic close to your mouth a little bit closer hear me? cool so yeah the main reason why we went for a tendon-based system is that first we actually investigated some synthetic tendons but we found that metallic bowden cables are a lot stronger so one of the advantages of these cables is that it's very good for part reduction we do want to make a lot of these hands so having a bunch of parts a bunch of small linkages ends up being a problem when you're making a lot of something one of the big reasons that tendons are better than linkages in a sense is that you can be anti-backlash so anti-backlash essentially allows you to not have any gaps or stuttery motion in your fingers spring-loaded mainly what spring-loaded allows us to do is it allows us to have active opening so instead of having to have two actuators to drive the fingers closed and then open we have the ability to have the tendon drive them closed and then the springs passively extend and this is something that's seen in our hands as well we have the ability to actively flex and then we also have the ability to extend yeah i mean our goal with optimus is to have a robot that is maximally useful as quickly as possible so there's a lot of ways to solve the various problems of a humanoid robot and we're probably not barking up the right tree on all the technical solutions and i should say that we're open to evolving the technical solutions that you see here over time they're not lucked in stone but we have to pick something and we want to pick something that's going to allow us to produce the robot as quickly as possible and have it like i said be useful as quickly as possible we're trying to follow the goal of fastest path to a useful robot that can be made at volume and we're going to test the robot internally at tesla in our factory and just see like how useful is it? because you have to have a you've got to close the loop on reality to confirm that the robot is in fact useful and yeah so we're just going to use it to build things and we're confident we can do that with the hand that we have currently designed but for sure there will be hand version two version three and we may change the architecture quite significantly over time sorry hi the optimus robot is really impressive you did a great job bipedal robots are really difficult but what i noticed might be missing from your plan is to acknowledge the utility of the human spirit and i'm wondering if optimus will ever get a personality and be able to laugh at our jokes while it folds our clothes yeah absolutely i think we want to have really fun versions of optimus so that optimus can both be utilitarian and do tasks but can also be kind of like a friend and a buddy and hang out with you and i'm sure people will think of all sorts of creative uses for this robot and once you have the core intelligence and actuators figured out then you can actually put all sorts of costumes i guess on the robot you can make the robot look you can skin the robot in many different ways and i'm sure people will find very interesting ways to yeah versions of optimus thanks for the great presentation i wanted to know if there was an equivalent to interventions in optimus it seems like labeling through moments where humans disagree with what's going on is important and in a humanoid robot that might be also a desirable source of information i think we'll have ways to remote operate the robot and intervene when it does something bad especially when we are training the robot and bringing it up and hopefully we design it in a way that we can stop the robot from if it's going to hit something we can hold it and it will stop it won't crush your hand or something and those are all intervention data yeah and we can learn a lot from our simulation systems too where we can check for collisions and supervise that those are bad actions yeah so optimus we want over time for it to be an android the kind of android that you'd seen in sci-fi movies like star trek the next generation like data but obviously we could program the robot to be less robot-like and more friendly and it can obviously learn to emulate humans and feel very natural so as AI in general improves we can add that to the robot and it should be obviously able to do simple instructions or even intuit what it is that you want so you could give it a high-level instruction and then it can break that down into a series of actions and take those actions hi yeah it's exciting to think that with the optimus you will think that you can achieve orders of magnitude of improvement in economic output that's really exciting and when tesla started the mission was to accelerate the advent of renewable energy or sustainable transport so with the optimus do you still see that mission being the mission statement of tesla? or is it going to be updated with mission to accelerate the advent of infinite abundance or limitless economy? yeah it is not strictly speaking optimus is not strictly speaking directly in line with accelerating sustainable energy to the degree that it is more efficient at getting things done than a person it does i guess help with sustainable energy but i think the mission effectively does somewhat broaden with the advent of optimus to i don't know make the future awesome so i think you look at optimus and i don't know about you but i'm excited to see what optimus will become and this is like if you could tell any given technology do you want to see what it's like in a year two years three years four years five years 10? i'd say for sure you definitely want to see what's happening with optimus whereas a bunch of other technologies are sort of plateaued got name names here so i think optimus is going to be incredible in five years 10 years is mind blowing and i'm really interested to see that happen i hope you are too i have a quick question here i'm justin and i was wondering are you planning to extend conversational capabilities for the robot? and my 2nd follow-up question to that is what's the end goal? what's the end goal with optimus? yeah optimus would definitely have conversational capabilities so you'd be able to talk to it and have a conversation and it would feel quite natural so from an end goal standpoint i don't know i think it's going to keep evolving and i'm not sure where it ends up but someplace interesting for sure we always have to be careful about the don't go down the terminator path that's a i thought maybe we should start off with a video of like the terminator starting off with the skull crushing but that might be people might take that too seriously so we do want optimus to be safe so we are designing in safeguards where you can locally stop the robot and with like basically a localized control rom that you can't update over the internet which i think that's quite important essential frankly so like a localized stop button or remote control something like that that cannot be changed but it's definitely going to be interesting it won't be boring so i'm not sure okay yeah i see you today you have very attractive product with dojo and its applications so i'm wondering what's the future for the dojo platform? will you like provide like infrastructure and service like aws or you will like sell the chip like the nvidia? so basically what's the future? because i see you use a 7-nanometer so the development cost is like easily over 10 million us dollars how do you make the business like business wise? yeah i mean dojo is a very big computer and actually will be use a lot of power and needs a lot of cooling so i think it's probably going to make more sense to have dojo operate in like amazon web services manner than to try to sell it to someone else so that would be the most efficient way to operate dojo is just have it be a system a service that you can use that's available online and that where you can train your models way faster and for less money and as the world transitions to software 20 and that's on the bingo card someone i know has to know how to drink five tequilas so let's see software 20 will use a lot of neural net training so it kind of makes sense that over time as there's more neural net stuff people will want to use the fastest lowest cost neural net training system so i think there's a lot of opportunity in that direction hi my name is ali jahanian thank you for this event it's very inspirational my question is i'm wondering what is your vision for humanity robots that understand our emotions and art and can contribute to our creativity? well i think there's this you're already seeing robots that at least are able to generate very interesting art with like like dali and dali 2 and i think we'll start seeing AI that can actually generate even movies that have a that have coherence like interesting movies and tell jokes so it's quite remarkable how fast AI is advancing at many companies besides tesla we're headed for a very interesting future and yeah so you guys want to comment on that? yeah i guess the optimist robot can, with physical art not just digital art you can you know you can ask for some dance moves in text or voice and then you can produce those in the future so it's a lot of like physical art not just digital art oh yeah yeah computers can absolutely make physical art yeah yeah yeah like dance play soccer or whatever you mean it needs to get more agile but over time for sure thanks so much for the presentation for the tesla autopilot slides i noticed that the models that you were using were heavily motivated by language models and i was wondering what the history of that was and how much of an improvement it gave i thought that that was a really interesting curious choice to use language models for the lane transitioning so there's sort of two aspects for why we transition to language modeling so the first talk loud and close okay okay got it yeah so the language models help us in two ways the first way is that it lets us predict lanes that we couldn't have otherwise as ashok mentioned earlier basically when we predicted lanes in sort of a dense 3d fashion you can only model certain kinds of lanes but we want to get those crisscrossing connections inside of intersections it's just not possible to do that without making it a graph prediction if you try to do this with dense segmentation it just doesn't work also the lane prediction is a multimodal problem sometimes you just don't have sufficient visual information to know precisely how things look on the other side of the intersection so you need a method that can generalize and produce coherent predictions you don't want to be predicting two lanes and three lanes at the same time you want to commit to one and a general model like these language models provides that hi hi my name is giovanni yeah thanks for the presentation that's really nice i have a question for fsd team so for the neural networks how do you test how do you do unit tests software unit tests on that? like do you have like a bunch or i don't know thousands or yes cases where the neural network that after you train it you have to pass it before you release it to as a product right? yeah what's your software unit testing strategies for this basically? yeah glad you asked there's like a series of tests that we have defined starting from unit tests for software itself but then for the neural network models we have vip sets defined where you can define if you just have a large test set that's not enough what we find we need like sophisticated vip sets for different failure modes and then we cure them and grow them over the time of the product so over the years we have like hundreds of thousands of examples where we have been failing in the past that we have curated and so we for any new model we test against the entire history of these failures and then keep adding to this test set on top of this we have shadow modes where we ship these models in silent to the car and we get data back on where they are failing or succeeding and there's extensive qa program it's very hard to ship a regression there's like nine levels of filters before it hits customers but then we have really good infra to make this all efficient i'm one of the qa testers so i qa the car so i'm constantly in the car just being qaing like whatever the latest alpha bolt is that doesn't totally crash finds a lot of bugs hi great event i have a question about foundational models for autonomous driving we have all seen that big models that really can when you scale up with data and model parameter right from gpt-3 to pom it can actually now do reasoning do you see that is essential scaling up foundational models with data and size and then at least you can get a teacher model right that potentially can solve all the problems and then you distill to a student model is that how you see foundational models relevant for autonomous driving? that's quite similar to our auto labeling models so we don't just have models that run in the car we train models that are entirely offline that are extremely large that can't run in real time on the car so we just run those offline on our servers producing really good labels that can then train the online networks so that's one form of distillation of these teacher student models in terms of foundational models we are building some really really large data sets that are multiple petabytes and we are seeing that some of these tasks work really well when we have these large data sets like the kinematics like i mentioned video in all the kinematics out of all the objects and up to the fourth derivative and people thought we couldn't do detection with cameras detection depth velocity acceleration and imagine how precise these have to be for these higher order derivatives to be accurate and this all comes from these large data sets and large models so we are seeing the equivalent of foundation models in our own way for geometry and kinematics and things like those do you want to add anything john? yeah i'll keep it brief basically whenever we train on a larger data set we see big improvements in our model performance and basically whenever we initialize our networks with some pre-training step from some other auxiliary task we basically see improvements the self-supervised or supervised with large data sets both help a lot hi so at the beginning elon said that tesla was potentially interested in building artificial general intelligence systems given the potentially transformative impact of technology like that it seems prudent to invest in technical agi safety expertise specifically i know tesla does a lot of technical narrow AI safety research i was curious if tesla was intending to try to build expertise in technical artificial general intelligence safety specifically well i mean if we start looking like we're going to be making a significant contribution to artificial general intelligence then we'll for sure invest in safety i think there should be an AI regulatory authority at the government level just as there is a regulatory authority for anything that affects public safety so we have regulatory authority for aircraft and cars and food and drugs because they affect public safety AI also affects public safety so i think and this is not really something that government i think understands yet but i think there should be a referee that is ensuring or trying to ensure public safety for agi and you think of like well what are the elements that are necessary to create agi? the accessible data set is extremely important and if you've got a large number of cars and humanoid robots processing petabytes of video data and audio data from the real world just like humans that might be the biggest data set it probably is the biggest data set because in addition to that you can obviously incrementally scan the internet but what the internet can't quite do is have millions or hundreds of millions of cameras in the real world and like i said with audio and other sensors as well so i think we probably will have the most amount of data and probably the most amount of training power therefore probably we will make a contribution to agi hey i noticed the semi was back there but we haven't talked about it too much i was just wondering for the semi truck what are the changes you're thinking about from a sensing perspective? i imagine there's very different requirements obviously than just a car and if you don't think that's true why is that true? no i think basically you can drive a car i mean think about what drives any vehicle it's a biological neural net with eyes with cameras essentially and really what is your primary sensors are two cameras on a slow gimbal a very slow gimbal that's your head so if a biological neural net with two cameras on a slow gimbal can drive a semi truck then if you've got like eight cameras with continuous 360 degree vision operating at a higher frame rate and much higher reaction rate then i think it is obvious that you should be able to drive a semi or any vehicle much better than human hi my name is akshay thank you for the event assuming optimus would be used for different use cases and would evolve at different phase for these use cases would it be possible to sort of develop and deploy different software and hardware components independently and deploy them in optimus so that the overall feature development is faster for optimus? i'm trying to see the question we did not comprehend unfortunately our neural net did not comprehend the question next question hi i want to switch the gear to the autopilot so when you guys plan to roll out the fsd beta to countries other than us and canada and also my next question is what's the biggest bottleneck or the technological barrier you think in the current autopilot stack and how you envision to solve that to make the autopilot is considerably better than human in terms of performance matrix like safety assurance and the human confidence i think you also mentioned for fsd v11 you guys going to combine the highway and the city as a single stack and some architectural big improvements can you maybe expand a bit on that? thank you well that's a whole bunch of questions we're hopeful to be able to i think from a technical standpoint fsd beta should be possible to roll out fsd beta worldwide by the end of this year but for a lot of countries we need regulatory approval and so we are somewhat gated by the regulatory approval in other countries but i think from a technical standpoint it will be ready to go to a worldwide beta by the end of this year and there's quite a big improvement that we're expecting to release next month that will be especially good at assessing the velocity of fast moving cross traffic and a bunch of other things so anyone want to elaborate? yeah i guess so there used to be a lot of differences between production autopilot and the full self-driving beta but those differences have been getting smaller and smaller over time i think just a few months ago we now use the same vision only object detection stack in both fsd and in the production autopilot on all vehicles there's still a few differences the primary one being the way that we predict lanes right now so we upgraded the modeling of lanes so that it could handle these more complex geometries like i mentioned in the talk in production autopilot we still use a simpler lane model but we're extending our current fsd beta models to work in all sort of highway scenarios as well yeah and the version of fsd beta that i drive actually does have the integrated stack so it uses the fsd stack both in city streets and highway and it works quite well for me but we need to validate it in all kinds of weather like heavy rain snow dust and just make sure it's working better than the production stack across a wide range of environments but we're pretty close to that i mean i think it's i don't know maybe it'll definitely be before the end of the year and maybe november yeah in our personal drives the fsd stack on highway drives already way better than the production stack we have and we do expect to also include the parking lot stack as a part of the fsd stack before the end of this year so that will basically bring us to you sit in the car in the parking lot and drive till the end of the parking lot at a parking spot before the end of this year and in terms of like the fundamental metric to optimize against is how many miles per between a necessary intervention so just massively improving the how many miles the car can drive on in full autonomy before an intervention is required that is safety critical so yeah that's the fundamental metric that we're measuring every week and we're making radical improvements on that hi thank you so much for the presentation very inspiring my name is daisy i actually have a non-technical question for you i'm curious if you are back to your 20s what are some of the things you wish you knew back then what are some advice you would give to your younger self? well i'm trying to figure out something useful to say yeah join tesla would be one thing yeah i think just try to expose yourself to as many smart people as possible i don't read a lot of books you know i did do that though so i think there's some merit to just also like not being like necessarily too intense and like enjoying the moment a bit more i would say to 20 something me just you know stop and smell the roses occasionally would probably be a good idea you know it's like when reword developing the falcon 1 rocket and on the kwajalein atoll and we had this beautiful little island that we're developing the rocket on and not once during that entire time did i even have a drink on the beach i'm like i should have had a drink on the beach that would have been fine thank you very much i think you have excited all of the robotics people with optimus this feels very much like 10 years ago in driving but as driving has proved to be harder than it actually looked 10 years ago what do we know now that we didn't 10 years ago that would make for example agi on a humanoid come faster? well i mean it seems to me that agi is advancing very quickly hardly a week goes by without some significant announcement and yeah i mean at this point like AI seems to be able to win at almost any rule-based game it's able to create extremely impressive art engage in conversations that are very sophisticated you know write essays and these just keep improving and there's so much more so many more talented people working on AI and the hardware is getting better i think it's a AI is on a super like a strong exponential curve of improvements independent of what we do at tesla and obviously we'll benefit somewhat from that exponential curve of improvement with AI tesla just also happens to be very good at actuators motors gearboxes controllers power electronics batteries sensors and you know really like i say that you know the biggest difference between the robot on four wheels and the robot with arms and legs is getting the actuators right it's an actuators and sensors problem and obviously how you control those actuators and sensors but it's yeah actuators and sensors and how you control the actuators i don't know we happen to have like the ingredients necessary to create a compelling robot and we're doing it hi ilan you are actually bringing the humanity to the next level literally tesla and you are bringing the humanity to the next level so you said optimus prime optimus will be used in next tesla factory my question is will a new tesla factory will be fully run by optimus program and when can general public order a humanoid? yeah i think it'll you know we're gonna start optimus with very simple tasks in the factory you know like maybe just like loading a part like you saw in the video loading a part you know carrying apart from one place to another or loading a part into a one of our more conventional robot Sales to you know that welds body together so we'll start you know just trying to how do we make it useful at all and then gradually expand the number of situations where it's useful and i think that the number of situations where optimus is useful will grow exponentially like really really fast in terms of when people can order one i don't know i think it's not that far away well i think you mean when can people receive one so i don't know i'm like i'd say probably within three years and not more than five years within three to five years you could probably receive an optimus i feel the best way to make the progress for agi's to involve as many smart people across the world as possible and given the size and resource of tesla compared to robot companies and given the state of humanoid research at the moment would it make sense for the kind of tesla to sort of open source some of the simulation hardware parts i think tesla can still be the dominant platformer where it can be something like android os or like ios stuff for the entire humanoid research would that be something that rather than keeping the optimus to just tesla researchers or the factory itself can you open that and let the whole world explore humanoid research i think we have to be careful about optimus being potentially used in ways that are bad because that is one of the possible things to do so i think we would provide optimus where you can provide instructions to optimus but where those instructions are governed by some laws of robotics that you cannot overcome so not doing harm to others and i think probably quite a few safety related things with optimus we'll just take maybe a few more questions and then thank you all for coming questions one deep and one broad on the deep for optimus what's the current and what's the ideal controller bandwidth and then in the broader question there's this big advertisement for the depth and breadth of the company what is it uniquely about tesla that enables that? anyone want to tackle the bandwidth question? so the technical bandwidth of the close to your mouth and loud okay for the bandwidth question you have to understand or figure out what is the task that you wanted to do and if you took a frequency transform of that task what is it that you want your limbs to do and that's where you get your bandwidth from it's not a number that you can specifically just say you need to understand your use case and that's where the bandwidth comes from what is the broad question? the breadth and depth thing i can answer the breadth and depth on the bandwidth question i think we probably will just end up increasing the bandwidth or you know which translates to the effective dexterity and reaction time of the robot like it's safe to say it's not one hertz and it's maybe you don't need to go all the way to a hundred hertz but i don't know maybe 10 25 i don't know over time i think the bandwidth will increase quite a bit or translated to dexterity and latency you'd want to minimize that over time minimize latency maximize dexterity in terms of breadth and depth i guess we've got we're a pretty big company at this point so we've got a lot of different areas of expertise that we necessarily have to develop in order to make autonomous or in order to make electric cars and then in order to make autonomous electric cars tesla is like a whole series of startups basically and so far they've almost all been quite successful so we must be doing something right and you know i consider one of my core responsibilities in running the company is to have an environment where great engineers can flourish and i think in a lot of companies i don't know maybe most companies if somebody's a really talented driven engineer they're unable to actually their talents are suppressed at a lot of companies and it's you know and some of the companies that engineering talent is suppressed in a way that is maybe not obviously bad but where it's just so comfortable and you paid so much money and you're the output you actually have to produce is so low that's like a honey trap you know so like there's a few honey traps places in silicon valley where they don't necessarily don't seem like bad places for engineers but you have to say like a good engineer went in and what did they get out and the output of that engineering talent seems very low even though they seem to be enjoying themselves that's why i call it there's a few honey trap companies in silicon valley tesla is not a honey trap we're demanding and it's like you're gonna get a lot of shit done and it's gonna be really cool and it's not gonna be easy but if you are a super talented engineer your talents will be used i think to a greater degree than anywhere else you know spacex also that way thailand i have two questions so both to the autopilot team so the thing is like i have been following your progress for the past few years so today you have made changes on like the lane detection like you said that like previously we're doing instant semantic segmentation now you guys are built transform models for like building the lanes so what are another some other common challenges which you guys are facing right now like which you are solving in future as a curious engineer so that like we as a researcher can work on those start working on those and the 2nd question is like i'm really curious about the data engine like you guys have like told a case like by the car is stopped so how are you finding cases which is very much similar to that from the data which you have like so a little bit more on the data engine would be great i'll start answer the first question using occupancy network as an example so what you saw in the presentation did not exist a year ago so we only spent one year about time we actually shaped more than 12 occupancy network and to have a one foundation model actually to represent the entire physical world around everywhere and you always the condition is actually really really challenging so only over a year ago we're kind of like driving a 2d world if there's a wall and if there's curve we kind of represent with the same static edge which is obviously you know not not ideal right there's a big difference between a curb and a wall when you drive you make different choices right so after we realized that we have to go to 3d we have to basically rethink the entire problem and think about how we address that so this will be like one example of challenges we have we have a conquer in the past year yeah to answer the question about how we actually source examples of the tricky stopped cars there's a few ways to go about this but two examples are one we can trigger for disagreements within our signals so let's say that parked bit flickers between parked and driving we'll trigger that back and the 2nd is we can leverage more of the shadow mode logic so if the customer ignores the car but we think we should stop for it we'll get that data back too so these are just different like various trigger logic that allows us to get those data campaigns back hi thank you for the amazing presentation thanks so much so there are a lot of companies that are focusing on the agi problem and one of the reasons why it's such a hard problem is because the problem itself is so hard to define several companies have several different definitions they focus on different things so what is tesla how's just are defining the agi problem and what are you focusing on specifically? well we're not actually specifically focused on agi i'm simply saying that agi is seems likely to be an emergent property of what we're doing because we're creating all these autonomous cars and autonomous humanoids that are actually with a truly gigantic data stream that's coming in and being processed it's by far the most amount of real-world data and data you can't get by just searching the internet because you have to be out there in the world and interacting with people and interacting with the roads and just you know earth is a big place and reality is messy and complicated so i think it's sort of like likely to just it just seems likely to be an emergent property of if you've got you know tens or hundreds of millions of autonomous vehicles and maybe even a comparable number of humanoids maybe more than that on the humanoid front well that's just the most amount of data and if that that video is being processed it just seems likely that you know the cars will definitely get way better than human drivers and the humanoid robots will become increasingly indistinguishable from humans perhaps and so then like i said you have this emergent property of agi and arguably the you know humans collectively are sort of a super intelligence as well especially as we improved the data rate between humans i mean the thing like that seemed to me way back in the early days the internet was like the internet was like humanity acquiring a nervous system where now all of a sudden any one element of humanity could know all of the knowledge of humans by connecting to the internet almost all the knowledge or certainly a huge part of it whereas previously we would exchange information by osmosis by you know by we'd have like in order to transfer data so you would have to write a letter somewhere we have to carry the letter by person to another person and then a whole bunch of things in between and then it was like yeah i mean insanely slow when you think about it and even if you were in the library of congress you still didn't have access to all the world's information and you certainly couldn't search it and obviously very few people are in the library of congress so i mean one of the great sort of equality elements like the internet has been the most the biggest equalizer in history in terms of access to information and knowledge and any student of history i think would agree with this because you know you go back a thousand years there were very few books like and books would be incredibly expensive but only a few people knew how to read and only if an even smaller number of people even had a book now now look at it like you can access any book instantly you can learn anything for basically for free it's pretty incredible so you know i was asked recently what period of history would i prefer to be at the most and my answer was right now this is the most interesting time in history and i read a lot of history so let's oh yeah let's do our best to keep that going yeah and to go back to one of the earlier questions i would answer like you can the thing that's happened over time with respect to tesla autopilot is that we've just the the neural nets have gotten have gradually absorbed more and more software and in the limit of course you could simply take the videos as seen by the car and compare those to these the steering inputs from the steering wheel and pedals which are very simple inputs and it in principle you could train with nothing in between because that's what humans are doing with a biological neural net you could train based on video and and what trains the video is the moving of the steering wheel and the pedals with no other software in between in between we're not there yet but it's gradually going in that direction all right well wait one last question i think we've got a question at the front here hello there right there i will do two questions fine thanks for such a great presentation we'll do your question last okay cool with fsd being used by so many people do you think what's the comp how do you evaluate the company's risk tolerance in terms of performance statistics and do you think there needs to be more transparency or regulation from third parties as to how what's good enough and defining like thresholds for performance across some many miles sure well the you know the number one design requirement at tesla is safety so like and that goes across the board so in terms of the mechanical safety of the car we have the lowest probability of injury of any cars ever tested by the government for just a passive mechanical safety essentially crash structure and airbags and whatnot we have the best highest rating for active safety as well and i think it's going to get to the point where you the active safety is so ridiculously good it's it's it's like just absurdly better than a human and then with respect to autopilot we do publish this broadly speaking the statistics on miles driven or with cars that have no autonomy or tesla cars with no autonomy with kind of hardware one hardware two hardware three and then the ones that are in fsd beta and we see steady improvements all along the way and you know sometimes there's this dichotomy of you know should you wait until the car is like on earth three times safer than a person before deploying any technology but i think that's that is actually morally wrong at the point of which you believe that that adding autonomy reduces injury and death i think you have a moral obligation to deploy it even though you're going to get sued and blamed by a lot of people because the people whose lives you saved don't know that their lives are saved and the people the people who do occasionally die or get injured they definitely know or their estate does that it was you know whatever there was a problem with with with autopilot that's why you have to look at the at the numbers in sort of total miles driven how many accidents occurred how many accidents were serious how many fatalities and you know we've got well over three million cars on the road so this is that's a lot of miles driven every day it's not going to be perfect but what matters it is that is that it is very clearly safer than not deploying it yeah so i think last question i think yeah thanks well the last question here okay okay hi so i do not work on hardware so maybe the hardware team and you guys can enlighten me why is it required that there be symmetry in the design of optimus because humans we have handedness right we are we use some set of muscles more than others over time there is wear and tear right so maybe you'll start see some joint failures or some actuator failures more over time i understand that this is extremely pre-stage also we as humans have based so much fantasy and fiction or superhuman capabilities like all of us don't want to walk right over there we want to extend our arms and like we have all these you know a lot of fantasy fantastical designs so considering everything else that is going on in terms of batteries and intensity of compute maybe you can leverage all those aspects into coming up with something well i don't know more interesting in terms of your the robot that you're building and i'm hoping you are able to explore those directions yeah i mean i think it would be cool to have like you know make inspector gadget real that would be pretty sweet so yeah i mean right now we just want to make basic humanoid what work well and our goal is fastest path to a useful humanoid robot i think this is this will ground us in reality literally and ensure that we are doing something useful like one of the hardest things to do is to be useful to to actually and then and then to have high utility under the curve of like how many people did you help time you know and how much help did you provide to each person on average and then how many people did you help the total utility like trying to actually ship useful product that people like to a large number of people is so insanely hard it's boggles the mind you know so i could say like man there's a hell of a difference between a company that is ship product and one has not ship product it's again this is night and day and then even once you ship product can you make the cost the value of the output worth more than the cost of the input which is again insanely difficult especially with hardware so but i think over time i think it would be cool to do creative things and have like eight arms and whatever and have different versions and maybe you know there'll be some hardware like companies that are able to add things to an optimist like maybe we've you know add a power port or something like that or attachment you can add you know add attachments to your optimist like you can add them to your phone it could be so a lot of cool things that could be done over time and it could be maybe an ecosystem of small companies that or big companies that make add-ons for optimists so with that i'd like to thank the team for their hard work you guys are awesome and thank you all for coming and for everyone online thanks for tuning in and i think this will be one of those great videos where you can like if you you can fast forward to the bits that you find most interesting but we try to give you a tremendous amount of detail literally so you can look at the video at your leisure and you can focus on the parts that you find interesting and skip the other parts so thank you all and we'll do this try to do this every year and we might do a part a monthly podcast even so but i think it'd be you know great to sort of bring you along for the ride and and like show you what what cool things are happening and yeah thank you all right thanks for listening.</p>
            </main>
        </div><!-- /.entry-content -->
    </article>
</section>
        <section id="extras" class="body">

        <!-- /.blogroll -->
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://indeXall.io">Side project: indeXall.io</a></li>
                            <li><a href="https://btobsales.eu">Services: BtoBSales.EU</a></li>
                        </ul>
                </div>

        <!-- /.social -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://www.linkedin.com/in/ndeville/">Linkedin</a></li>
                            <li><a href="https://www.twitter.com/ndeville">Twitter</a></li>
                        </ul>
                </div>
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Powered by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>, 
                with <a href="https://stork-search.net/" target="_blank">Stork</a> & <a href="https://github.com/pelican-plugins/search" target="_blank">Pelican Search plugin</a>.
                <br>
                <a href="https://clearbit.com" target="_blank">Logos provided by Clearbit</a>
                <br>
                <!-- <span style="color:#C74350">|</span> <img src="https://notes.nicolasdeville.com/images/python.svg" alt="python_logo" width="16" style="vertical-align: middle;"/> <a href="https://www.python.org/" target="_blank">Python</a>  -->
                <img src="https://notes.nicolasdeville.com/images/python.svg" alt="python_logo" width="16" style="vertical-align: middle;"/> <a href="https://www.python.org/" target="_blank">Python</a> 
                </address><!-- /#about -->

        </footer><!-- /#contentinfo -->


<!-- JS -->

<!-- my JS script (with code block copy) -->
<script src="https://notes.nicolasdeville.com/theme/js/nic.js"></script>

<!-- for Stork seach engine -->
<!-- <script src="https://files.stork-search.net/releases/v1.2.1/stork.js"></script> #updated 220924 -->
<script src="https://files.stork-search.net/stork.js"></script>
<script>
    stork.register("sitesearch", "https://notes.nicolasdeville.com/search-index.st")
</script>

</body>
</html>