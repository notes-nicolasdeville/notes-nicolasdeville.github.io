<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Pelican" />
    <title>Grist | The Evolution of Spreadsheets</title>

    <meta name="robots" content="all, follow" />
    <link rel="canonical" href="https://notes.nicolasdeville.com/" />

    <!-- Social -->
    <meta property="og:locale" content="en_GB" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Nic's notes (not a blog)" /> <!-- 40 characters for mobile and 60 for desktop -->
    <meta property="og:description" content="Messy online notebook covering B2B Sales, Leadership, Python programming, Automation, AI and more. I take these notes for myself (and my kids later) - perhaps they can help someone else..." /> <!-- min. 2 max. 4 sentences -->
    <meta property="og:url" content="https://notes.nicolasdeville.com" /> <!-- canonical URL for your page without session variables, user id parameters or counters -->
    <meta property="og:site_name" content="Nic's notes" />
    <meta property="og:image" content="https://notes.nicolasdeville.com/images/btobsales-eu-og-image.jpg" /> <!-- at least 600x315 pixels, preferable 1200x630 pixels -->

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@ndeville" />
    <meta name="twitter:title" content="Nic's notes (not a blog)" /> <!-- max. 70 characters -->
    <meta name="twitter:description" content="Messy online notebook covering B2B Sales, Leadership, Python programming, Automation, AI and more. I take these notes for myself (and my kids later) - perhaps they can help someone else..." /> <!-- max. 200 characters -->
    <meta name="twitter:image" content="https://notes.nicolasdeville.com/images/notes-twitter-image.jpg" /> <!-- aspect ratio of 2:1 with minimum dimensions of 300x157 or maximum of 4096x4096 pixels. Going with 900x471 -->
    
    <!-- Logo -->
    <meta property="og:logo" content="https://notes.nicolasdeville.com/logo.svg">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://notes.nicolasdeville.com/favicon.ico">
    <link rel="mask-icon" href="https://notes.nicolasdeville.com/favicon.svg" color="#FFFFFF">
    <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://notes.nicolasdeville.com/favicon.png">
    <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://notes.nicolasdeville.com/favicon.svg">
    <link rel="fluid-icon" href="https://notes.nicolasdeville.com/favicon.png" title="Nic's notes">

    <!-- CSS -->
    <link rel="stylesheet" href="https://notes.nicolasdeville.com/theme/css/main.css" />



        <meta name="description" content="an online, powerful, Python-driven alternative to Excel" />

    <!-- for Stork seach engine / 221005 moved to main.css-->
    <!-- <link rel="stylesheet" href="https://files.stork-search.net/basic.css" />  -->
    <!-- <link rel="stylesheet" href="https://files.stork-search.net/releases/v1.5.0/edible.css" /> # tried 220924-->

</head>

<body id="index" class="body">
        <header id="banner" class="body">

            <div class="logo-and-search">
                <a href="https://notes.nicolasdeville.com/"><img class="header_image" src="https://notes.nicolasdeville.com/images/nic_notes_header.svg" alt="Nic's notes" width="266"/></a>

                <!-- for Stork seach engine -->
                <div class="search-input-block">
                    <input data-stork="sitesearch" class="search-input" placeholder="Search notes..." autofocus="autofocus"/>
                    <div data-stork="sitesearch-output"></div>
                </div>
            </div>

            <div class="above-navbar">
                <div class="last_updated">10 Oct 2022 | 21:57</div>
                <div>
                    <p class="notes_count">
                        <a href="https://notes.nicolasdeville.com/tags">by tags</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2020/">2020</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2021/">2021</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2022/">2022</a>
                        <span style="color:#C74350">|</span>
                        470 notes
                    </p>
                </div>
            </div>

            <nav><ul>
                <li><a href="https://notes.nicolasdeville.com/ai/">ai</a></li>
                <li class="active"><a href="https://notes.nicolasdeville.com/apps/">apps</a></li>
                <li><a href="https://notes.nicolasdeville.com/b2b-sales/">b2b sales</a></li>
                <li><a href="https://notes.nicolasdeville.com/books/">books</a></li>
                <li><a href="https://notes.nicolasdeville.com/careerplaybook/">#careerplaybook</a></li>
                <li><a href="https://notes.nicolasdeville.com/helpers/">helpers</a></li>
                <li><a href="https://notes.nicolasdeville.com/home-office/">home office</a></li>
                <li><a href="https://notes.nicolasdeville.com/interests/">interests</a></li>
                <li><a href="https://notes.nicolasdeville.com/leadership/">leadership</a></li>
                <li><a href="https://notes.nicolasdeville.com/learning/">learning</a></li>
                <li><a href="https://notes.nicolasdeville.com/movies/">movies</a></li>
                <li><a href="https://notes.nicolasdeville.com/projects/">projects</a></li>
                <li><a href="https://notes.nicolasdeville.com/python/">python</a></li>
                <li><a href="https://notes.nicolasdeville.com/random/">random</a></li>
                <li><a href="https://notes.nicolasdeville.com/startups/">startups</a></li>
                <li><a href="https://notes.nicolasdeville.com/tesla/">tesla</a></li>
            </ul></nav>
        </header>

        <!-- index.html injection -->
<section id="content" class="body">
    <article>
        <header>
            <h1 class="entry-title">
                <main> <!-- for indexing by Stork -->
                    <a href="https://notes.nicolasdeville.com/apps/grist" rel="bookmark"
                    title="Permalink to Grist | The Evolution of Spreadsheets">Grist | The Evolution of Spreadsheets
                    </a>
                </main>
            </h1>
            <p class="header_summary">
                <main> <!-- for indexing by Stork -->
                    <p>an online, powerful, Python-driven alternative to Excel</p>
                </main>
            </p>
        </header>

        <div class="entry-content">
<footer class="post-info">

    <p>
        22 Sep 2022 <span class="separator">|</span> in <a class="link_tag" href="https://notes.nicolasdeville.com/apps/">apps</a>
 tags: <a class="link_tag" href="https://notes.nicolasdeville.com/tag/productivity.html">productivity</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/python.html">python</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/excel.html">excel</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/saas.html">SaaS</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/api.html">api</a>

        <!-- added 4/7 -->
        <!-- 		<br />
        <abbr class="modified" title="2022-09-22T19:59:25.497471+02:00">
                Updated: 22 Sep 2022
        </abbr>
 -->

    </p>

    

</footer>            <main> <!-- for indexing by Stork -->
                <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#limitation">Limitation</a></li>
<li><a href="#formulas">Formulas</a><ul>
<li><a href="#created-field">Created field</a></li>
<li><a href="#updated-field">Updated field</a></li>
<li><a href="#past-future">Past / Future</a></li>
<li><a href="#identify-duplicate-values">identify duplicate values</a></li>
</ul>
</li>
<li><a href="#keyboard-shortcuts">Keyboard shortcuts</a></li>
<li><a href="#api">API</a><ul>
<li><a href="#getting-started">Getting started</a></li>
<li><a href="#create-add-records">Create / add records</a></li>
<li><a href="#update-records">Update records</a></li>
<li><a href="#fetch-last-checked-record">Fetch last checked record</a></li>
<li><a href="#delete-individual-record">Delete individual record</a></li>
<li><a href="#upload-images">Upload images</a></li>
<li><a href="#tricks">Tricks</a><ul>
<li><a href="#hidden-value-field-for-reference-fields">hidden value field for reference fields</a></li>
<li><a href="#nested-dictionary-comprehension-to-select-many-fields-you-want-at-once">nested dictionary comprehension to select many fields you want at once</a></li>
<li><a href="#using-zebra-stripes-on-large-tables">using zebra stripes on large tables</a></li>
<li><a href="#downloading-document-data-as-a-file">downloading document data as a file</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p><span class="datestamp">20 Jul 2022</span>        </p>
<p><img class="header" src="https://notes.nicolasdeville.com/images/apps_grist-homepage.jpg" alt="apps_grist-homepage.jpg"/>  </p>
<table>
<thead>
<tr>
<th>App resources</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Website</td>
<td><a href="https://www.getgrist.com/" target="_blank">https://www.getgrist.com/</a></td>
</tr>
<tr>
<td>Community</td>
<td><a href="https://community.getgrist.com/" target="_blank">https://community.getgrist.com/</a></td>
</tr>
<tr>
<td>API Documentation</td>
<td><a href="https://support.getgrist.com/api/" target="_blank">https://support.getgrist.com/api/</a></td>
</tr>
<tr>
<td>API reference</td>
<td><a href="https://py-grist-api.readthedocs.io/en/latest/grist_api.html" target="_blank">https://py-grist-api.readthedocs.io/en/latest/grist_api.html</a></td>
</tr>
<tr>
<td>Github</td>
<td><a href="https://github.com/gristlabs/py_grist_api" target="_blank">https://github.com/gristlabs/py_grist_api</a></td>
</tr>
<tr>
<td>Formula Cheat Sheet</td>
<td><a href="https://support.getgrist.com/formula-cheat-sheet/" target="_blank">https://support.getgrist.com/formula-cheat-sheet/</a></td>
</tr>
<tr>
<td>Using References and Lookups in Formulas</td>
<td><a href="https://support.getgrist.com/references-lookups/" target="_blank">https://support.getgrist.com/references-lookups/</a></td>
</tr>
</tbody>
</table>
<p>The Community is very helpful, and (wo)manned by the Grist team too, who usually responds quickly :)      </p>
<p>Started using it in '21, on a paid plan (hosted) since Nov '21. At $8/month I feel it's a steal considering the scope &amp; capabilities. Hope I'll be able to lock this price when their pricing goes up in the future :)      <br>
Grist is open-source so can be self-hosted to overcome the records limitation due to assigned CPU and memory resources assigned in the hosted model (see <a href="https://community.getgrist.com/t/grist-as-database-backend-headless-cms-alternatives/586/7" target="_blank">https://community.getgrist.com/t/grist-as-database-backend-headless-cms-alternatives/586/7</a>).</p>
<p>Grist has become my go-to whenever I need to use a spreadsheet, with its Python logic and API empowering me to manipulate data in new ways.  </p>
<p><img class="illustration" src="https://notes.nicolasdeville.com/images/apps_grist-table.jpg" alt="apps_grist-table.jpg"/>  </p>
<p>Embedding Grist spreadsheets has now also been released: <a href="https://support.getgrist.com/embedding/" target="_blank">https://support.getgrist.com/embedding/</a>   </p>
<p>Not sure how large the pool was, but I started well that month ðŸ˜Š      </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/apps_grist-new-user-of-the-month.jpg" alt="apps_grist-new-user-of-the-month.jpg"/>  </p>
<h1 id="limitation">Limitation</h1>
<p>~100k records <strong>per document</strong>, ie all tables in a spreadsheet.
Where I expect to possibly have more, I break out tables in their own document, with just 1 <code>Master</code> table in it.      </p>
<h1 id="formulas">Formulas</h1>
<h2 id="created-field">Created field</h2>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/grist/grist-created.jpg" alt="grist/grist-created.jpg"/>  </p>
<h2 id="updated-field">Updated field</h2>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/grist/grist-created.jpg" alt="grist/grist-created.jpg"/>  </p>
<h2 id="past-future">Past / Future</h2>
<div class="highlight"><pre><span></span><code><span class="k">IF</span><span class="ss">(</span><span class="mh">$da</span><span class="nv">te_webinar</span><span class="o">!=</span><span class="w"> </span><span class="nv">None</span>,<span class="k">IF</span><span class="ss">(</span><span class="mh">$da</span><span class="nv">te_webinar</span><span class="o">&lt;</span><span class="nv">NOW</span><span class="ss">()</span>,<span class="s2">&quot;PAST&quot;</span>,<span class="s2">&quot;FUTURE&quot;</span><span class="ss">)</span>,<span class="s2">&quot;&quot;</span><span class="ss">)</span><span class="w"></span>
</code></pre></div>

<h2 id="identify-duplicate-values">identify duplicate values</h2>
<ul>
<li>create column <code>dup</code> (or other name)</li>
<li>under Column Options, choose <code>Set formula</code> and use <code>"DUP" if len(Master.lookupRecords(domain=$domain)) &gt; 1 else ""</code> as formula. In this example, duplication check is done on the <code>domain</code> column - change as needed using the relevant column header (eg <code>email</code>). It can also be anything other than <code>"DUP"</code>. This basically fills the cell with the string <code>"DUP"</code> if there is more than one row with the same <code>domain</code> value.  </li>
</ul>
<p>At this stage, you can filter the <code>dup</code> column for rows where <code>DUP</code> comes up - these are the duplicates:   </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/grist/dup-filter.jpg" alt="dup-filter"/>  </p>
<p>To prevent duplicate values being added to the table from that point on, you need to create an access rule under Access Rules, which can be accessed in the bottom left corner of the table, under "Tools"):</p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/grist/access-rules.jpg" alt="access-rules"/>  </p>
<p>The formula should be <code>newRec.dup == "DUP"</code> which will be applied when the value of the <code>dup</code> column in a new record (<code>newRec</code>) is equal to <code>"DUP"</code>. <br>
Permissions can be defined by clicking on each as needed: <br>
- <code>R</code> for Read
- <code>U</code> for Update
- <code>C</code> for Create
- <code>D</code> for Delete</p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/grist/dup-access-rule.jpg" alt="dup-access-rule"/>  </p>
<h1 id="keyboard-shortcuts">Keyboard shortcuts</h1>
<table>
<thead>
<tr>
<th>shortcut</th>
<th>action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Cmd + -</code></td>
<td>Delete Row</td>
</tr>
</tbody>
</table>
<h1 id="api">API</h1>
<h2 id="getting-started">Getting started</h2>
<div class="highlight"><pre><span></span><code>pip3 install grist_api
</code></pre></div>

<p>API key <strong>per document</strong> can be found by clicking on the user icon in the top right corner, then Document Settings:    </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/apps_grist-doc-api-key.jpg" alt="apps_grist-doc-api-key.jpg"/>  </p>
<p>then copy/paste the key from here:    </p>
<p><img class="screenshot" src="https://notes.nicolasdeville.com/images/apps_grist-doc-settings.jpg" alt="apps_grist-doc-settings.jpg"/>  </p>
<p>First need to create the Grist objects per document, as follows:  </p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">grist_api</span> <span class="kn">import</span> <span class="n">GristDocAPI</span>

<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="n">load_dotenv</span><span class="p">()</span>

<span class="n">SERVER</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;SERVER&quot;</span><span class="p">)</span>
<span class="n">API_KEY_GRIST</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;API_KEY&quot;</span><span class="p">)</span>

<span class="n">DOC_ID_BOOKS</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DOC_ID_PE_BOOKS&quot;</span><span class="p">)</span>
<span class="n">Books</span> <span class="o">=</span> <span class="n">GristDocAPI</span><span class="p">(</span><span class="n">DOC_ID_BOOKS</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="n">SERVER</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="n">API_KEY_GRIST</span><span class="p">)</span>

<span class="n">DOC_ID_MOVIES</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DOC_ID_PE_MOVIES&quot;</span><span class="p">)</span>
<span class="n">Movies</span> <span class="o">=</span> <span class="n">GristDocAPI</span><span class="p">(</span><span class="n">DOC_ID_MOVIES</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="n">SERVER</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="n">API_KEY_GRIST</span><span class="p">)</span>

<span class="n">DOC_ID_APPS</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DOC_ID_PE_APPS&quot;</span><span class="p">)</span>
<span class="n">Apps</span> <span class="o">=</span> <span class="n">GristDocAPI</span><span class="p">(</span><span class="n">DOC_ID_APPS</span><span class="p">,</span> <span class="n">server</span><span class="o">=</span><span class="n">SERVER</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="n">API_KEY_GRIST</span><span class="p">)</span>
</code></pre></div>

<p>The above enables me to call the methods listed below, by just referencing the document object <code>Books</code>, <code>Movies</code> or <code>Apps</code> depending on the spreadsheet I want to access.   </p>
<h2 id="create-add-records">Create / add records</h2>
<div class="highlight"><pre><span></span><code><span class="n">grist_XX</span><span class="o">.</span><span class="n">DOC</span><span class="o">.</span><span class="n">add_records</span><span class="p">(</span><span class="s1">&#39;SHEET&#39;</span><span class="p">,</span> <span class="p">[{</span>
                                    <span class="s1">&#39;field_name_1&#39;</span><span class="p">:</span> <span class="n">python_object_1</span><span class="p">,</span>
                                    <span class="s1">&#39;field_name_2&#39;</span><span class="p">:</span> <span class="n">python_object_2</span><span class="p">,</span>
                                    <span class="s1">&#39;field_name_3&#39;</span><span class="p">:</span> <span class="n">python_object_3</span><span class="p">,</span>
                                    <span class="s1">&#39;field_name_3&#39;</span><span class="p">:</span> <span class="n">python_object_4</span><span class="p">,</span>
                                    <span class="p">}</span>
                            <span class="p">])</span>
</code></pre></div>

<p>where:<br>
- <code>grist_XX</code> is the Grist object  <br>
- <code>DOC</code> is the document object<br>
- <code>SHEET</code> is the sheet name within the document<br>
- <code>field_name_x</code> is the column name in the sheet</p>
<h2 id="update-records">Update records</h2>
<p>Similar structure as above, with the <code>update_records</code> method insted of <code>add_records</code> BUT needs to identify what Grist record (ie row) to update, via its 'id':  </p>
<div class="highlight"><pre><span></span><code><span class="n">grist_XX</span><span class="o">.</span><span class="n">DOC</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;SHEET&#39;</span><span class="p">,</span> <span class="p">[{</span>
                                    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span> <span class="c1"># MANDATORY for the update method</span>
                                    <span class="s1">&#39;field_name_1&#39;</span><span class="p">:</span> <span class="n">python_object_1</span><span class="p">,</span> <span class="c1"># field to update</span>
                                    <span class="s1">&#39;field_name_2&#39;</span><span class="p">:</span> <span class="n">python_object_2</span><span class="p">,</span> <span class="c1"># field to update</span>
                                    <span class="s1">&#39;field_name_3&#39;</span><span class="p">:</span> <span class="n">python_object_3</span><span class="p">,</span> <span class="c1"># field to update</span>
                                    <span class="s1">&#39;field_name_3&#39;</span><span class="p">:</span> <span class="n">python_object_4</span><span class="p">,</span> <span class="c1"># field to update</span>
                                    <span class="p">}</span>
                    <span class="p">])</span>
</code></pre></div>

<h2 id="fetch-last-checked-record">Fetch last checked record</h2>
<div class="highlight"><pre><span></span><code><span class="n">grist_XX</span><span class="o">.</span><span class="n">DOC</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;SHEET&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;field_name&quot;</span><span class="p">:</span> <span class="s1">&#39;filter_criteria&#39;</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">last_checked</span>
</code></pre></div>

<h2 id="delete-individual-record">Delete individual record</h2>
<p><code>delete_records</code> method:    </p>
<div class="highlight"><pre><span></span><code><span class="n">grist_XX</span><span class="o">.</span><span class="n">DOC</span><span class="o">.</span><span class="n">delete_records</span><span class="p">(</span><span class="s1">&#39;SHEET&#39;</span><span class="p">,</span> <span class="p">[</span>
                        <span class="nb">id</span><span class="p">,</span>
                    <span class="p">])</span>
</code></pre></div>

<h2 id="upload-images">Upload images</h2>
<p><a href="https://community.getgrist.com/t/how-to-upload-images-as-attachment-via-api-with-python/1216/2" target="_blank">https://community.getgrist.com/t/how-to-upload-images-as-attachment-via-api-with-python/1216/2</a>   </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;https://docs.getgrist.com/api/docs/</span><span class="si">{</span><span class="n">doc_id</span><span class="si">}</span><span class="s2">/attachments&quot;</span><span class="p">,</span>
    <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;upload&quot;</span><span class="p">:</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;my_pic.png&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)},</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">attachment_id</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cell_value</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="n">attachment_id</span><span class="p">]</span>
</code></pre></div>

<p>Then use <code>add_records</code> or <code>update_records</code> and pass <code>cell_value</code> as the value of a single cell in an <code>Attachments</code> type column.  </p>
<p>See the other endpoints in <a href="https://support.getgrist.com/api/#tag/attachments" target="_blank">https://support.getgrist.com/api/#tag/attachments</a> for listing/downloading attachments.  </p>
<p>If an attachment is not referenced by any cell, it will be deleted automatically after some time. If you need to delete it immediately, thereâ€™s an undocumented endpoint: <code>POST /api/docs/{doc_id}/attachments/removeUnused</code>. Use it with caution.   </p>
<h2 id="tricks">Tricks</h2>
<h3 id="hidden-value-field-for-reference-fields">hidden value field for reference fields</h3>
<p>When using a List column, or other data type referencing to a value, instead of fetching that columns' data - which returns a list of reference(s) - you can fetch straight the value itself by identifying the hidden column/field, usually with format <code>gristHelper_Display2</code>.  </p>
<h3 id="nested-dictionary-comprehension-to-select-many-fields-you-want-at-once">nested dictionary comprehension to select many fields you want at once</h3>
<div class="highlight"><pre><span></span><code><span class="n">list_WN001_archive</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">record</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;gristHelper&quot;</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">grist_WN</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;WebReg&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">discard</span> <span class="ow">or</span> <span class="n">record</span><span class="o">.</span><span class="n">reg</span> <span class="ow">or</span> <span class="n">record</span><span class="o">.</span><span class="n">over</span>
<span class="p">]</span>
</code></pre></div>

<p>see <a href="https://community.getgrist.com/t/api-crud-with-native-grist-object/541" target="_blank">https://community.getgrist.com/t/api-crud-with-native-grist-object/541</a>   </p>
<h3 id="using-zebra-stripes-on-large-tables">using zebra stripes on large tables</h3>
<p><a href="https://community.getgrist.com/t/highlight-active-row-column-on-selection-change/443" target="_blank">https://community.getgrist.com/t/highlight-active-row-column-on-selection-change/443</a>    </p>
<h3 id="downloading-document-data-as-a-file">downloading document data as a file</h3>
<p><a href="https://community.getgrist.com/t/api-call-to-download-table-as-csv/431/3" target="_blank">https://community.getgrist.com/t/api-call-to-download-table-as-csv/431/3</a>   </p>
            </main>
        </div><!-- /.entry-content -->
    </article>
</section>

        <!-- footer -->
        <section id="extras" class="body">

        <!-- /.blogroll -->
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://btobsales.eu">Services: BtoBSales.EU</a></li>
                            <li><a href="https://indeXall.io">Side project: indeXall.io</a></li>
                            <li><a href="https://github.com/ndeville">Github: ndeville</a></li>
                        </ul>
                </div>

        <!-- /.social -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://www.linkedin.com/in/ndeville/">Linkedin</a></li>
                            <li><a href="https://www.twitter.com/ndeville">Twitter</a></li>
                        </ul>
                </div>
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Powered by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>,
                with <a href="https://stork-search.net/" target="_blank">Stork</a> & <a href="https://github.com/pelican-plugins/search" target="_blank">Pelican Search plugin</a>.
                <br>
                <a href="https://clearbit.com" target="_blank">Logos provided by Clearbit</a>
                <br>
                <!-- <span style="color:#C74350">|</span> <img src="https://notes.nicolasdeville.com/images/python.svg" alt="python_logo" width="16" style="vertical-align: middle;"/> <a href="https://www.python.org/" target="_blank">Python</a>  -->
                <img src="https://notes.nicolasdeville.com/images/python.svg" alt="python_logo" width="16" style="vertical-align: middle;"/> <a href="https://www.python.org/" target="_blank">Python</a>
                </address><!-- /#about -->

        </footer><!-- /#contentinfo -->


<!-- JS -->

<!-- my JS script (with code block copy) -->
<script src="https://notes.nicolasdeville.com/theme/js/nic.js"></script>

<!-- for Stork seach engine -->
<!-- <script src="https://files.stork-search.net/releases/v1.2.1/stork.js"></script> #updated 220924 -->
<script src="https://files.stork-search.net/stork.js"></script>
<script>
    stork.register("sitesearch", "https://notes.nicolasdeville.com/search-index.st")
</script>

</body>
</html>