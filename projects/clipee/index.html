<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Base -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Pelican" />
    <meta name="author" content="Nic Deville">

<!-- Title -->
<title>Clipee | Nic's notes</title>
<meta name="og:title" content="Clipee | Nic's notes"/> <!-- 40 characters for mobile and 60 for desktop -->
<link rel="canonical" href="https://notes.nicolasdeville.com/projects/clipee" />
<meta name="twitter:title" content="Clipee | Nic's notes" /> <!-- max. 70 characters -->

<meta name="description" content="Clipboard-based Actions"/>
<meta property="og:description" content="Clipboard-based Actions"/>
<meta name="twitter:description" content="Clipboard-based Actions" /> <!-- max. 200 characters -->
 

<meta property="article:published_time" content="2023-03-11 12:03:56.759972+01:00" />

<meta property="article:modified_time" content="2023-03-11 12:03:56.759972+01:00" />

<meta name="robots" content="all, follow" />

<!-- Social -->
<meta property="og:type" content="article" />

<!-- <meta property="og:description" content="Messy online notebook covering B2B Sales, Leadership, Python programming, Automation, AI and more. I take these notes for myself (and my kids later) - perhaps they can help someone else..." /> min. 2 max. 4 sentences -->

<meta property="og:url" content="https://notes.nicolasdeville.com/projects/clipee" /> <!-- canonical URL for your page without session variables, user id parameters or counters -->
<meta property="og:site_name" content="Nic's notes" />
<meta name="image" property="og:image" content="https://notes.nicolasdeville.com/images/notes-twitter-image.jpg" /> <!-- at least 600x315 pixels, preferable 1200x630 pixels -->

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@ndeville" />

<meta name="twitter:image" content="https://notes.nicolasdeville.com/images/notes-twitter-image.jpg" /> <!-- aspect ratio of 2:1 with minimum dimensions of 300x157 or maximum of 4096x4096 pixels. Going with 900x471 -->

<!-- Logo -->
<meta property="og:logo" content="https://notes.nicolasdeville.com/logo.svg">

<!-- Favicon -->
<link rel="icon" type="image/x-icon" href="https://notes.nicolasdeville.com/favicon.ico">
<link rel="mask-icon" href="https://notes.nicolasdeville.com/favicon.svg" color="#FFFFFF">
<link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://notes.nicolasdeville.com/favicon.png">
<link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://notes.nicolasdeville.com/favicon.svg">
<link rel="fluid-icon" href="https://notes.nicolasdeville.com/favicon.png" title="Nic's notes">

<!-- CSS -->
<link rel="stylesheet" href="https://notes.nicolasdeville.com/theme/css/main.css" />

<!-- Pagefind -->
<link href="https://notes.nicolasdeville.com/theme/css/pagefind-ui-nic.css" rel="stylesheet">
<script src="https://notes.nicolasdeville.com/pagefind/pagefind-ui.js" type="text/javascript"></script>

<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search" });
    });
</script>


</head>

<body id="index" class="body">
        <header id="banner" class="body">

            <div class="logo-and-search">
                <a href="https://notes.nicolasdeville.com/"><img class="header_image" src="https://notes.nicolasdeville.com/images/nic_notes_header.svg" alt="Nic's notes" width="266"/></a>

                <!-- for Stork seach engine -->
                <!-- <div class="search-input-block">
                    <input data-stork="sitesearch" class="search-input" placeholder="Search notes..." autofocus="autofocus"/>
                    <div data-stork="sitesearch-output"></div>
                </div> -->

                <!-- Pagefind -->
                <div class="search-input-block" id="search"></div>

            </div>

            

            <div class="above-navbar">
                <div class="last_updated">23 Mar 2023 | 21:39</div>
                <div>
                    <p class="notes_count">
                        <a href="https://notes.nicolasdeville.com/tags">by tags</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2020/">2020</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2021/">2021</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2022/">2022</a>
                        <span style="color:#C74350">|</span>
                        708 notes
                    </p>
                </div>
            </div>

            <nav><ul>
                <li><a href="https://notes.nicolasdeville.com/ai/">ai</a></li>
                <li><a href="https://notes.nicolasdeville.com/apps/">apps</a></li>
                <li><a href="https://notes.nicolasdeville.com/b2b-sales/">b2b sales</a></li>
                <li><a href="https://notes.nicolasdeville.com/books/">books</a></li>
                <li><a href="https://notes.nicolasdeville.com/careerplaybook/">#careerplaybook</a></li>
                <li><a href="https://notes.nicolasdeville.com/helpers/">helpers</a></li>
                <li><a href="https://notes.nicolasdeville.com/home-office/">home office</a></li>
                <li><a href="https://notes.nicolasdeville.com/interests/">interests</a></li>
                <li><a href="https://notes.nicolasdeville.com/leadership/">leadership</a></li>
                <li><a href="https://notes.nicolasdeville.com/learning/">learning</a></li>
                <li><a href="https://notes.nicolasdeville.com/movies/">movies</a></li>
                <li class="active"><a href="https://notes.nicolasdeville.com/projects/">projects</a></li>
                <li><a href="https://notes.nicolasdeville.com/python/">python</a></li>
                <li><a href="https://notes.nicolasdeville.com/random/">random</a></li>
                <li><a href="https://notes.nicolasdeville.com/research/">research</a></li>
                <li><a href="https://notes.nicolasdeville.com/startups/">startups</a></li>
            </ul></nav>
        </header>

        <!-- index.html injection -->
<section id="content" class="body">
    <article>
        <header>
            <h1 class="entry-title">
                <main> <!-- for indexing by Stork -->
                    <a href="https://notes.nicolasdeville.com/projects/clipee" rel="bookmark"
                    title="Permalink to Clipee">Clipee
                    </a>
                </main>
            </h1>
            <p class="header_summary">
                <main> <!-- for indexing by Stork -->
                    <p>Clipboard-based Actions</p>
                </main>
            </p>
        </header>

        <div class="entry-content">
<footer class="post-info">

    <p>
        11 Mar 2023 
        <span class="separator">|</span> in <a class="link_tag" href="https://notes.nicolasdeville.com/projects/"><span data-pagefind-filter="category">projects</span></a>

 tags: <a class="link_tag" href="https://notes.nicolasdeville.com/tag/python.html">python</a>

        <!-- added 4/7 -->
        <!-- 		<br />
        <abbr class="modified" title="2023-03-11T12:03:56.759972+01:00">
                Updated: 11 Mar 2023
        </abbr>
 -->

    </p>

    

</footer>            <!-- for indexing by Stork -->
            <!-- <main>  -->
                <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#workflow">Workflow</a></li>
<li><a href="#initial-script">Initial script</a></li>
<li><a href="#clipee-family">Clipee family</a><ul>
<li><a href="#clipee-clean">Clipee Clean</a></li>
<li><a href="#clipee-note">Clipee Note</a></li>
<li><a href="#clipee-atom">Clipee Atom</a></li>
<li><a href="#clipee-tweet">Clipee Tweet</a><ul>
<li><a href="#resources">resources</a></li>
<li><a href="#implementation">implementation</a></li>
</ul>
</li>
<li><a href="#clipee-grist">Clipee Grist</a></li>
<li><a href="#clipee-csv">Clipee CSV</a></li>
</ul>
</li>
</ul>
</div>
<p><span class="datestamp">17 Sep 2022</span>   </p>
<p>Since last year, I have started managing clipboard-based actions with my own Python script, instead of 3rd party solutions - they all have limitations.   </p>
<p>I'm using this script on a daily basis.  </p>
<h1 id="workflow">Workflow</h1>
<p>Python script assigned ot a key on my Streamdeck <span class="nic_link"><a href="https://notes.nicolasdeville.com/home-office/streamdeck" target="_blank">Streamdeck for business users</a></span>  </p>
<ol>
<li>copy something</li>
<li>press key on Streamdeck</li>
</ol>
<p>Script prints to a Terminal window, and copies output back to clipboard, ready to be pasted anywhere.   </p>
<p>TODO: 
- explore AppleScript with keyboard shortcut assignment</p>
<h1 id="initial-script">Initial script</h1>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pandas.io.clipboard</span> <span class="kn">import</span> <span class="n">clipboard_get</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>
<span class="kn">from</span> <span class="nn">tldextract</span> <span class="kn">import</span> <span class="n">extract</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">request</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="n">date</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">-%H%M%S&#39;</span><span class="p">)</span>

<span class="n">count_url</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">separator</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">):</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">symbol</span> <span class="o">*</span> <span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">separator</span> <span class="o">*</span> <span class="n">lines</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>

<span class="n">sep</span> <span class="o">=</span> <span class="n">separator</span><span class="p">()</span>

<span class="c1">### Functions</span>

<span class="k">def</span> <span class="nf">cleanurl</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>
    <span class="n">purl</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">scheme</span> <span class="o">=</span> <span class="n">purl</span><span class="o">.</span><span class="n">scheme</span> <span class="o">+</span> <span class="s1">&#39;://&#39;</span> <span class="k">if</span> <span class="n">purl</span><span class="o">.</span><span class="n">scheme</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">scheme</span><span class="si">}{</span><span class="n">purl</span><span class="o">.</span><span class="n">netloc</span><span class="si">}{</span><span class="n">purl</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s1">&#39;</span>


<span class="k">def</span> <span class="nf">write_to_clipboard</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
        <span class="s1">&#39;pbcopy&#39;</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;LANG&#39;</span><span class="p">:</span> <span class="s1">&#39;en_US.UTF-8&#39;</span><span class="p">},</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
    <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">OUTPUT COPIED TO CLIPBOARD</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">html_for_note</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">cleanurl</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">url</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="n">html</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">html</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">soup</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">title</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">header</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_border</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_title</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_title</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_url</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;a href=</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">header ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NO Header found, returning with Title only&quot;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_border</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_title</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_url</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;a href=</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Output:</span><span class="se">\n</span><span class="s1">--------</span><span class="se">\n</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1">--------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">write_to_clipboard</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">html_for_note ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="s2">Returning empty div:&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_border</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_title</span><span class="se">\&quot;</span><span class="s2">&gt;XXXXXXX&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&lt;div class=</span><span class="se">\&quot;</span><span class="s2">link_url</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;a href=</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2"> target=</span><span class="se">\&quot;</span><span class="s2">_blank</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Output:</span><span class="se">\n</span><span class="s1">--------</span><span class="se">\n</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1">--------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">write_to_clipboard</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1">### Switches</span>

<span class="k">def</span> <span class="nf">clipee_processing</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">sep</span>

    <span class="k">if</span> <span class="s2">&quot;vimeo.com&quot;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="se">\n</span><span class="s2">Processing as VIMEO LINK EXTRACTION...&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Input Vimeo: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">src</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?&lt;=src=&quot;).*?(?=[\?&quot;])&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">write_to_clipboard</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Output: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="s1">&#39;fantastical&#39;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="se">\n</span><span class="s2">Processing as FANTASTICAL DATE LIST...&quot;</span><span class="p">)</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">o</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/p/&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://hub.flexibits.com/scheduling/public/</span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s1">/&#39;</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">html</span><span class="p">),</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
            <span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;TimePicker_timePicker__5yclN&#39;</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">div</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">div_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">div</span><span class="p">:</span>
                <span class="n">slot</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">)</span>
                <span class="n">slot</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span>
                <span class="n">join</span> <span class="o">=</span> <span class="s2">&quot;: &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">slot</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s1">&#39;&lt;span&gt;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;/span&gt;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">join</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">paste</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">) </span><span class="si">{</span><span class="n">join</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">paste</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

    <span class="k">elif</span> <span class="s2">&quot;mailto&quot;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="se">\n</span><span class="s2">Processing as MAILTO CLEANING...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Input Mailto: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;mailto:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">write_to_clipboard</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Output: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="s2">&quot;?&quot;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="se">\n</span><span class="s2">Processing as URL CLEANING...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Input URL with query params: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">short_url</span> <span class="o">=</span> <span class="n">cleanurl</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">write_to_clipboard</span><span class="p">(</span><span class="n">short_url</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Output short URL: </span><span class="si">{</span><span class="n">short_url</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="s2">&quot;.gif&quot;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="se">\n</span><span class="s2">Processing as GIF DOWNLOAD...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Input code with .gif: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Download Starting...&#39;</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">text</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="c1"># this will take only -1 splitted part of the url</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/Users/xxx/GIF/</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s1">.gif&#39;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
            <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Download Completed!!!&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="s1">&#39;(Event Time Zone)&#39;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="se">\n</span><span class="s2">Processing as TIMEZONE CLEANING...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; (Event Time Zone)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">write_to_clipboard</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Output: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="s1">&#39;xxx@yyy&#39;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="se">\n</span><span class="s2">Processing as TERMINAL CLEANING...&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;xxx@yyy&#39;</span><span class="p">,</span> <span class="s1">&#39;xxx@yyy&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;/Users/yyyy/&#39;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/Users/yyyy/&#39;</span><span class="p">,</span> <span class="s1">&#39;/Users/xxxx/&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">write_to_clipboard</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">elif</span> <span class="s1">&#39;/Users/yyyy/&#39;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="se">\n</span><span class="s2">Processing as TERMINAL CLEANING...&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/Users/yyyy/&#39;</span><span class="p">,</span> <span class="s1">&#39;/Users/xxxx/&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">write_to_clipboard</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="se">\n</span><span class="s2">Processing as NOTE LINK...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">html_for_note</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">NO LOGIC identified for this text.&quot;</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">clipboard_get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">clipee_processing</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="k">while</span> <span class="n">count_url</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[CLIPEE] Want to process another?...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">new_url</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Enter new URL: &#39;</span><span class="p">)</span>
    <span class="n">clipee_processing</span><span class="p">(</span><span class="n">new_url</span><span class="p">)</span>
</code></pre></div>

<h1 id="clipee-family">Clipee family</h1>
<p>Rather than continue implementing logic or switches for the script to identify what to do with clipboard content, I broke out the script:  </p>
<ul>
<li><strong>Clipee Clean</strong>: most of the generic clipboard content cleaning of the initial script.
and new additions:   </li>
<li><strong>Clipee Note</strong>: generate rich HTML snippet from URL.</li>
<li><strong>Clipee Atom</strong>: paste clipboard content to new named file in Atom.  </li>
<li><strong>Clipee Tweet</strong>: send a tweet from content of clipboard.</li>
</ul>
<h2 id="clipee-clean">Clipee Clean</h2>
<p>Pared down version of the initial script above. No change to it, but simplified script will allow for more flexibility in cleaning tasks.  </p>
<h2 id="clipee-note">Clipee Note</h2>
<p>Generate HTML snippet with site icon and header/tagline from a URL in clipboard.   </p>
<p>Implemented a couple weeks ago and using several times a day since.    </p>
<p>Code:   </p>
<script src="https://gist.github.com/ndeville/52505fe6ec734ff4a6f448af59a81083.js"></script>

<p><span class="datestamp">06 Feb 2023</span> using every day since implementation.  </p>
<p>TODO: automate process so any image added to my Notes images folders gets added as hyperlink to <code>helpers/images.md</code> ➤ easy to copy/paste from there and/or keep as an ongoing image clipboard.   </p>
<h2 id="clipee-atom">Clipee Atom</h2>
<p>For the last couple years, I have relied daily on a shortcut on my Streamdeck that was pasting the content of my clipboard to Atom (my text editor <span class="nic_link"><a href="https://notes.nicolasdeville.com/apps/atom" target="_blank">Atom</a></span>).   </p>
<p>While I have a clipboard manager, this serves the purpose of keeping the pasted content on a separate screen in front of me, explore content within the simplicity of a text editor, etc. </p>
<p>Challenges were: </p>
<ul>
<li>extra gesture to reach out to the Streamdeck to hit the right key (I know!!)</li>
<li>couple seconds of processing (managed via keyboard shortcut automation, eg <code>Cmd N</code>, <code>Cmd V</code>) to get result</li>
<li>untitled file means prompt for name when closing or losing data if crash. </li>
</ul>
<p>As Clipee is designed to enable clipboard actions, I thought about improving on this automation.  </p>
<p>Result now:</p>
<ul>
<li>Alfred keyword <code>pa</code> (<strong>P</strong>aste to <strong>A</strong>tom) is all I need to do. </li>
<li>AppleScript triggered creates a new <code>.txt</code> file with timestamp as name in a central folder, and opens it in Atom. </li>
</ul>
<p>It's near instantaneous 😁 and all my "pasteboard" is archived, searchable and safe.     </p>
<p>Plus it avoids the risk of misfiring if app is not open and at the foreground quickly enough when the automated keyboard shortcuts kick in (another challenge with the initial Streamdeck approack).   </p>
<p>See implementation and code in:  </p>
<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://notes.nicolasdeville.com/images/logos/nicolasdeville.png" alt="logo"/></div><div class="link_content">
<div class="link_title">Alfred: Custom Workflow "Paste Clipboard to Atom"</div>
<div class="link_tagline">nicolasdeville</div>
<div class="link_url"><a href="https://notes.nicolasdeville/apps/alfred/#paste-clipboard-to-atom" target="_blank">https://notes.nicolasdeville/apps/alfred/#paste-clipboard-to-atom</a></div></div></div>

<h2 id="clipee-tweet">Clipee Tweet</h2>
<p><span class="datestamp">27 Sep 2022</span> </p>
<p>See origination: <span class="nic_link"><a href="https://notes.nicolasdeville.com/helpers/twitter-cli" target="_blank">How to use Twitter via CLI (Command Line Interface) on macOS</a></span>   </p>
<p>Goal: make it as seamless as possible in my workflow to tweet.   </p>
<ul>
<li>write anywhere and copy content</li>
<li>Alfred workflow with keyword <code>ct</code> (Clipee Tweet) tweets content of clipboard</li>
</ul>
<p>Danger to tweet something wrong 😅😂 but oopening tweet after posting for double-check, and deleting tweet if mistake, should be a fine workaround.  </p>
<h3 id="resources">resources</h3>
<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://notes.nicolasdeville.com/images/logos/opengenus.png" alt="logo"/></div><div class="link_content">
<div class="link_title">Post a tweet using Twitter API</div>
<div class="link_tagline">opengenus</div>
<div class="link_url"><a href="https://iq.opengenus/tweet-using-twitter-api/" target="_blank">https://iq.opengenus/tweet-using-twitter-api/</a></div></div></div>

<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://notes.nicolasdeville.com/images/logos/geeksforgeeks.png" alt="logo"/></div><div class="link_content">
<div class="link_title">Tweet using Python - GeeksforGeeks</div>
<div class="link_tagline">geeksforgeeks</div>
<div class="link_url"><a href="https://www.geeksforgeeks/tweet-using-python/" target="_blank">https://www.geeksforgeeks/tweet-using-python/</a></div></div></div>

<h3 id="implementation">implementation</h3>
<p>Done in 30mns and working 😁  </p>
<p>"Trickiest" bit was the flurry of authentication strings (API KEY, API SECRET, ACCESS_TOKEN &amp; ACCESS_TOKEN_SECRET), and their permissions.  <br>
First try returned an Unauthorized response. <br>
Had to re-generate the keys, with a user having read/write permissions.  </p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pandas.io.clipboard</span> <span class="kn">import</span> <span class="n">clipboard_get</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># environment variables, ie credentials</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="n">load_dotenv</span><span class="p">()</span>

<span class="c1"># see resources above</span>
<span class="kn">import</span> <span class="nn">tweepy</span>

<span class="c1"># to open my Twitter profile after sending for double-checking</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>

<span class="c1"># to display a confirmation window</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">simpledialog</span>

<span class="c1"># credentials</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;API_KEY&quot;</span><span class="p">)</span>
<span class="n">api_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;API_SECRET&quot;</span><span class="p">)</span>
<span class="n">access_token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;ACCESS_TOKEN&quot;</span><span class="p">)</span>
<span class="n">access_token_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;ACCESS_TOKEN_SECRET&quot;</span><span class="p">)</span>

<span class="c1"># authentication of consumer key and secret</span>
<span class="n">auth</span> <span class="o">=</span> <span class="n">tweepy</span><span class="o">.</span><span class="n">OAuthHandler</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>
<span class="c1"># authentication of access token and secret</span>
<span class="n">auth</span><span class="o">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span> <span class="n">access_token_secret</span><span class="p">)</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">tweepy</span><span class="o">.</span><span class="n">API</span><span class="p">(</span><span class="n">auth</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">tweet</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ready to send:</span><span class="se">\n\n</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">approval</span> <span class="o">=</span> <span class="n">simpledialog</span><span class="o">.</span><span class="n">askstring</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sure?&quot;</span><span class="p">,</span><span class="sa">f</span><span class="s2">&quot;Ready to send:</span><span class="se">\n\n</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">Really?</span><span class="se">\n</span><span class="s2">(y to confirm)&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">approval</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>

        <span class="n">api</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;chrome&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://twitter.com/ndeville&#39;</span><span class="p">)</span>


<span class="n">text</span> <span class="o">=</span> <span class="n">clipboard_get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">tweet</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>

<p>next: add logic to include images.    </p>
<p>Working script 😁   </p>
<div class="highlight"><pre><span></span><code><span class="c1"># credentials</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;API_KEY&quot;</span><span class="p">)</span>
<span class="n">api_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;API_SECRET&quot;</span><span class="p">)</span>
<span class="n">access_token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;ACCESS_TOKEN&quot;</span><span class="p">)</span>
<span class="n">access_token_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;ACCESS_TOKEN_SECRET&quot;</span><span class="p">)</span>

<span class="c1"># authentication of consumer key and secret</span>
<span class="n">auth</span> <span class="o">=</span> <span class="n">tweepy</span><span class="o">.</span><span class="n">OAuthHandler</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">api_secret</span><span class="p">)</span>
<span class="c1"># authentication of access token and secret</span>
<span class="n">auth</span><span class="o">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span> <span class="n">access_token_secret</span><span class="p">)</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">tweepy</span><span class="o">.</span><span class="n">API</span><span class="p">(</span><span class="n">auth</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">tweet</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="n">multimedia</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">parts</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
        <span class="n">part</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">part</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/Users&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">part</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;jpg&#39;</span><span class="p">):</span>
            <span class="n">multimedia</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">image_path</span> <span class="o">=</span> <span class="n">part</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c1"># remove the path URL from the tweet text</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">image_path</span><span class="si">=}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">multimedia</span><span class="p">:</span>
        <span class="n">approval</span> <span class="o">=</span> <span class="n">simpledialog</span><span class="o">.</span><span class="n">askstring</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sure?&quot;</span><span class="p">,</span><span class="sa">f</span><span class="s2">&quot;Ready to send WITH IMAGE attached:</span><span class="se">\n\n</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">Really?</span><span class="se">\n</span><span class="s2">(y to confirm)&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">approval</span> <span class="o">=</span> <span class="n">simpledialog</span><span class="o">.</span><span class="n">askstring</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sure?&quot;</span><span class="p">,</span><span class="sa">f</span><span class="s2">&quot;Ready to send:</span><span class="se">\n\n</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">Really?</span><span class="se">\n</span><span class="s2">(y to confirm)&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">approval</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">multimedia</span><span class="p">:</span>
            <span class="n">api</span><span class="o">.</span><span class="n">update_status_with_media</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">image_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">api</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>

        <span class="n">webbrowser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;chrome&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://twitter.com/ndeville&#39;</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">clipboard_get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing:</span><span class="se">\n</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">tweet</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>

<p>next: Clipee Grist</p>
<h2 id="clipee-grist">Clipee Grist</h2>
<p><span class="datestamp">28 Sep 2022</span> </p>
<p>Pain point: I come across a lot of apps (SaaS mostly) that I want to add to my list (library) to keep them on my radar. This list lives in Grist <span class="nic_link"><a href="https://notes.nicolasdeville.com/apps/Grist" target="_blank">Grist | The Evolution of Spreadsheets</a></span>.   </p>
<p>Goal: add enriched record to Grist from a URL copied (ie in clipboard).   </p>
<p>Separating scripts per Grist document for convenience. </p>
<p><span class="datestamp">29 Sep 2022</span>  </p>
<p><code>Clipee Grist Apps</code> - Alfred shortcut <code>cga</code> - working with script:  </p>
<div class="highlight"><pre><span></span><code><span class="c1"># default boilerplate removed for brevity, see https://notes.nicolasdeville/python/boilerplate/</span>
<span class="c1">####################</span>
<span class="c1"># Clipee Grist - Add Apps</span>

<span class="c1">### GLOBAL VARIABLES</span>
<span class="n">test</span> <span class="o">=</span> <span class="kc">False</span> 
<span class="n">v</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># verbose mode</span>

<span class="n">doc_id</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DOC_ID_PE_APPS&quot;</span><span class="p">)</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GRIST_API_KEY&quot;</span><span class="p">)</span>

<span class="n">apps_data</span> <span class="o">=</span> <span class="n">grist_PE</span><span class="o">.</span><span class="n">Apps</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">v</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">apps_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> apps in Grist.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">existing_domains</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">domain</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">apps_data</span><span class="p">]</span>

<span class="c1"># Categories &amp; Tags</span>
<span class="n">categories_in_grist</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">tags_in_grist</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">app</span> <span class="ow">in</span> <span class="n">apps_data</span><span class="p">:</span>
    <span class="n">categories</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">category</span>
    <span class="k">if</span> <span class="n">categories</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cat</span> <span class="o">!=</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
                <span class="n">categories_in_grist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">tags</span>
    <span class="k">if</span> <span class="n">tags</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tag</span> <span class="o">!=</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
                <span class="n">tags_in_grist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>


<span class="c1"># TODO build dicts for categories and tags to match</span>

<span class="n">category_keywords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">categories_in_grist</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span>
                    <span class="c1"># &#39; ai &#39;,</span>
                    <span class="c1"># &#39;ai-&#39;,</span>
                    <span class="p">]</span> 

<span class="n">tag_keywords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tags_in_grist</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span>

<span class="p">]</span> 

<span class="c1">### </span>


<span class="kn">import</span> <span class="nn">webbrowser</span>

<span class="c1">### UI</span>
<span class="c1"># from tkinter import simpledialog</span>
<span class="kn">import</span> <span class="nn">pymsgbox</span> <span class="c1"># simpler than tkinter / see python/library-pymsgbox</span>
<span class="c1"># import pymsgbox.native as pymsgbox # not working, revisit later</span>

<span class="c1">### Functions</span>

<span class="k">def</span> <span class="nf">separator</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">):</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">symbol</span> <span class="o">*</span> <span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">separator</span> <span class="o">*</span> <span class="n">lines</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>

<span class="n">sep</span> <span class="o">=</span> <span class="n">separator</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">cleanurl</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>
    <span class="n">purl</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">scheme</span> <span class="o">=</span> <span class="n">purl</span><span class="o">.</span><span class="n">scheme</span> <span class="o">+</span> <span class="s1">&#39;://&#39;</span> <span class="k">if</span> <span class="n">purl</span><span class="o">.</span><span class="n">scheme</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">scheme</span><span class="si">}{</span><span class="n">purl</span><span class="o">.</span><span class="n">netloc</span><span class="si">}{</span><span class="n">purl</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="k">def</span> <span class="nf">domain_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">o</span> <span class="o">=</span> <span class="n">tldextract</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">domain</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">o</span><span class="o">.</span><span class="n">domain</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">o</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;www.&#39;</span> <span class="ow">in</span> <span class="n">domain</span><span class="p">:</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;www.&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">domain</span>

<span class="k">def</span> <span class="nf">domain_name_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">o</span> <span class="o">=</span> <span class="n">tldextract</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">domain_name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;www.&#39;</span> <span class="ow">in</span> <span class="n">domain_name</span><span class="p">:</span>
        <span class="n">domain_name</span> <span class="o">=</span> <span class="n">domain_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;www.&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">domain_name</span>

<span class="k">def</span> <span class="nf">add_to_grist</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">app_type</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">slug</span><span class="p">,</span> <span class="n">domain</span><span class="p">):</span>
    <span class="n">grist_PE</span><span class="o">.</span><span class="n">Apps</span><span class="o">.</span><span class="n">add_records</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">,</span> <span class="p">[</span>
                                    <span class="p">{</span>   <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                                        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
                                        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;radar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="n">summary</span><span class="p">,</span>
                                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">app_type</span><span class="p">,</span>
                                        <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span>
                                        <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="n">tags</span><span class="p">,</span>
                                        <span class="s1">&#39;slug&#39;</span><span class="p">:</span> <span class="n">slug</span><span class="p">,</span>
                                        <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="n">domain</span><span class="p">,</span>
                                        <span class="p">}</span>
                                <span class="p">])</span>

<span class="k">def</span> <span class="nf">find_category</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">category_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">category_keywords</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">category_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">category_list</span>


<span class="k">def</span> <span class="nf">find_tags</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">tags_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">tag_keywords</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">tags_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">tags_list</span>

<span class="c1">### Main</span>

<span class="k">def</span> <span class="nf">add_app</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">cleanurl</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">url</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">logo</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">category</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span>

        <span class="n">domain</span> <span class="o">=</span> <span class="n">domain_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">slug</span> <span class="o">=</span> <span class="n">domain_name_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">app_type</span> <span class="o">=</span> <span class="s1">&#39;SaaS&#39;</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">url</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">domain</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">slug</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">app_type</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">domain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_domains</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
                <span class="c1"># if v:</span>
                <span class="c1">#     print(f&quot;\n{html=}&quot;)</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
                    <span class="c1"># if v:</span>
                    <span class="c1">#     print(f&quot;\n{soup=}&quot;)</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">title</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text</span>
                        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">title</span><span class="p">:</span>
                            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">header</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                            <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
                                <span class="n">header</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">header</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">title</span><span class="p">:</span>
                                <span class="n">header</span> <span class="o">=</span> <span class="n">domain</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">test</span><span class="p">:</span>
                                <span class="n">name</span> <span class="o">=</span> <span class="n">title</span>
                                <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">name</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="n">summary</span> <span class="o">=</span> <span class="n">header</span>
                                <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">summary</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="s2">&quot;</span>
                                <span class="n">category</span> <span class="o">=</span> <span class="n">find_category</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">category</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="n">tags</span> <span class="o">=</span> <span class="n">find_tags</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">tags</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> h1 ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">name</span> <span class="o">=</span> <span class="n">title</span>


                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> title ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> soup ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> html ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> Data passed to function add_to_grist:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">app_type</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">category</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tags</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">slug</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">domain</span><span class="si">=}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;line </span><span class="si">{</span><span class="n">get_linenumber</span><span class="p">()</span><span class="si">}</span><span class="s2"> passed.&quot;</span><span class="p">)</span>

            <span class="n">add_to_grist</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">app_type</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">slug</span><span class="p">,</span> <span class="n">domain</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">test</span><span class="p">:</span>
                <span class="n">webbrowser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;chrome&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;link_to_my_grist_page&gt;&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2"> is NOT a URL.&quot;</span><span class="p">)</span>
        <span class="n">pymsgbox</span><span class="o">.</span><span class="n">alert</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2"> is NOT a URL.&quot;</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">clipboard_get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing:</span><span class="se">\n</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">add_app</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="n">run_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;finished in </span><span class="si">{</span><span class="n">run_time</span><span class="si">}</span><span class="s1">s.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>

<p>Re-using now that script logic for additional list, eg List of Recruiters (<code>Clipee Grist Recruiters</code> / Alfred shortcut <code>cgr</code>) for <a href="https://btobsales.eu/" target="_blank">https://btobsales.eu/</a>.   </p>
<h2 id="clipee-csv">Clipee CSV</h2>
<p>generate Python code of CSV headers given a path to <code>.csv</code> file.   </p>
<div class="highlight"><pre><span></span><code><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">CLIPEE CSV</span>
<span class="sd">CSV HEADERS TO PYTHON</span>
<span class="sd">Input: path to .csv file</span>
<span class="sd">Output: python row code for headers</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">pandas.io.clipboard</span> <span class="kn">import</span> <span class="n">clipboard_get</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pymsgbox</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">pymsgbox</span><span class="o">.</span><span class="n">alert</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="n">count_col_csv</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">write_to_clipboard</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
        <span class="s1">&#39;pbcopy&#39;</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;LANG&#39;</span><span class="p">:</span> <span class="s1">&#39;en_US.UTF-8&#39;</span><span class="p">},</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
    <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">OUTPUT COPIED TO CLIPBOARD</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">process_csv</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">count_col_csv</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="n">path_to_csv</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">path_to_csv</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/Users&#39;</span><span class="p">):</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_csv</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h</span><span class="p">:</span>
                <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">header_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">count_for</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

                <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">header_row</span><span class="p">:</span>
                    <span class="n">count_col_csv</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">count_for</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="k">if</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">title</span><span class="p">:</span>
                        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">title</span><span class="p">:</span>
                        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> = row[</span><span class="si">{</span><span class="n">count_for</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> = row[</span><span class="si">{</span><span class="n">count_for</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">write_to_clipboard</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>

        <span class="n">pymsgbox</span><span class="o">.</span><span class="n">alert</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SUCCESS</span><span class="se">\n</span><span class="s2">Copied to clipboard: </span><span class="si">{</span><span class="n">headers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">pymsgbox</span><span class="o">.</span><span class="n">alert</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">clipboard_get</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">process_csv</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
            <!-- </main> -->
        </div><!-- /.entry-content -->
    </article>
</section>

        <!-- footer -->
        <section id="extras" class="body" data-pagefind-ignore>

        <!-- /.blogroll -->
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://btobsales.eu">Services: BtoBSales.EU</a></li>
                            <li><a href="https://indeXall.io">Side project: indeXall.io</a></li>
                            <li><a href="https://github.com/ndeville">Github: ndeville</a></li>
                        </ul>
                </div>

        <!-- /.social -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://www.linkedin.com/in/ndeville/">Linkedin</a></li>
                            <li><a href="https://www.twitter.com/ndeville">Twitter</a></li>
                        </ul>
                </div>
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body" data-pagefind-ignore>
                <address id="about" class="vcard body">
                    <img src="https://notes.nicolasdeville.com/favicon.svg" alt="nic_logo" width="24" style="vertical-align: middle;"/> Nic's notes:
                    <br>
                    <img src="https://notes.nicolasdeville.com/images/logos/getpelican.png" alt="pelican" width="16" style="vertical-align: middle;"/> Powered by <a href="https://getpelican.com" target="_blank">Pelican</a>
                    <br>
                    <img src="https://notes.nicolasdeville.com/images/logos/pagefind.png" alt="pagefind" width="16" style="vertical-align: middle;"/> Search by <a href="https://pagefind.app" target="_blank">Pagefind</a>
                    <br>
                    <img src="https://notes.nicolasdeville.com/images/logos/clearbit.png" alt="clearbit" width="16" style="vertical-align: middle;"/> Logos by <a href="https://clearbit.com" target="_blank">Clearbit</a>
                    <br>
                    <img src="https://notes.nicolasdeville.com/images/python.svg" alt="python_logo" width="16" style="vertical-align: middle;"/> Made with <a href="https://www.python.org/" target="_blank">Python</a>
                </address><!-- /#about -->

        </footer><!-- /#contentinfo -->


<!-- JS -->

<!-- my JS script (with code block copy) -->
<script src="https://notes.nicolasdeville.com/theme/js/nic.js"></script>

<!-- for Stork seach engine -->
<!-- <script src="https://files.stork-search.net/stork.js"></script>
<script>
    stork.register("sitesearch", "https://notes.nicolasdeville.com/search-index.st")
</script> -->

<!-- <script>
    (function() {
    if( window.innerWidth > 600 ) {
        var stork_script = document.createElement('script');
        stork_script.type = 'text/javascript';
        stork_script.src = 'https://files.stork-search.net/stork.js';

        var stork_register = ('script');
        stork_register.innerHTML = 'stork.register("sitesearch", "https://notes.nicolasdeville.com/search-index.st")';

        var head = document.getElementsByTagName('head')[0];
        head.appendChild(stork_script);
        head.appendChild(stork_register);


    }
    })();
</script> -->

</body>
</html>