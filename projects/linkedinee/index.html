<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Base -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Pelican" />
    <meta name="author" content="Nic Deville">

<!-- Title -->
<title>Linkedinee | Nic's notes</title>
<meta name="og:title" content="Linkedinee | Nic's notes"/> <!-- 40 characters for mobile and 60 for desktop -->
<link rel="canonical" href="https://notes.nicolasdeville.com/projects/linkedinee" />
<meta name="twitter:title" content="Linkedinee | Nic's notes" /> <!-- max. 70 characters -->

<meta name="description" content="a LinkedIn data extractor toolbox."/>
<meta property="og:description" content="a LinkedIn data extractor toolbox."/>
<meta name="twitter:description" content="a LinkedIn data extractor toolbox." /> <!-- max. 200 characters -->
 

<meta property="article:published_time" content="2023-01-15 00:00:00+01:00" />

<meta property="article:modified_time" content="2023-03-11 12:36:09.706310+01:00" />

<meta name="robots" content="all, follow" />

<!-- Social -->
<meta property="og:type" content="article" />

<!-- <meta property="og:description" content="Messy online notebook covering B2B Sales, Leadership, Python programming, Automation, AI and more. I take these notes for myself (and my kids later) - perhaps they can help someone else..." /> min. 2 max. 4 sentences -->

<meta property="og:url" content="https://notes.nicolasdeville.com/projects/linkedinee" /> <!-- canonical URL for your page without session variables, user id parameters or counters -->
<meta property="og:site_name" content="Nic's notes" />
<meta name="image" property="og:image" content="https://notes.nicolasdeville.com/images/notes-twitter-image.jpg" /> <!-- at least 600x315 pixels, preferable 1200x630 pixels -->

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@ndeville" />

<meta name="twitter:image" content="https://notes.nicolasdeville.com/images/notes-twitter-image.jpg" /> <!-- aspect ratio of 2:1 with minimum dimensions of 300x157 or maximum of 4096x4096 pixels. Going with 900x471 -->

<!-- Logo -->
<meta property="og:logo" content="https://notes.nicolasdeville.com/logo.svg">

<!-- Favicon -->
<link rel="icon" type="image/x-icon" href="https://notes.nicolasdeville.com/favicon.ico">
<link rel="mask-icon" href="https://notes.nicolasdeville.com/favicon.svg" color="#FFFFFF">
<link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://notes.nicolasdeville.com/favicon.png">
<link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://notes.nicolasdeville.com/favicon.svg">
<link rel="fluid-icon" href="https://notes.nicolasdeville.com/favicon.png" title="Nic's notes">

<!-- CSS -->
<link rel="stylesheet" href="https://notes.nicolasdeville.com/theme/css/main.css" />

<!-- Pagefind -->
<link href="https://notes.nicolasdeville.com/theme/css/pagefind-ui-nic.css" rel="stylesheet">
<script src="https://notes.nicolasdeville.com/pagefind/pagefind-ui.js" type="text/javascript"></script>

<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search" });
    });
</script>


</head>

<body id="index" class="body">
        <header id="banner" class="body">

            <div class="logo-and-search">
                <a href="https://notes.nicolasdeville.com/"><img class="header_image" src="https://notes.nicolasdeville.com/images/nic_notes_header.svg" alt="Nic's notes" width="266"/></a>

                <!-- for Stork seach engine -->
                <!-- <div class="search-input-block">
                    <input data-stork="sitesearch" class="search-input" placeholder="Search notes..." autofocus="autofocus"/>
                    <div data-stork="sitesearch-output"></div>
                </div> -->

                <!-- Pagefind -->
                <div class="search-input-block" id="search"></div>

            </div>

            

            <div class="above-navbar">
                <div class="last_updated">25 Mar 2023 | 15:20</div>
                <div>
                    <p class="notes_count">
                        <a href="https://notes.nicolasdeville.com/tags">by tags</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2020/">2020</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2021/">2021</a>
                        <span style="color:#C74350">|</span>
                        <a href="https://notes.nicolasdeville.com/2022/">2022</a>
                        <span style="color:#C74350">|</span>
                        718 notes
                    </p>
                </div>
            </div>

            <nav><ul>
                <li><a href="https://notes.nicolasdeville.com/ai/">ai</a></li>
                <li><a href="https://notes.nicolasdeville.com/apps/">apps</a></li>
                <li><a href="https://notes.nicolasdeville.com/b2b-sales/">b2b sales</a></li>
                <li><a href="https://notes.nicolasdeville.com/books/">books</a></li>
                <li><a href="https://notes.nicolasdeville.com/careerplaybook/">#careerplaybook</a></li>
                <li><a href="https://notes.nicolasdeville.com/helpers/">helpers</a></li>
                <li><a href="https://notes.nicolasdeville.com/home-office/">home office</a></li>
                <li><a href="https://notes.nicolasdeville.com/interests/">interests</a></li>
                <li><a href="https://notes.nicolasdeville.com/leadership/">leadership</a></li>
                <li><a href="https://notes.nicolasdeville.com/learning/">learning</a></li>
                <li><a href="https://notes.nicolasdeville.com/movies/">movies</a></li>
                <li class="active"><a href="https://notes.nicolasdeville.com/projects/">projects</a></li>
                <li><a href="https://notes.nicolasdeville.com/python/">python</a></li>
                <li><a href="https://notes.nicolasdeville.com/random/">random</a></li>
                <li><a href="https://notes.nicolasdeville.com/research/">research</a></li>
                <li><a href="https://notes.nicolasdeville.com/startups/">startups</a></li>
            </ul></nav>
        </header>

        <!-- index.html injection -->
<section id="content" class="body">
    <article>
        <header>
            <h1 class="entry-title">
                <main> <!-- for indexing by Stork -->
                    <a href="https://notes.nicolasdeville.com/projects/linkedinee" rel="bookmark"
                    title="Permalink to Linkedinee">Linkedinee
                    </a>
                </main>
            </h1>
            <p class="header_summary">
                <main> <!-- for indexing by Stork -->
                    <p>a LinkedIn data extractor toolbox.</p>
                </main>
            </p>
        </header>

        <div class="entry-content">
<footer class="post-info">

    <p>
        15 Jan 2023 
        <span class="separator">|</span> in <a class="link_tag" href="https://notes.nicolasdeville.com/projects/"><span data-pagefind-filter="category">projects</span></a>

 tags: <a class="link_tag" href="https://notes.nicolasdeville.com/tag/python.html">python</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/chrome-extension.html">chrome extension</a>
<a class="link_tag" href="https://notes.nicolasdeville.com/tag/linkedin.html">linkedin</a>

        <!-- added 4/7 -->
        <!-- 		<br />
        <abbr class="modified" title="2023-03-11T12:36:09.706310+01:00">
                Updated: 11 Mar 2023
        </abbr>
 -->

    </p>

    

</footer>            <!-- for indexing by Stork -->
            <!-- <main>  -->
                <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#background">Background</a><ul>
<li><a href="#api">API</a></li>
</ul>
</li>
<li><a href="#goal">Goal</a><ul>
<li><a href="#risks">Risks</a></li>
<li><a href="#limits">Limits</a><ul>
<li><a href="#visits">Visits</a></li>
<li><a href="#connects">Connects</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#structure">Structure</a></li>
<li><a href="#chrome-extension-download-pages-as-html-files">Chrome extension (download pages as HTML files)</a><ul>
<li><a href="#backgroundjs">background.js</a><ul>
<li><a href="#for-linkedin-company-profiles">for Linkedin Company profiles</a></li>
<li><a href="#for-linkedin-people-profiles">for Linkedin People profiles</a></li>
</ul>
</li>
<li><a href="#manifestjson">manifest.json</a><ul>
<li><a href="#for-linkedin-company-profiles_1">for Linkedin Company profiles</a></li>
<li><a href="#for-linkedin-people-profiles_1">for Linkedin People profiles</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#python-scripts-visit-profiles-extract-data">Python scripts (visit profiles &amp; extract data)</a><ul>
<li><a href="#visitee">Visitee</a><ul>
<li><a href="#extractee">Extractee</a><ul>
<li><a href="#companies">Companies</a></li>
</ul>
</li>
<li><a href="#people">People</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#todo">TODO</a><ul>
<li><a href="#get-also-viewed">Get Also Viewed</a></li>
<li><a href="#get-company-data-from-company-pages">Get Company data from Company pages</a></li>
<li><a href="#make-grist_companies-a-function">Make Grist_Companies a function</a></li>
<li><a href="#process-each-file-after-visit">Process each file after visit</a></li>
</ul>
</li>
<li><a href="#resources">Resources</a></li>
</ul>
</div>
<p><span class="datestamp">15 Jan 2023</span>   </p>
<h1 id="background">Background</h1>
<p>As I'm trying to find my next gig, I turn to Linkedin to help me network and find the right opportunity.   </p>
<p>I have had a Linkedin Sales Navigator account for a while, each time paid by the company I was working for.   </p>
<p>Emerging from my sabbatical, I have subscribed to Linkedin Premium (the Job Seeker version).    </p>
<p>In theory this means I can access all the data I need to find the right opportunity.  </p>
<p>But in practice, the UX &amp; limitations (300 max profile visits per days? 500?) makes it a challenge to find &amp; keep track of my job search activities.  </p>
<p>Ultimately what I need - now or in the future for Sales activities - is a way for me to process the data on my own terms (ie in my own systems) vs. being imposed the cumbersome UI/UX of Linkedin.     </p>
<p>I have played with Linkedin automation tools in the past, but got flagged by Linkedin and had to stop. <br>
There are many tools these days, but they all have the same issue: they violate Linkedin's terms of service, and can be expensive.   </p>
<p>The reason Linkedin's terms prevent from automating the data extraction is because the data is their asset (though it should not be - it's the users' data) and they need Linkedin pages to be visited (ie displayed on screen) so as to show ads, which they make money on.   </p>
<p>I believe that should not be the case considering I'm paying for the service, but that's another story.  </p>
<h2 id="api">API</h2>
<p>Linkedin's API is gated (requires a developer account subject to their review) and the data is very limited.   </p>
<p>So I decided to build my own solution.   </p>
<h1 id="goal">Goal</h1>
<p>My solution is based on ensuring pages are visited "as normal" (on my screen, using a non-automation controlled browser) so that they get their ads revenues.  </p>
<p>Noting also that I usually visit Linkedin manually with the Brave browser <span class="nic_link"><a href="https://notes.nicolasdeville.com/apps/brave" target="_blank">Brave</a></span> , which blocks ads.  </p>
<p>Here I will automate the visit of the Linkedin pages as if it was me, using Chrome (ie with ads display), and automate the data extraction.  </p>
<p>Ultimately what I want is the ability to have a function that takes a company website URL and outputs a list of employees (or defined key people, eg CEO) to my data repository where I can manipulate the data at ease, eg:  </p>
<ul>
<li>filter by any criteria</li>
<li>keep track of my progress (eg job search or sales prospecting)</li>
</ul>
<p>At the same time visiting those people's profiles as a "soft touch" (ie they see my profile in their "who viewed your profile" list).   </p>
<blockquote>
<p>Linkedin get their ads revenues + my subscription fees. And I use the data only for my own needs, so in line with their terms.     </p>
</blockquote>
<h2 id="risks">Risks</h2>
<p>Risk is to get flagged by Linkedin, with account restrictions or even account suspension.     </p>
<p>However, considering the following, I hope the risks are limited:  </p>
<ul>
<li>I'm not automating the visit of pages by clicking on links</li>
<li>I will stay under the daily visits limit (see below)</li>
<li>I'm paying for a subscription + let their ads display (double revenue for Linkedin) which I see. </li>
<li>not using the data for spam, only targeted outreach (that's the whole point of the automation, otherwise tedious manual work to target precisely)</li>
<li>Connects &amp; InMails are sent manually (manual/high-touch time investment here, where it matters, instead of at the data stage)</li>
</ul>
<p>This project requires some tech-savviness &amp; Python knowledge, it is not for everyone.   </p>
<h2 id="limits">Limits</h2>
<h3 id="visits">Visits</h3>
<p>Rule of thumb: don't view more pages that a professional (or VA) could do manually in a day.   </p>
<ul>
<li>300 max profile visits per day? 500?  </li>
</ul>
<h3 id="connects">Connects</h3>
<p>no more than 3–5% of your total LinkedIn connections (<a href="https://support.dux-soup.com/article/45-how-many-connection-requests-to-send" target="_blank">https://support.dux-soup.com/article/45-how-many-connection-requests-to-send</a>).  <br>
em</p>
<h1 id="structure">Structure</h1>
<ul>
<li>Chrome extension to download pages as HTML files upon visit (ie page load)</li>
<li>Python script to visit a list of pages (ie profiles), both Company and People</li>
<li>Python script to extract data from the HTML files</li>
</ul>
<p>My data repository is Grist <span class="nic_link"><a href="https://notes.nicolasdeville.com/apps/grist" target="_blank">Grist | The Evolution of Spreadsheets</a></span>.</p>
<h1 id="chrome-extension-download-pages-as-html-files">Chrome extension (download pages as HTML files)</h1>
<p>See <span class="nic_link"><a href="https://notes.nicolasdeville.com/helpers/chrome-extension" target="_blank">Building a custom Google Chrome extension</a></span></p>
<p>Chrome extensions require simply a folder containing at least 2 files: <br>
- manifest.json
- background.js</p>
<h2 id="backgroundjs">background.js</h2>
<h3 id="for-linkedin-company-profiles">for Linkedin Company profiles</h3>
<div class="highlight"><pre><span></span><code><span class="nx">chrome</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">onMessage</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span><span class="w"> </span><span class="nx">sender</span><span class="p">,</span><span class="w"> </span><span class="nx">sendResponse</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">message</span><span class="o">==</span><span class="s2">&quot;download&quot;</span><span class="p">){</span><span class="w"></span>
<span class="nx">html</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">html</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">dataUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;data:text/html,&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">html</span><span class="p">);</span><span class="w"></span>
<span class="nx">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">URL</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">urlo</span><span class="p">)</span><span class="w"></span>
<span class="nx">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">filename</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">filename</span><span class="p">.</span><span class="nx">origin</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^a-zA-Z0-9]/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">chrome</span><span class="p">.</span><span class="nx">downloads</span><span class="p">.</span><span class="nx">download</span><span class="p">({</span><span class="w"></span>
<span class="w">    </span><span class="s1">&#39;url&#39;</span><span class="o">:</span><span class="w"> </span><span class="nx">dataUrl</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s1">&#39;filename&#39;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Linkedin/companies/&quot;</span><span class="o">+</span><span class="nx">filename</span><span class="o">+</span><span class="s2">&quot;.html&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s1">&#39;saveAs&#39;</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">})</span><span class="w"> </span>

<span class="nx">chrome</span><span class="p">.</span><span class="nx">tabs</span><span class="p">.</span><span class="nx">onUpdated</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">tabId</span><span class="p">,</span><span class="w"> </span><span class="nx">changeInfo</span><span class="p">,</span><span class="w"> </span><span class="nx">tab</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">tab</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;complete&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">tab</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="s2">&quot;chrome://&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="nx">urlo</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">tab</span><span class="p">.</span><span class="nx">url</span><span class="w"></span>
<span class="k">if</span><span class="p">(</span><span class="nx">urlo</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="s2">&quot;linkedin.com/company/&quot;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mf">0</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="nx">chrome</span><span class="p">.</span><span class="nx">scripting</span><span class="p">.</span><span class="nx">executeScript</span><span class="p">({</span><span class="w"> </span><span class="nx">target</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tabId</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nx">func</span><span class="o">:</span><span class="nx">runner</span><span class="p">,</span><span class="nx">args</span><span class="o">:</span><span class="p">[</span><span class="nx">urlo</span><span class="p">]});</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">runner</span><span class="p">(</span><span class="nx">urlo</span><span class="p">){</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="ow">typeof</span><span class="p">(</span><span class="nx">exist</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;undefined&quot;</span><span class="p">){</span><span class="w"></span>
<span class="w">      </span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="w"></span>
<span class="w">        </span><span class="nx">chrome</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">({</span><span class="s2">&quot;message&quot;</span><span class="o">:</span><span class="s2">&quot;download&quot;</span><span class="p">,</span><span class="s2">&quot;html&quot;</span><span class="o">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">,</span><span class="nx">urlo</span><span class="o">:</span><span class="nx">urlo</span><span class="p">})</span><span class="w"></span>

<span class="w">      </span><span class="p">},</span><span class="mf">4000</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="nx">exist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">   </span><span class="p">}</span><span class="w"> </span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
</code></pre></div>

<h3 id="for-linkedin-people-profiles">for Linkedin People profiles</h3>
<p>I use a second Chrome extension for People profiles, with the same <code>background.js</code> as above, just changing these lines:   </p>
<p>Different save folder in my Downloads folder: <code>'filename': "Linkedin/people/"+filename+".html",</code>  </p>
<p>Save HTML based on page URL: <code>if(urlo.search("linkedin.com/in/")&gt;=0){</code>    </p>
<h2 id="manifestjson">manifest.json</h2>
<h3 id="for-linkedin-company-profiles_1">for Linkedin Company profiles</h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Save Linkedin Companies&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;manifest_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;saves automatically Linkedin Company profiles visited to given folder as HTML file&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;icons&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="nt">&quot;16&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icon.png&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;32&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icon.png&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;48&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icon.png&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;128&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;icon.png&quot;</span><span class="w"></span>
<span class="p">},</span><span class="w"></span>

<span class="w">    </span><span class="nt">&quot;background&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;service_worker&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;background.js&quot;</span><span class="w"></span>
<span class="p">},</span><span class="w"></span>

<span class="w">    </span><span class="nt">&quot;host_permissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&lt;all_urls&gt;&quot;</span><span class="p">],</span><span class="w"></span>


<span class="nt">&quot;permissions&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;downloads&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;scripting&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;tabs&quot;</span><span class="w"></span>
<span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<h3 id="for-linkedin-people-profiles_1">for Linkedin People profiles</h3>
<p>Same as above, just changing the name. The difference will be only in the background.js file triggered by the extension.    </p>
<p>TODO - figure out how to have them both in a single extension (not critical at this stage).</p>
<h1 id="python-scripts-visit-profiles-extract-data">Python scripts (visit profiles &amp; extract data)</h1>
<h2 id="visitee">Visitee</h2>
<div class="highlight"><pre><span></span><code><span class="c1">####################</span>
<span class="c1"># Visit Linkedin profiles</span>

<span class="n">test</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">v</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># verbose mode</span>

<span class="c1">### Script-specific imports</span>

<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="c1"># from random import randint, uniform</span>
<span class="kn">import</span> <span class="nn">visited</span>
<span class="kn">from</span> <span class="nn">my_utils</span> <span class="kn">import</span> <span class="n">linkedin_handle_from_url</span><span class="p">,</span> <span class="n">linkedin_url_from_handle</span>
<span class="kn">import</span> <span class="nn">add_to_Grist_People</span>
<span class="kn">import</span> <span class="nn">add_to_Grist_Companies</span>

<span class="c1">### Global Variables</span>

<span class="n">DB</span> <span class="o">=</span> <span class="s1">&#39;RECRUITERS&#39;</span> <span class="c1"># &#39;STARTUPS&#39; or &#39;VCs&#39; or &#39;RECRUITERS&#39;</span>
<span class="n">VISIT</span> <span class="o">=</span> <span class="s1">&#39;PERSON&#39;</span> <span class="c1"># &#39;COMPANY&#39; or &#39;PERSON&#39;</span>

<span class="n">count_to_visit</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">69</span><span class="p">,</span> <span class="mi">93</span><span class="p">)</span>
<span class="k">if</span> <span class="n">test</span><span class="p">:</span>
    <span class="n">count_to_visit</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">count_to_visit: </span><span class="si">{</span><span class="n">count_to_visit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">wait_from</span> <span class="o">=</span> <span class="mf">13.5</span>
<span class="n">wait_to</span> <span class="o">=</span> <span class="mf">27.8</span>

<span class="n">count_visited</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">count_visited_today</span> <span class="o">=</span> <span class="n">visited</span><span class="o">.</span><span class="n">people_today</span><span class="p">()</span>

<span class="c1">### Functions</span>

<span class="c1"># def linkedin_handle_from_url(url):</span>
<span class="c1">#     # People LinkedIn URLs</span>
<span class="c1">#     if &#39;linkedin.com/in/&#39; in url:</span>
<span class="c1">#         handle = url.split(&#39;linkedin.com/in/&#39;)[1]</span>
<span class="c1">#     # Company LinkedIn URLs</span>
<span class="c1">#     elif &#39;linkedin.com/company/&#39; in url:</span>
<span class="c1">#         handle = url.split(&#39;linkedin.com/company/&#39;)[1]</span>
<span class="c1">#     elif &#39;linkedin.com/showcase/&#39; in url:</span>
<span class="c1">#         handle = url.split(&#39;linkedin.com/showcase/&#39;)[1]</span>
<span class="c1">#     # Process handle</span>
<span class="c1">#     if &#39;?&#39; in handle:</span>
<span class="c1">#         handle = handle.split(&#39;?&#39;)[0]</span>
<span class="c1">#     if &#39;/&#39; in handle:</span>
<span class="c1">#         handle = handle.replace(&#39;/&#39;, &#39;&#39;)</span>
<span class="c1">#     return handle</span>

<span class="c1"># def linkedin_url_from_handle(linkedin_handle):</span>
<span class="c1">#     return f&#39;https://www.linkedin.com/in/{linkedin_handle}&#39;</span>

<span class="c1">### Main</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Loading data for </span><span class="si">{</span><span class="n">DB</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">DB</span> <span class="o">==</span> <span class="s1">&#39;STARTUPS&#39;</span><span class="p">:</span>
    <span class="n">data_companies</span> <span class="o">=</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Startups</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">)</span>
    <span class="n">data_people</span> <span class="o">=</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Startups</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">DB</span> <span class="o">==</span> <span class="s1">&#39;VCs&#39;</span><span class="p">:</span>
    <span class="n">data_companies</span> <span class="o">=</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">VCs</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">)</span>
    <span class="n">data_people</span> <span class="o">=</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">VCs</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">DB</span> <span class="o">==</span> <span class="s1">&#39;RECRUITERS&#39;</span><span class="p">:</span>
    <span class="n">data_companies</span> <span class="o">=</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Recruiters</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">)</span>
    <span class="n">data_people</span> <span class="o">=</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Recruiters</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_companies</span><span class="p">)</span><span class="si">}</span><span class="s2"> companies&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_people</span><span class="p">)</span><span class="si">}</span><span class="s2"> people&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Starting Visitee </span><span class="si">{</span><span class="n">VISIT</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">DB</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">VISIT</span> <span class="o">==</span> <span class="s1">&#39;PERSON&#39;</span><span class="p">:</span>

    <span class="n">data_companies_to_visit</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_companies</span>
        <span class="c1"># if x.yes == True</span>
        <span class="c1"># if &#39;VE_Providers&#39; in x.notes</span>
        <span class="c1"># if &#39;US&#39; in x.gristHelper_Display2</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">discard</span>
        <span class="p">]</span> 
    <span class="n">data_linkedins_to_visit</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_people</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">domain</span> <span class="ow">in</span> <span class="n">data_companies_to_visit</span>
        <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">downloaded</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">discard</span>
        <span class="c1"># and x.PI == True</span>
        <span class="p">}</span>
    <span class="n">to_do</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_linkedins_to_visit</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_do</span> <span class="o">&lt;</span> <span class="n">count_to_visit</span><span class="p">:</span>
        <span class="n">count_to_visit</span> <span class="o">=</span> <span class="n">to_do</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="si">{</span><span class="n">to_do</span><span class="si">}</span><span class="s2"> PERSON Linkedin profiles to visit from </span><span class="si">{</span><span class="n">DB</span><span class="si">}</span><span class="s2">.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1">### Functions</span>


    <span class="c1">### Main</span>

    <span class="k">if</span> <span class="n">to_do</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">linkedin</span><span class="p">,</span><span class="nb">id</span> <span class="ow">in</span> <span class="n">data_linkedins_to_visit</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">count_visited</span> <span class="o">&lt;</span> <span class="n">count_to_visit</span><span class="p">:</span>

                <span class="n">count_visited</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">count_visited_today</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">to_do</span> <span class="o">=</span> <span class="n">to_do</span> <span class="o">-</span> <span class="mi">1</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">count_visited</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">count_to_visit</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">to_do</span><span class="si">}</span><span class="s2"> total left / </span><span class="si">{</span><span class="n">count_visited_today</span><span class="si">}</span><span class="s2"> visited today) </span><span class="si">{</span><span class="n">linkedin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">update_data</span> <span class="o">=</span> <span class="p">[{</span>   
                                    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span>
                                    <span class="s1">&#39;visited&#39;</span><span class="p">:</span> <span class="n">ts_db</span><span class="p">,</span>
                                    <span class="s1">&#39;downloaded&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                    <span class="p">}]</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">test</span><span class="p">:</span>

                    <span class="n">webbrowser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;chrome&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="n">linkedin</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">DB</span> <span class="o">==</span> <span class="s1">&#39;STARTUPS&#39;</span><span class="p">:</span>
                        <span class="n">grist_BB</span><span class="o">.</span><span class="n">Startups</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">,</span> <span class="n">update_data</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">DB</span> <span class="o">==</span> <span class="s1">&#39;VCs&#39;</span><span class="p">:</span>
                        <span class="n">grist_BB</span><span class="o">.</span><span class="n">VCs</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">,</span> <span class="n">update_data</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">DB</span> <span class="o">==</span> <span class="s1">&#39;RECRUITERS&#39;</span><span class="p">:</span>
                        <span class="n">grist_BB</span><span class="o">.</span><span class="n">Recruiters</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">,</span> <span class="n">update_data</span><span class="p">)</span>

                    <span class="n">wait</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">wait_from</span><span class="p">,</span> <span class="n">wait_to</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;waiting </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">wait</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">LEFT TO DO: </span><span class="si">{</span><span class="n">to_do</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1">### ADD TO GRIST</span>

        <span class="n">add_to_Grist_People</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>

        <span class="c1">### CHECK VISITED</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">test</span><span class="p">:</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">people_today</span><span class="p">()</span>

<span class="k">if</span> <span class="n">VISIT</span> <span class="o">==</span> <span class="s1">&#39;COMPANY&#39;</span><span class="p">:</span>

    <span class="n">data_companies_to_visit</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_companies</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;/showcase/&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span>
        <span class="c1"># and x.yes == True</span>
        <span class="c1"># and not x.ni</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">downloaded</span>
        <span class="c1"># and &#39;VE_Providers&#39; in x.notes</span>
        <span class="p">}</span>
    <span class="n">to_do</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_companies_to_visit</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_do</span> <span class="o">&lt;</span> <span class="n">count_to_visit</span><span class="p">:</span>
        <span class="n">count_to_visit</span> <span class="o">=</span> <span class="n">to_do</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="si">{</span><span class="n">to_do</span><span class="si">}</span><span class="s2"> COMPANY Linkedin profiles to visit from </span><span class="si">{</span><span class="n">DB</span><span class="si">}</span><span class="s2">.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">to_do</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="c1">### Main</span>

        <span class="k">for</span> <span class="n">linkedin_url</span><span class="p">,</span><span class="nb">id</span> <span class="ow">in</span> <span class="n">data_companies_to_visit</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">linkedin_url</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">count_visited</span> <span class="o">&lt;</span> <span class="n">count_to_visit</span><span class="p">:</span>

                <span class="n">count_visited</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">count_visited_today</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">to_do</span> <span class="o">=</span> <span class="n">to_do</span> <span class="o">-</span> <span class="mi">1</span>

                <span class="c1"># print(f&quot;\n{count_visited}/{count_to_visit} ({to_do} total left / {count_visited_today} visited today) {linkedin_url}&quot;)</span>

                <span class="n">linkedin_handle</span> <span class="o">=</span> <span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">linkedin_url</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">DB</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;STARTUPS&#39;</span><span class="p">]:</span>
                    <span class="n">linkedin</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/company/</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">}</span><span class="s2">/people/?keywords=ceo&quot;</span>
                <span class="k">if</span> <span class="n">DB</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;RECRUITERS&#39;</span><span class="p">]:</span>
                    <span class="n">linkedin</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/company/</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">}</span><span class="s2">/people/&quot;</span>
                <span class="k">elif</span> <span class="n">DB</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;VCs&#39;</span><span class="p">]:</span>
                    <span class="n">linkedin</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/company/</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">}</span><span class="s2">/people/?keywords=partner&quot;</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">count_visited</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">count_to_visit</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">to_do</span><span class="si">}</span><span class="s2"> total left) </span><span class="si">{</span><span class="n">linkedin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">update_data</span> <span class="o">=</span> <span class="p">[{</span>   
                                <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span>
                                <span class="s1">&#39;downloaded&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="p">}]</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">test</span><span class="p">:</span>

                    <span class="n">webbrowser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;chrome&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">open_new_tab</span><span class="p">(</span><span class="n">linkedin</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">DB</span> <span class="o">==</span> <span class="s1">&#39;STARTUPS&#39;</span><span class="p">:</span>
                        <span class="n">grist_BB</span><span class="o">.</span><span class="n">Startups</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">,</span> <span class="n">update_data</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">DB</span> <span class="o">==</span> <span class="s1">&#39;VCs&#39;</span><span class="p">:</span>
                        <span class="n">grist_BB</span><span class="o">.</span><span class="n">VCs</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">,</span> <span class="n">update_data</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">DB</span> <span class="o">==</span> <span class="s1">&#39;RECRUITERS&#39;</span><span class="p">:</span>
                        <span class="n">grist_BB</span><span class="o">.</span><span class="n">Recruiters</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">,</span> <span class="n">update_data</span><span class="p">)</span>

                    <span class="n">wait</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">wait_from</span><span class="p">,</span> <span class="n">wait_to</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;waiting </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">wait</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">()</span>

        <span class="c1">### ADD TO GRIST</span>

        <span class="c1"># First Companies</span>
        <span class="n">add_to_Grist_Companies</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
        <span class="c1"># Then People extracted from those companies</span>
        <span class="n">add_to_Grist_People</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>

        <span class="c1">### CHECK VISITED</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">test</span><span class="p">:</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">people_today</span><span class="p">()</span>
</code></pre></div>

<h3 id="extractee">Extractee</h3>
<h4 id="companies">Companies</h4>
<div class="highlight"><pre><span></span><code><span class="c1">####################</span>
<span class="c1"># Add scraped data from Linkedin COMPANY pages to Grist</span>

<span class="c1">### Script-specific imports</span>

<span class="kn">from</span> <span class="nn">extract_data</span> <span class="kn">import</span> <span class="n">company_profile</span>
<span class="c1"># import requests</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="c1">### Functions</span>

<span class="k">def</span> <span class="nf">fetch_file_paths</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">test</span>
    <span class="n">file_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="n">folder_path</span><span class="p">:</span> <span class="c1"># remove to also crawl subfolders</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
                <span class="n">file_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">test</span><span class="p">:</span> 
        <span class="n">file_paths</span> <span class="o">=</span> <span class="n">file_paths</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">file_paths</span>

<span class="k">def</span> <span class="nf">linkedin_handle_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># People LinkedIn URLs</span>
    <span class="k">if</span> <span class="s1">&#39;linkedin.com/in/&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;linkedin.com/in/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Company LinkedIn URLs</span>
    <span class="k">elif</span> <span class="s1">&#39;linkedin.com/company/&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;linkedin.com/company/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;linkedin.com/showcase/&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;linkedin.com/showcase/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Process handle</span>
    <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">handle</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">handle</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">handle</span>

<span class="k">def</span> <span class="nf">linkedin_link_from_file_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_path</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Recreate the LinkedIn URL based on file name</span>
    <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/Users/xxx/Downloads/Linkedin/companies/_company_&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.linkedin.com/company/&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;_people__keywords_ceo.html&#39;</span> <span class="ow">in</span> <span class="n">linkedin_link</span><span class="p">:</span>
        <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_people__keywords_ceo.html&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;_people__keywords_partner.html&#39;</span> <span class="ow">in</span> <span class="n">linkedin_link</span><span class="p">:</span>
        <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_people__keywords_partner.html&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;_people__keywords_saas.html&#39;</span> <span class="ow">in</span> <span class="n">linkedin_link</span><span class="p">:</span>
        <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_people__keywords_saas.html&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;_people_.html&#39;</span> <span class="ow">in</span> <span class="n">linkedin_link</span><span class="p">:</span>
        <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_people_.html&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="c1"># TODO make it more generic to capture any keyword</span>
    <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;--&#39;</span><span class="p">):</span>
        <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="p">[</span> <span class="p">:</span> <span class="o">-</span><span class="mi">2</span> <span class="p">]</span>
    <span class="k">if</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
        <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="p">[</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">]</span>
    <span class="c1"># if v:</span>
    <span class="c1">#     print(f&#39;\n{loc} func(linkedin_link_from_file_path) #{ln()}: {linkedin_link=}&#39;)</span>
    <span class="k">return</span> <span class="n">linkedin_link</span>

<span class="c1">### Main</span>

<span class="c1">#### COMPANIES</span>

<span class="k">def</span> <span class="nf">process</span><span class="p">():</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">processed_files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">error_files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">error_handles</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">count_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_matches</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">company_categories_found</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="n">lc_vcs_linkedins</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lc_recruiters_linkedins</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lc_startups_linkedins</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">============ STARTING add_to_Grist_Companies</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">companies_folder_path</span> <span class="o">=</span> <span class="s1">&#39;/Users/xxx/Downloads/Linkedin/companies&#39;</span>

    <span class="c1">#### Dicts of Grist COMPANY Linkedin handles (per Grist doc), as UID</span>

    <span class="n">grist_recruiters_companies</span> <span class="o">=</span> <span class="p">{</span><span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Recruiters</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]}</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grist_recruiters_companies</span><span class="p">)</span><span class="si">}</span><span class="s2"> Recruiters Company profiles from Grist.&quot;</span><span class="p">)</span>
    <span class="n">grist_vcs_companies</span> <span class="o">=</span> <span class="p">{</span><span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">VCs</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]}</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grist_vcs_companies</span><span class="p">)</span><span class="si">}</span><span class="s2"> VCs Company profiles from Grist.&quot;</span><span class="p">)</span>
    <span class="n">grist_startups_companies</span> <span class="o">=</span> <span class="p">{</span><span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Startups</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Master&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]}</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grist_startups_companies</span><span class="p">)</span><span class="si">}</span><span class="s2"> Startups Company profiles from Grist.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1">#### Dicts of Grist PERSON Profiles (per Grist doc), as UID</span>

    <span class="n">grist_recruiters_linkedins</span> <span class="o">=</span> <span class="p">{</span>
                                    <span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Recruiters</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">)</span>
                                    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
                                    <span class="p">}</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grist_recruiters_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> Recruiters Linkedin profiles from Grist.&quot;</span><span class="p">)</span>

    <span class="n">grist_vcs_linkedins</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">VCs</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
                            <span class="p">}</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grist_vcs_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> VCs Linkedin profiles from Grist.&quot;</span><span class="p">)</span>

    <span class="n">grist_startups_linkedins</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Startups</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
                            <span class="p">}</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grist_startups_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> Startups Linkedin profiles from Grist.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1">#### Dict of Scraped profiles</span>

    <span class="c1"># def process_companies_files(): # TODO make function so as to be called again later with errors</span>

    <span class="n">file_paths</span> <span class="o">=</span> <span class="n">fetch_file_paths</span><span class="p">(</span><span class="n">companies_folder_path</span><span class="p">)</span>

    <span class="n">dict_scraped_vcs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dict_scraped_recruiters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dict_scraped_startups</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">file_paths</span><span class="p">):</span>
        <span class="n">count_total</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># print(f&quot;{file_path=}&quot;)</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;.html&quot;</span><span class="p">)):</span>
            <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_path</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;_people_&#39;</span> <span class="ow">in</span> <span class="n">file_path</span><span class="p">:</span>
                    <span class="n">count_matches</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">#######################</span><span class="se">\n</span><span class="si">{</span><span class="n">count_matches</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">file_path</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link_from_file_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>

                    <span class="n">linkedin_handle</span> <span class="o">=</span> <span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">linkedin_link</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># Scrape the LinkedIn profile with extract_data.py</span>
                        <span class="n">company_profile_data</span> <span class="o">=</span> <span class="n">company_profile</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>

                        <span class="c1"># Categorisation</span>
                        <span class="n">category</span> <span class="o">=</span> <span class="n">company_profile_data</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                        <span class="n">company_categories_found</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">category</span><span class="p">)</span> <span class="c1"># for overview of all categories found</span>
                        <span class="k">if</span> <span class="s1">&#39;Recruiting&#39;</span> <span class="ow">in</span> <span class="n">category</span><span class="p">:</span>
                            <span class="n">classify_as</span> <span class="o">=</span> <span class="s1">&#39;Recruiter&#39;</span>
                        <span class="k">elif</span> <span class="s1">&#39;Venture Capital&#39;</span> <span class="ow">in</span> <span class="n">category</span><span class="p">:</span>
                            <span class="n">classify_as</span> <span class="o">=</span> <span class="s1">&#39;VC&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">classify_as</span> <span class="o">=</span> <span class="s1">&#39;Startup&#39;</span>

                        <span class="c1"># Add to dicts per Grist Doc with Linkedin handle as key</span>
                        <span class="k">if</span> <span class="n">classify_as</span> <span class="o">==</span> <span class="s1">&#39;Recruiter&#39;</span><span class="p">:</span>
                            <span class="n">dict_scraped_recruiters</span><span class="p">[</span><span class="n">linkedin_handle</span><span class="p">]</span> <span class="o">=</span> <span class="n">company_profile_data</span>
                        <span class="k">elif</span> <span class="n">classify_as</span> <span class="o">==</span> <span class="s1">&#39;VC&#39;</span><span class="p">:</span>
                            <span class="n">dict_scraped_vcs</span><span class="p">[</span><span class="n">linkedin_handle</span><span class="p">]</span> <span class="o">=</span> <span class="n">company_profile_data</span>
                        <span class="k">elif</span> <span class="n">classify_as</span> <span class="o">==</span> <span class="s1">&#39;Startup&#39;</span><span class="p">:</span>
                            <span class="n">dict_scraped_startups</span><span class="p">[</span><span class="n">linkedin_handle</span><span class="p">]</span> <span class="o">=</span> <span class="n">company_profile_data</span>

                        <span class="n">processed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error with handle </span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">}</span><span class="s2">: removing file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">error_handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linkedin_handle</span><span class="p">)</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>


    <span class="c1">#### Process to Grist</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Processing scraped data:</span><span class="se">\n</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_scraped_recruiters</span><span class="p">)</span><span class="si">}</span><span class="s2"> Recruiters</span><span class="se">\n</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_scraped_vcs</span><span class="p">)</span><span class="si">}</span><span class="s2"> VCs</span><span class="se">\n</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_scraped_startups</span><span class="p">)</span><span class="si">}</span><span class="s2"> Startups&quot;</span><span class="p">)</span>

    <span class="c1"># processed_startups = []</span>

    <span class="c1"># print()</span>
    <span class="c1"># pp.pprint(dict_scraped_startups)</span>
    <span class="c1"># print()</span>

    <span class="c1">### STARTUPS</span>
    <span class="k">for</span> <span class="n">linkedin_company_handle</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dict_scraped_startups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">linkedin_company_handle</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">data=</span><span class="si">{</span><span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;file_path&#39;</span><span class="p">]</span>

        <span class="c1"># PEOPLE DATA</span>
        <span class="n">people</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;people&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="n">people</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">l</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">p</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">linkedin_handle</span> <span class="o">=</span> <span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;linkedin_link&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;%&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">linkedin_handle</span><span class="p">:</span>

                <span class="n">connection</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;connection&#39;</span><span class="p">]</span>
                <span class="n">new_linkedin_link</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/in/</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>

                <span class="n">person_data</span> <span class="o">=</span> <span class="p">{</span>   
                            <span class="s1">&#39;connection&#39;</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
                            <span class="s1">&#39;linkedin&#39;</span><span class="p">:</span> <span class="n">new_linkedin_link</span><span class="p">,</span>
                            <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                            <span class="s1">&#39;headline&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
                            <span class="s1">&#39;src&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/company/</span><span class="si">{</span><span class="n">linkedin_company_handle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="s1">&#39;created&#39;</span><span class="p">:</span> <span class="n">ts_db</span><span class="p">,</span>
                        <span class="p">}</span>

                <span class="c1">## PREPARE TO ADD TO GRIST</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">=}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1">### Startups</span>
                <span class="k">if</span> <span class="n">linkedin_company_handle</span> <span class="ow">in</span> <span class="n">grist_startups_companies</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">linkedin_handle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">grist_startups_linkedins</span><span class="p">:</span>
                        <span class="c1"># Get the Foreign Key for the Master record to associate People with</span>
                        <span class="n">fk</span> <span class="o">=</span> <span class="n">grist_startups_companies</span><span class="p">[</span><span class="n">linkedin_company_handle</span><span class="p">]</span> <span class="c1"># int x.id</span>
                        <span class="c1"># Update person_data object with Foreign Key</span>
                        <span class="n">person_data</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fk</span>
                        <span class="c1"># Append to Startups list to create in Grist</span>
                        <span class="n">lc_startups_linkedins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">person_data</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">new_linkedin_link</span><span class="si">}</span><span class="s2"> to Startups&quot;</span><span class="p">)</span>

            <span class="c1"># COMPANY DATA</span>
            <span class="c1"># TODO goal: update Master record with data from Company Linkedin profile</span>

            <span class="n">processed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

    <span class="c1">### RECRUITERS</span>
    <span class="k">for</span> <span class="n">linkedin_company_handle</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dict_scraped_recruiters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">linkedin_company_handle</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">data=</span><span class="si">{</span><span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;file_path&#39;</span><span class="p">]</span>

        <span class="c1"># PEOPLE DATA</span>
        <span class="n">people</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;people&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="n">people</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">l</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">p</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">linkedin_handle</span> <span class="o">=</span> <span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;linkedin_link&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;%&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">linkedin_handle</span><span class="p">:</span>

                <span class="n">connection</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;connection&#39;</span><span class="p">]</span>
                <span class="n">new_linkedin_link</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/in/</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>

                <span class="n">person_data</span> <span class="o">=</span> <span class="p">{</span>   
                            <span class="s1">&#39;connection&#39;</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
                            <span class="s1">&#39;linkedin&#39;</span><span class="p">:</span> <span class="n">new_linkedin_link</span><span class="p">,</span>
                            <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                            <span class="s1">&#39;headline&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
                            <span class="s1">&#39;src&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/company/</span><span class="si">{</span><span class="n">linkedin_company_handle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="s1">&#39;created&#39;</span><span class="p">:</span> <span class="n">ts_db</span><span class="p">,</span>
                        <span class="p">}</span>

                <span class="c1">## PREPARE TO ADD TO GRIST</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">=}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">linkedin_company_handle</span> <span class="ow">in</span> <span class="n">grist_recruiters_companies</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">linkedin_handle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">grist_recruiters_linkedins</span><span class="p">:</span>
                        <span class="n">fk</span> <span class="o">=</span> <span class="n">grist_recruiters_companies</span><span class="p">[</span><span class="n">linkedin_company_handle</span><span class="p">]</span> <span class="c1"># int x.id</span>
                        <span class="n">person_data</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fk</span>
                        <span class="n">lc_recruiters_linkedins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">person_data</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">new_linkedin_link</span><span class="si">}</span><span class="s2"> to recruiters&quot;</span><span class="p">)</span>

            <span class="c1"># COMPANY DATA</span>
            <span class="c1"># TODO goal: update Master record with data from Company Linkedin profile</span>

            <span class="n">processed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>


    <span class="c1">### VCs</span>
    <span class="k">for</span> <span class="n">linkedin_company_handle</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dict_scraped_vcs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">linkedin_company_handle</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">data=</span><span class="si">{</span><span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;file_path&#39;</span><span class="p">]</span>

        <span class="c1"># PEOPLE DATA</span>
        <span class="n">people</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;people&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="n">people</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">l</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">p</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">linkedin_handle</span> <span class="o">=</span> <span class="n">linkedin_handle_from_url</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;linkedin_link&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;%&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">linkedin_handle</span><span class="p">:</span>

                <span class="n">connection</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;connection&#39;</span><span class="p">]</span>
                <span class="n">new_linkedin_link</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/in/</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>

                <span class="n">person_data</span> <span class="o">=</span> <span class="p">{</span>   
                            <span class="s1">&#39;connection&#39;</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
                            <span class="s1">&#39;linkedin&#39;</span><span class="p">:</span> <span class="n">new_linkedin_link</span><span class="p">,</span>
                            <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                            <span class="s1">&#39;headline&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
                            <span class="s1">&#39;src&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/company/</span><span class="si">{</span><span class="n">linkedin_company_handle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="s1">&#39;created&#39;</span><span class="p">:</span> <span class="n">ts_db</span><span class="p">,</span>
                        <span class="p">}</span>

                <span class="c1">## PREPARE TO ADD TO GRIST</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">linkedin_handle</span><span class="si">=}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">linkedin_company_handle</span> <span class="ow">in</span> <span class="n">grist_vcs_companies</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">linkedin_handle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">grist_vcs_linkedins</span><span class="p">:</span>
                        <span class="n">fk</span> <span class="o">=</span> <span class="n">grist_vcs_companies</span><span class="p">[</span><span class="n">linkedin_company_handle</span><span class="p">]</span> <span class="c1"># int x.id</span>
                        <span class="n">person_data</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fk</span>
                        <span class="n">lc_vcs_linkedins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">person_data</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">new_linkedin_link</span><span class="si">}</span><span class="s2"> to vcs&quot;</span><span class="p">)</span>

            <span class="c1"># COMPANY DATA</span>
            <span class="c1"># TODO goal: update Master record with data from Company Linkedin profile</span>

            <span class="n">processed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>


    <span class="c1"># ADD TO GRIST</span>
    <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">TEST:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc_startups_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> Startups Linkedins to Grist:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc_vcs_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> VCs Linkedins to Grist:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc_recruiters_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> Recruiters Linkedins to Grist:&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lc_startups_linkedins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">grist_BB</span><span class="o">.</span><span class="n">Startups</span><span class="o">.</span><span class="n">add_records</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">,</span> <span class="n">lc_startups_linkedins</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">ADDED </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc_startups_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> Startups Linkedins profiles to Grist&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lc_vcs_linkedins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">grist_BB</span><span class="o">.</span><span class="n">VCs</span><span class="o">.</span><span class="n">add_records</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">,</span> <span class="n">lc_vcs_linkedins</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ADDED </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc_vcs_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> VCs Linkedins profiles to Grist&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lc_recruiters_linkedins</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">grist_BB</span><span class="o">.</span><span class="n">Recruiters</span><span class="o">.</span><span class="n">add_records</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">,</span> <span class="n">lc_recruiters_linkedins</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ADDED </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc_recruiters_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> Recruiters Linkedins profiles to Grist&quot;</span><span class="p">)</span>

    <span class="c1"># MOVE PROCESSED FILES</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">test</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">processed_files</span><span class="p">)):</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
            <span class="c1"># print(f&quot;{pf=}&quot;)</span>
            <span class="c1"># print(f&quot;{file_name=}&quot;)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/Users/xxx/Downloads/Linkedin/companies/processed/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/Users/xxx/Downloads/Linkedin/companies/processed/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="s1">&#39;/Users/xxx/Downloads/Linkedin/companies/processed&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">============ Moved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">processed_files</span><span class="p">)</span><span class="si">}</span><span class="s2"> scraped files to processed folder.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># CATEGORIES OF COMPANIES PROCESSED (for classification tweaking/troubleshooting)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">FYI - COMPANY CATEGORIES FOUND:&quot;</span><span class="p">)</span>
    <span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">company_categories_found</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">error_handles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># print(f&quot;\n{len(error_handles)} ERROR WITH FILES - opening them now on People section...&quot;)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">error_handles</span><span class="p">)</span><span class="si">}</span><span class="s2"> ERROR WITH FILES:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">handle</span> <span class="ow">in</span> <span class="n">error_handles</span><span class="p">:</span>
            <span class="n">link_to_open</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.linkedin.com/company/</span><span class="si">{</span><span class="n">handle</span><span class="si">}</span><span class="s2">/people/&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">link_to_open</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># # 230113 Stopped visiting automatically as most are dead links</span>
            <span class="c1"># if handle.strip() not in [&#39;unavailable&#39;,&#39;404&#39;]:</span>

            <span class="c1">#     print(f&quot;Opening {link_to_open}&quot;)</span>
            <span class="c1">#     webbrowser.get(&#39;chrome&#39;).open_new_tab(link_to_open)</span>

            <span class="c1">#     wait = randint(12, 29)</span>

            <span class="c1">#     print(f&quot;waiting {wait} seconds&quot;)</span>

            <span class="c1">#     for w in range(1,wait + 1):</span>
            <span class="c1">#         # print(w, end=&quot; &quot;, flush=True)</span>
            <span class="c1">#         print(&quot;\r&quot; + str(w), end=&#39;&#39;)</span>
            <span class="c1">#         time.sleep(1)</span>
            <span class="c1">#     print()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="si">{</span><span class="n">count_total</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count_matches</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># print(f&quot;{count=}&quot;)</span>


    <span class="c1"># TODO manage errors by visiting standard Company link &amp; doing a second pass (make function first)</span>
</code></pre></div>

<h3 id="people">People</h3>
<div class="highlight"><pre><span></span><code><span class="c1">### Script-specific imports</span>

<span class="kn">from</span> <span class="nn">extract_data</span> <span class="kn">import</span> <span class="n">linkedin_profile</span><span class="p">,</span> <span class="n">company_profile</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="c1">### Global Variables</span>

<span class="c1"># RUN = &#39;PEOPLE&#39; # &#39;PEOPLE&#39; or &#39;COMPANIES&#39; or &#39;ALL&#39;</span>

<span class="n">folder_path</span> <span class="o">=</span> <span class="s1">&#39;/Users/xxx/Downloads/Linkedin/profiles&#39;</span>

<span class="n">missing_experiences</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">processed_files</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">### Functions</span>

<span class="k">def</span> <span class="nf">fetch_file_paths</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">test</span>
    <span class="n">file_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">root</span> <span class="o">==</span> <span class="n">folder_path</span><span class="p">:</span> <span class="c1"># remove to also crawl subfolders</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
                <span class="n">file_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">test</span><span class="p">:</span> 
        <span class="n">file_paths</span> <span class="o">=</span> <span class="n">file_paths</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">file_paths</span>

<span class="k">def</span> <span class="nf">linkedin_handle_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="c1"># People LinkedIn URLs</span>
    <span class="k">if</span> <span class="s1">&#39;linkedin.com/in/&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;linkedin.com/in/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Company LinkedIn URLs</span>
    <span class="k">elif</span> <span class="s1">&#39;linkedin.com/company/&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;linkedin.com/company/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;linkedin.com/showcase/&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;linkedin.com/showcase/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Process handle</span>
    <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">handle</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">handle</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">handle</span>

<span class="c1">### Main</span>

<span class="c1">#### PEOPLE</span>

<span class="k">def</span> <span class="nf">process</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">count</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">============ STARTING add_to_Grist_People</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Dicts of Grist profiles (per Grist doc)</span>

    <span class="n">grist_recruiters_linkedins</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Recruiters</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
            <span class="n">linkedin</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">linkedin</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span>
        <span class="n">grist_recruiters_linkedins</span><span class="p">[</span><span class="n">linkedin</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grist_recruiters_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> Recruiters Linkedin profiles from Grist.&quot;</span><span class="p">)</span>

    <span class="n">grist_vcs_linkedins</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">VCs</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
            <span class="n">linkedin</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">linkedin</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span>
        <span class="n">grist_vcs_linkedins</span><span class="p">[</span><span class="n">linkedin</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grist_vcs_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> VCs Linkedin profiles from Grist.&quot;</span><span class="p">)</span>

    <span class="n">grist_startups_linkedins</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grist_BB</span><span class="o">.</span><span class="n">Startups</span><span class="o">.</span><span class="n">fetch_table</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
            <span class="n">linkedin</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">linkedin</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">linkedin</span>
        <span class="n">grist_startups_linkedins</span><span class="p">[</span><span class="n">linkedin</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetched </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grist_startups_linkedins</span><span class="p">)</span><span class="si">}</span><span class="s2"> Startups Linkedin profiles from Grist.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Dict of Scraped profiles</span>

    <span class="n">file_paths</span> <span class="o">=</span> <span class="n">fetch_file_paths</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>

    <span class="n">dict_scraped</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">file_paths</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;.html&quot;</span><span class="p">)):</span>
            <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_path</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">#######################</span><span class="se">\n</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">file_path</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># Recreate the LinkedIn URL based on file name</span>
                <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/Users/xxx/Downloads/Linkedin/profiles/_in_&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.linkedin.com/in/&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;originalSubdomain&#39;</span> <span class="ow">in</span> <span class="n">linkedin_link</span><span class="p">:</span>
                    <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;originalSubdomain&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;_&#39;</span> <span class="ow">in</span> <span class="n">linkedin_link</span><span class="p">:</span>
                    <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-.html&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;--&#39;</span><span class="p">):</span>
                    <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="p">[</span> <span class="p">:</span> <span class="o">-</span><span class="mi">2</span> <span class="p">]</span>
                <span class="k">if</span> <span class="n">linkedin_link</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
                    <span class="n">linkedin_link</span> <span class="o">=</span> <span class="n">linkedin_link</span><span class="p">[</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">]</span>
                <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">linkedin_link</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># Scrape the LinkedIn profile with extract_data.py</span>
                <span class="n">profile_data</span> <span class="o">=</span> <span class="n">linkedin_profile</span><span class="p">(</span><span class="n">linkedin_link</span><span class="p">,</span><span class="n">file_path</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>

                <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">]</span> <span class="o">=</span> <span class="n">profile_data</span>

                <span class="c1"># Keep track of profiles with no Experience identified because no Company logo on scraped page</span>
                <span class="k">if</span> <span class="n">profile_data</span><span class="p">[</span><span class="s1">&#39;count_experiences&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">missing_experiences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linkedin_link</span><span class="p">)</span>
                    <span class="c1"># os.remove(file_path)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

    <span class="c1">#### UPDATE GRIST</span>

    <span class="c1">## Recruiters</span>

    <span class="n">lu_recruiters</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">linkedin_link</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">grist_recruiters_linkedins</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">linkedin_link</span> <span class="ow">in</span> <span class="n">dict_scraped</span><span class="p">:</span>

            <span class="n">lu_recruiters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>   <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span>
                        <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;connection&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;connection&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;headline&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;headline&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;location&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;connections&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;connections&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;connection_status&#39;</span><span class="p">],</span>

                        <span class="s1">&#39;comp1_linkedin&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_linkedin1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp1_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_name1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp1_title&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;title1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp1_dates&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_dates1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_linkedin&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_linkedin2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_name2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_title&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;title2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_dates&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_dates2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_linkedin&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_linkedin3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_name3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_title&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;title3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_dates&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_dates3&#39;</span><span class="p">],</span>
                        <span class="p">}</span>
            <span class="p">)</span>

            <span class="n">processed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;file_path&#39;</span><span class="p">])</span>

    <span class="n">grist_BB</span><span class="o">.</span><span class="n">Recruiters</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">,</span> <span class="n">lu_recruiters</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">UPDATED </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lu_recruiters</span><span class="p">)</span><span class="si">}</span><span class="s2"> RECRUITERS LINKEDINS in GRIST.&quot;</span><span class="p">)</span>


    <span class="c1">## VCs</span>

    <span class="n">lu_vcs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">linkedin_link</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">grist_vcs_linkedins</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">linkedin_link</span> <span class="ow">in</span> <span class="n">dict_scraped</span><span class="p">:</span>

            <span class="n">lu_vcs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>   <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span>
                        <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;connection&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;connection&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;headline&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;headline&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;location&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;connections&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;connections&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;connection_status&#39;</span><span class="p">],</span>

                        <span class="s1">&#39;comp1_linkedin&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_linkedin1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp1_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_name1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp1_title&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;title1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp1_dates&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_dates1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_linkedin&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_linkedin2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_name2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_title&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;title2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_dates&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_dates2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_linkedin&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_linkedin3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_name3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_title&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;title3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_dates&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_dates3&#39;</span><span class="p">],</span>
                        <span class="p">}</span>
            <span class="p">)</span>

            <span class="n">processed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;file_path&#39;</span><span class="p">])</span>

    <span class="n">grist_BB</span><span class="o">.</span><span class="n">VCs</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">,</span> <span class="n">lu_vcs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">UPDATED </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lu_vcs</span><span class="p">)</span><span class="si">}</span><span class="s2"> VCs LINKEDINS in GRIST.&quot;</span><span class="p">)</span>


    <span class="c1">## Startups</span>

    <span class="n">lu_startups</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">linkedin_link</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">grist_startups_linkedins</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">linkedin_link</span> <span class="ow">in</span> <span class="n">dict_scraped</span><span class="p">:</span>

            <span class="n">lu_startups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>   <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span>
                        <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;connection&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;connection&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;headline&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;headline&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;location&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;connections&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;connections&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;connection_status&#39;</span><span class="p">],</span>

                        <span class="s1">&#39;comp1_linkedin&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_linkedin1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp1_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_name1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp1_title&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;title1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp1_dates&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_dates1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_linkedin&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_linkedin2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_name2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_title&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;title2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp2_dates&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_dates2&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_linkedin&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_linkedin3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_name&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_name3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_title&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;title3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;comp3_dates&#39;</span><span class="p">:</span> <span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;company_dates3&#39;</span><span class="p">],</span>
                        <span class="p">}</span>
            <span class="p">)</span>

            <span class="n">processed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_scraped</span><span class="p">[</span><span class="n">linkedin_link</span><span class="p">][</span><span class="s1">&#39;file_path&#39;</span><span class="p">])</span>

    <span class="n">grist_BB</span><span class="o">.</span><span class="n">Startups</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="s1">&#39;Linkedins&#39;</span><span class="p">,</span> <span class="n">lu_startups</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">UPDATED </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lu_startups</span><span class="p">)</span><span class="si">}</span><span class="s2"> STARTUP LINKEDINS VCs in GRIST.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_experiences</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">DELETED following files with Missing Experiences:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">missing_experiences</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">processed_files</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">processed_files</span><span class="p">)):</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/Users/xxx/Downloads/Linkedin/profiles/processed/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/Users/xxx/Downloads/Linkedin/profiles/processed/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="s1">&#39;/Users/xxx/Downloads/Linkedin/profiles/processed&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">MOVED </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">processed_files</span><span class="p">)</span><span class="si">}</span><span class="s2"> scraped files to processed folder.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># TODO: </span>
    <span class="c1"># - get list of LinkedIn URLs for &quot;People also viewed&quot; section</span>
</code></pre></div>

<h1 id="todo">TODO</h1>
<h2 id="get-also-viewed">Get Also Viewed</h2>
<p><span class="datestamp">15 Jan 2023</span> 
Done for already processed
- add logic to be done upon single file processing</p>
<h2 id="get-company-data-from-company-pages">Get Company data from Company pages</h2>
<p>DONE one-off script for all processed
- add logic to be done upon single file processing
- update records in Grist where needed</p>
<h2 id="make-grist_companies-a-function">Make Grist_Companies a function</h2>
<ul>
<li>returns number of employees found.    </li>
<li>triggered by each company profile visit.  </li>
</ul>
<h2 id="process-each-file-after-visit">Process each file after visit</h2>
<ul>
<li>defines wait time for next visit based on number of employees processed (with function above)</li>
</ul>
<h1 id="resources">Resources</h1>
<div class="link_border"><div class="link_logo_box"><img class="link_logo" src="https://notes.nicolasdeville.com/images/logos/dreamgrow.png" alt="logo"/></div><div class="link_content">
<div class="link_title">The 7 Best LinkedIn Automation Tools (aka How I Land Big Clients) - Dreamgrow</div>
<div class="link_tagline">dreamgrow.com</div>
<div class="link_url"><a href="https://www.dreamgrow.com/best-linkedin-automation-tools/" target="_blank">https://www.dreamgrow.com/best-linkedin-automation-tools/</a></div></div></div>
            <!-- </main> -->
        </div><!-- /.entry-content -->
    </article>
</section>

        <!-- footer -->
        <section id="extras" class="body" data-pagefind-ignore>

        <!-- /.blogroll -->
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://btobsales.eu">Services: BtoBSales.EU</a></li>
                            <li><a href="https://indeXall.io">Side project: indeXall.io</a></li>
                            <li><a href="https://github.com/ndeville">Github: ndeville</a></li>
                        </ul>
                </div>

        <!-- /.social -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://www.linkedin.com/in/ndeville/">Linkedin</a></li>
                            <li><a href="https://www.twitter.com/ndeville">Twitter</a></li>
                        </ul>
                </div>
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body" data-pagefind-ignore>

            <address id="about" class="vcard body">
                <div class="content-row">
                    <img src="https://notes.nicolasdeville.com/images/logos/pelican-logo.png" alt="pelican" width="16"> Powered by <a href="https://getpelican.com" target="_blank">Pelican</a>
                    <span class="separator">|</span>
                    <img src="https://notes.nicolasdeville.com/images/logos/pagefind.png" alt="pagefind" width="16"> Search by <a href="https://pagefind.app" target="_blank">Pagefind</a>
                    <span class="separator">|</span>
                    <img src="https://notes.nicolasdeville.com/images/logos/clearbit.png" alt="clearbit" width="16"> Logos by <a href="https://clearbit.com" target="_blank">Clearbit</a>
                    <span class="separator">|</span>
                    <img src="https://notes.nicolasdeville.com/images/python.svg" alt="python_logo" width="16"> Made with <a href="https://www.python.org/" target="_blank">Python</a>
                </div>
                <div class="content-row">
                    <img src="https://notes.nicolasdeville.com/favicon.svg" alt="nic_logo" width="24"> Nic's notes
                </div>
            </address>

        </footer><!-- /#contentinfo -->


<!-- JS -->

<!-- my JS script (with code block copy) -->
<script src="https://notes.nicolasdeville.com/theme/js/nic.js"></script>

<!-- for Stork seach engine -->
<!-- <script src="https://files.stork-search.net/stork.js"></script>
<script>
    stork.register("sitesearch", "https://notes.nicolasdeville.com/search-index.st")
</script> -->

<!-- <script>
    (function() {
    if( window.innerWidth > 600 ) {
        var stork_script = document.createElement('script');
        stork_script.type = 'text/javascript';
        stork_script.src = 'https://files.stork-search.net/stork.js';

        var stork_register = ('script');
        stork_register.innerHTML = 'stork.register("sitesearch", "https://notes.nicolasdeville.com/search-index.st")';

        var head = document.getElementsByTagName('head')[0];
        head.appendChild(stork_script);
        head.appendChild(stork_register);


    }
    })();
</script> -->

</body>
</html>